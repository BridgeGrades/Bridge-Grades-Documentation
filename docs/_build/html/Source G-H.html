
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Source G-H: Vote-Based Bipartisanship Data Processing &#8212; Bridge Grades Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Source G-H';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Source M: Cook Political Partisan Voting Index (PVI) Processing" href="Source%20M.html" />
    <link rel="prev" title="Source C-D-E-F: App Communications Calculations Data Processing" href="Source%20C-D-E-F.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-light" alt="Bridge Grades Documentation - Home"/>
    <script>document.write(`<img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-dark" alt="Bridge Grades Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Project%20Explanation.html"><strong>About Bridge Grades Project: Bridge Grades Data Pipeline Overview</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Sources%20of%20Information.html">Bridge Grades Data Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="Bridge_Pledge_119.html">Bridge Pledge 119: Final Bridge Grade Calculation Engine</a></li>

<li class="toctree-l1"><a class="reference internal" href="Source%20A-B.html">Source A-B: Legislator and Sponsorship Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20C-D-E-F.html">Source C-D-E-F: App Communications Calculations Data Processing</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Source G-H: Vote-Based Bipartisanship Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20M.html">Source M: Cook Political Partisan Voting Index (PVI) Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20N.html">Source N: VoteView Member Ideology Scores Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Next%20Steps.html"><strong>Next Steps</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FSource G-H.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Source G-H.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Source G-H: Vote-Based Bipartisanship Data Processing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources">Data Sources</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files">Input Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-details">Data Source Details</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs">Outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-g-votes-for-cosponsored-bills">Source G: Votes for Cosponsored Bills</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-h-votes-for-bills-sponsored-by-opposing-party">Source H: Votes for Bills Sponsored by Opposing Party</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-dataset">Complete Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements">Technical Requirements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-notes">Performance Notes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality">Data Quality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-integrity-notes">Data Integrity Notes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations">Limitations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-walkthrough-source-g-h"><strong>Notebook Walkthrough: Source G-H</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-for-bridge-grades-vote-based-bipartisanship-data"><strong>Preprocessing for Bridge Grades: Vote-Based Bipartisanship Data</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#match-sponsorships-to-legislators"><strong>Match Sponsorships to Legislators</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-and-normalize-name-fields"><strong>Clean and Normalize Name Fields</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#split-name-clean-into-components"><strong>Split <code class="docutils literal notranslate"><span class="pre">name_clean</span></code> into Components</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#build-short-name-handle"><strong>Build Short Name Handle</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzy-match-sponsorships-to-legislators"><strong>Fuzzy Match Sponsorships to Legislators</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-billsponsor-relationships"><strong>Build Bill–Sponsor Relationships</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-primary-sponsors-with-cosponsors"><strong>Merge Primary Sponsors with Cosponsors</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cross-party-sponsorship-flag"><strong>Compute Cross-Party Sponsorship Flag</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-and-preview-results"><strong>Validate and Preview Results</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-on-passage-vote-table"><strong>Build “On Passage” Vote Table</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pivot-vote-counts-into-columns"><strong>Pivot Vote Counts into Columns</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-with-vote-events-and-bills"><strong>Merge with Vote Events and Bills</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-total-votes-and-attach-sponsor-info"><strong>Compute Total Votes and Attach Sponsor Info</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-individual-vote-ids"><strong>Prepare Individual Vote IDs</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#process-individual-votes-compute-g-h-metrics"><strong>Process Individual Votes &amp; Compute G/H Metrics</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#split-house-senate-votes-and-recover-senate-ids"><strong>Split House &amp; Senate Votes and Recover Senate IDs</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-voter-metadata-attach-sponsor-info"><strong>Merge Voter Metadata &amp; Attach Sponsor Info</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-boolean-indicators-g-h"><strong>Define Boolean Indicators (G &amp; H)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-counts-per-legislator-merge-back"><strong>Aggregate Counts per Legislator &amp; Merge Back</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-scores-export-csvs"><strong>Normalize Scores &amp; Export CSVs</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-metrics-and-missing-data"><strong>Visualize Metrics and Missing Data</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-visualizations"><strong>Interpretation of Visualizations</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-bipartisan-vote-counts"><strong>Distribution of Bipartisan Vote Counts</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-bipartisan-vote-percentiles"><strong>Distribution of Bipartisan Vote Percentiles</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values-by-column"><strong>Missing Values by Column</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="source-g-h-vote-based-bipartisanship-data-processing">
<h1>Source G-H: Vote-Based Bipartisanship Data Processing<a class="headerlink" href="#source-g-h-vote-based-bipartisanship-data-processing" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This notebook processes voting data from the 119th U.S. Congress to generate two foundational datasets for the Bridge Grades methodology:</p>
<ul class="simple">
<li><p><strong>Source G:</strong> <em>Votes for Cosponsored Bills</em> - Counts of “yes” votes on bills with cross-party cosponsorship</p></li>
<li><p><strong>Source H:</strong> <em>Votes for Bills Sponsored by Opposing Party</em> - Counts of “yes” votes on bills sponsored by the opposite party</p></li>
</ul>
<p>These datasets focus on voting behavior in Congress, capturing different dimensions of bipartisan alignment in roll-call votes. Specifically:</p>
<ul class="simple">
<li><p><strong>Source G</strong> rewards legislators who consistently vote in favor of bills they themselves have cosponsored</p></li>
<li><p><strong>Source H</strong> rewards legislators who vote in favor of legislation sponsored by members of the opposite party</p></li>
</ul>
<p><strong>Note:</strong> As of now, these sources receive <strong>0 weight</strong> in the Bridge Grade due to limitations in the vote dataset — particularly, the narrow range of bills reaching a vote, often skewed by partisan agenda gatekeeping.</p>
</section>
<hr class="docutils" />
<section id="data-sources">
<h2>Data Sources<a class="headerlink" href="#data-sources" title="Link to this heading">#</a></h2>
<section id="input-files">
<h3>Input Files<a class="headerlink" href="#input-files" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">US_119_vote_people.csv</span></code></strong> - Individual vote records</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">US_119_vote_counts.csv</span></code></strong> - Vote tallies by vote event</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">US_119_votes.csv</span></code></strong> - Vote event metadata</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">US_119_bills.csv</span></code></strong> - Bill information</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">US_119_bill_sponsorships.csv</span></code></strong> - Bill sponsorship records</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">119th</span> <span class="pre">Congress.csv</span></code></strong> - Legislator metadata with bioguide IDs and district assignments</p></li>
</ul>
</section>
<section id="data-source-details">
<h3>Data Source Details<a class="headerlink" href="#data-source-details" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Source:</strong> <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">Plural Policy</a></p></li>
<li><p><strong>Congress:</strong> 119th U.S. Congress</p></li>
<li><p><strong>Download Date:</strong> April 24, 2025</p></li>
<li><p><strong>Coverage:</strong> Individual and aggregate vote records, bill metadata, sponsorship data, and biographical information about members of Congress</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Link to this heading">#</a></h2>
<section id="source-g-votes-for-cosponsored-bills">
<h3>Source G: Votes for Cosponsored Bills<a class="headerlink" href="#source-g-votes-for-cosponsored-bills" title="Link to this heading">#</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">bridge_grade_source_g_vote_for_cosponsored_bills.csv</span></code></p>
<p><strong>Columns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Name</span></code>: Legislator’s full name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code>: Unique legislator identifier</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Vote</span> <span class="pre">for</span> <span class="pre">Cosponsored</span> <span class="pre">Bill</span></code>: Raw count of “yes” votes on bills with cross-party cosponsorship</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">norm_G</span></code>: Normalized percentile score (0-100)</p></li>
</ul>
<p><strong>Interpretation:</strong> Higher values indicate legislators who more frequently vote in favor of bills with bipartisan cosponsorship.</p>
</section>
<section id="source-h-votes-for-bills-sponsored-by-opposing-party">
<h3>Source H: Votes for Bills Sponsored by Opposing Party<a class="headerlink" href="#source-h-votes-for-bills-sponsored-by-opposing-party" title="Link to this heading">#</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">bridge_grade_source_h_vote_for_other_party.csv</span></code></p>
<p><strong>Columns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Name</span></code>: Legislator’s full name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code>: Unique legislator identifier</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Vote</span> <span class="pre">for</span> <span class="pre">Other</span> <span class="pre">Party</span></code>: Raw count of “yes” votes on bills sponsored by opposite party</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">norm_H</span></code>: Normalized percentile score (0-100)</p></li>
</ul>
<p><strong>Interpretation:</strong> Higher values indicate legislators who more frequently vote in favor of legislation sponsored by the opposing party.</p>
</section>
<section id="complete-dataset">
<h3>Complete Dataset<a class="headerlink" href="#complete-dataset" title="Link to this heading">#</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">bridge_grade_votes_metrics_full.csv</span></code></p>
<p><strong>Additional Columns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Party</span></code>: Legislator’s political party</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Chamber</span></code>: House or Senate</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">State</span></code>: Legislator’s state</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">District</span></code>: Congressional district (House only)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="technical-requirements">
<h2>Technical Requirements<a class="headerlink" href="#technical-requirements" title="Link to this heading">#</a></h2>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>: Data manipulation and analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">numpy</span></code>: Numerical operations</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code>: Statistical functions for normalization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">seaborn</span></code>: Statistical data visualization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matplotlib.pyplot</span></code>: Data visualization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rapidfuzz</span></code>: Fuzzy string matching</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plotly.express</span></code>: Interactive data visualization</p></li>
</ul>
</section>
<section id="performance-notes">
<h3>Performance Notes<a class="headerlink" href="#performance-notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Fuzzy matching is computationally intensive but necessary for data quality</p></li>
<li><p>Vote aggregation operations are efficient using pandas groupby functions</p></li>
<li><p>Normalization provides standardized scores for fair comparison</p></li>
<li><p>All original vote records are preserved for transparency</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="data-quality">
<h2>Data Quality<a class="headerlink" href="#data-quality" title="Link to this heading">#</a></h2>
<section id="data-integrity-notes">
<h3>Data Integrity Notes<a class="headerlink" href="#data-integrity-notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Vote data is filtered to “On Passage” motions only for relevance</p></li>
<li><p>Senate voter IDs are recovered through name parsing when bioguide IDs are missing</p></li>
<li><p>Cross-party sponsorship flags are computed at both row and bill levels</p></li>
<li><p>Normalization accounts for differences in voting opportunities</p></li>
</ul>
</section>
<section id="limitations">
<h3>Limitations<a class="headerlink" href="#limitations" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Narrow Vote Range:</strong> Only bills that reach a vote are included, which may be skewed by partisan gatekeeping</p></li>
<li><p><strong>Missing Primary Sponsors:</strong> 166 bills lack primary sponsor information</p></li>
<li><p><strong>Current Weight:</strong> These sources currently receive 0 weight in Bridge Grades due to dataset limitations</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="notebook-walkthrough-source-g-h">
<h2><strong>Notebook Walkthrough: Source G-H</strong><a class="headerlink" href="#notebook-walkthrough-source-g-h" title="Link to this heading">#</a></h2>
<section id="preprocessing-for-bridge-grades-vote-based-bipartisanship-data">
<h3><strong>Preprocessing for Bridge Grades: Vote-Based Bipartisanship Data</strong><a class="headerlink" href="#preprocessing-for-bridge-grades-vote-based-bipartisanship-data" title="Link to this heading">#</a></h3>
<p>This notebook prepares the input data used to generate two additional resources in the Bridge Grades methodology:</p>
<ul class="simple">
<li><p><strong>Source G:</strong> <em>Votes for Cosponsored Bills</em></p></li>
<li><p><strong>Source H:</strong> <em>Votes for Bills Sponsored by Opposing Party</em></p></li>
</ul>
<p>These resources focus on voting behavior in Congress, capturing different dimensions of bipartisan alignment in roll-call votes. Specifically:</p>
<ul class="simple">
<li><p><strong>Source G</strong> rewards legislators who consistently vote in favor of bills they themselves have cosponsored.</p></li>
<li><p><strong>Source H</strong> rewards legislators who vote in favor of legislation sponsored by members of the opposite party.</p></li>
</ul>
<p>The datasets used in this notebook correspond to the <strong>119th U.S. Congress</strong> and were downloaded from the public data portal at <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">Plural Policy</a>.</p>
<ul class="simple">
<li><p><strong>Date downloaded:</strong> April 24, 2025</p></li>
<li><p><strong>Data includes:</strong> Individual and aggregate vote records, bill metadata, sponsorship data, and biographical information about members of Congress.</p></li>
<li><p><strong>Download instructions:</strong></p></li>
</ul>
<ol class="arabic simple">
<li><p>Go to <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">Plural Policy</a>, select “United States”, then choose “United States 119th Congress”.</p></li>
<li><p>Within the ZIP, the following files are used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">US_119_vote_people.csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_119_vote_counts.csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_119_votes.csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_119_bills.csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">US_119_bill_sponsorships.csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">119th</span> <span class="pre">Congress.csv</span></code> (metadata with bioguide IDs and district assignments)</p></li>
</ul>
</li>
</ol>
<p>The notebook also includes the application of normalization and handling of missing values. As of now, these sources receive <strong>0 weight</strong> in the Bridge Grade due to limitations in the vote dataset — particularly, the narrow range of bills reaching a vote, often skewed by partisan gatekeeping.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>rapidfuzz<span class="w"> </span>--quiet

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">rapidfuzz</span> <span class="kn">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">fuzz</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">pandas.errors</span> <span class="kn">import</span> <span class="n">SettingWithCopyWarning</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="p">(</span><span class="n">SettingWithCopyWarning</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Congressional list with bioguide ids and districts</span>
<span class="n">meta_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/119th Congress.csv&#39;</span><span class="p">)</span>

<span class="c1"># Bill Sponsorship</span>
<span class="n">sponsorships</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/US_119_bill_sponsorships.csv&#39;</span><span class="p">)</span>

<span class="c1"># Vote Counts (by vote_id; raw counts of individual votes)</span>
<span class="n">counts</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/US_119_vote_counts.csv&#39;</span><span class="p">)</span>

<span class="c1"># Votes (vote identifier; type of vote, result of vote,d ate of vote, bill_id)</span>
<span class="n">votes</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/US_119_votes.csv&#39;</span><span class="p">)</span>

<span class="c1"># Bills (bill information)</span>
<span class="n">bills</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/US_119_bills.csv&#39;</span><span class="p">)</span>

<span class="c1"># Vote People (individual votes)</span>
<span class="n">ind_votes</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/US_119_vote_people.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#Congressional list with bioguide ids and districts</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">meta_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/119th Congress.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># Bill Sponsorship</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">sponsorships</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/US_119_bill_sponsorships.csv&#39;</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\parsers\readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\parsers\readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\parsers\readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\parsers\readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;/content/drive/MyDrive/Bridge Grades/Data/Sources G -H/input files/119th Congress.csv&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fea0f569-a306-4eab-b185-6767b43214c2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Gary J. Palmer</td>
      <td>House</td>
      <td>P000609</td>
      <td>Alabama</td>
      <td>6</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Terri A. Sewell</td>
      <td>House</td>
      <td>S001185</td>
      <td>Alabama</td>
      <td>7</td>
      <td>Democratic</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Nicholas Begich</td>
      <td>House</td>
      <td>B001323</td>
      <td>Alaska</td>
      <td>At Large</td>
      <td>Republican</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fea0f569-a306-4eab-b185-6767b43214c2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fea0f569-a306-4eab-b185-6767b43214c2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fea0f569-a306-4eab-b185-6767b43214c2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-69a06644-e36f-4141-b23a-d68daa3e4d60">
      <button class="colab-df-quickchart" onclick="quickchart('df-69a06644-e36f-4141-b23a-d68daa3e4d60')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-69a06644-e36f-4141-b23a-d68daa3e4d60 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="match-sponsorships-to-legislators">
<h3><strong>Match Sponsorships to Legislators</strong><a class="headerlink" href="#match-sponsorships-to-legislators" title="Link to this heading">#</a></h3>
<section id="clean-and-normalize-name-fields">
<h4><strong>Clean and Normalize Name Fields</strong><a class="headerlink" href="#clean-and-normalize-name-fields" title="Link to this heading">#</a></h4>
<p>In this subsection, we prepare a lowercase, punctuation-free <code class="docutils literal notranslate"><span class="pre">name_clean</span></code> column in both <code class="docutils literal notranslate"><span class="pre">meta_data</span></code> and <code class="docutils literal notranslate"><span class="pre">sponsorships</span></code> for reliable matching. We <strong>do not</strong> overwrite original name fields. Instead, we create new columns and:</p>
<ol class="arabic simple">
<li><p>Remove generational suffixes (<code class="docutils literal notranslate"><span class="pre">Jr.</span></code>, <code class="docutils literal notranslate"><span class="pre">Sr.</span></code>).</p></li>
<li><p>Strip periods and commas in one regex operation.</p></li>
<li><p>Trim whitespace.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove generational suffixes and create cleaned name fields</span>
<span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;name_clean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;\b(jr|sr)\b\.?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">case</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[.,]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="p">)</span>

<span class="n">sponsorships</span><span class="p">[</span><span class="s1">&#39;name_clean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">sponsorships</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[.,]&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">regex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We now verify that the cleaning removed unwanted characters but preserved the key name components. For example, names like “John A. Smith, Jr.” become “john a smith”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Quick spot‐check</span>
<span class="nb">print</span><span class="p">(</span><span class="n">meta_data</span><span class="p">[[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;name_clean&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">sponsorships</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;name_clean&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                Name       name_clean
363  Julie Fedorchak  julie fedorchak
426     Ralph Norman     ralph norman
255     Brad Finstad     brad finstad
306   Thomas H. Kean    thomas h kean
300  Donald Norcross  donald norcross
                     name          name_clean
12069          Adam Smith          adam smith
41171       Angus S. King        angus s king
49364      Betty McCollum      betty mccollum
574    Jefferson Van Drew  jefferson van drew
49008          Mike Carey          mike carey
</pre></div>
</div>
</div>
</div>
</section>
<section id="split-name-clean-into-components">
<h4><strong>Split <code class="docutils literal notranslate"><span class="pre">name_clean</span></code> into Components</strong><a class="headerlink" href="#split-name-clean-into-components" title="Link to this heading">#</a></h4>
<p>Next, we decompose <code class="docutils literal notranslate"><span class="pre">name_clean</span></code> into <code class="docutils literal notranslate"><span class="pre">first_name</span></code>, <code class="docutils literal notranslate"><span class="pre">middle_name</span></code>, and <code class="docutils literal notranslate"><span class="pre">last_name</span></code> using a vectorized split:</p>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">str.split</span></code> with <code class="docutils literal notranslate"><span class="pre">n=2</span></code> to produce at most three parts.</p></li>
<li><p>Fill any missing segments with empty strings.</p></li>
<li><p>Truncate the first name to the first three characters for our short handle.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Meta_data splitting</span>
<span class="n">parts</span> <span class="o">=</span> <span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;name_clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">parts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span><span class="s1">&#39;middle_name&#39;</span><span class="p">,</span><span class="s1">&#39;last_name&#39;</span><span class="p">]</span>
<span class="n">meta_data</span><span class="p">[[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span><span class="s1">&#39;middle_name&#39;</span><span class="p">,</span><span class="s1">&#39;last_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">parts</span>

<span class="c1"># Sponsorships splitting</span>
<span class="n">parts_s</span> <span class="o">=</span> <span class="n">sponsorships</span><span class="p">[</span><span class="s1">&#39;name_clean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">parts_s</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span><span class="s1">&#39;middle_name&#39;</span><span class="p">,</span><span class="s1">&#39;last_name&#39;</span><span class="p">]</span>
<span class="n">sponsorships</span><span class="p">[[</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span><span class="s1">&#39;middle_name&#39;</span><span class="p">,</span><span class="s1">&#39;last_name&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">parts_s</span>

<span class="c1"># Truncate first names</span>
<span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="n">sponsorships</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sponsorships</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-short-name-handle">
<h4><strong>Build Short Name Handle</strong><a class="headerlink" href="#build-short-name-handle" title="Link to this heading">#</a></h4>
<p>We combine the truncated first name and the last name to create a concise <code class="docutils literal notranslate"><span class="pre">short_name</span></code> used for fuzzy matching.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;short_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
<span class="n">sponsorships</span><span class="p">[</span><span class="s1">&#39;short_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sponsorships</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">sponsorships</span><span class="p">[</span><span class="s1">&#39;first_name&#39;</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="fuzzy-match-sponsorships-to-legislators">
<h3><strong>Fuzzy Match Sponsorships to Legislators</strong><a class="headerlink" href="#fuzzy-match-sponsorships-to-legislators" title="Link to this heading">#</a></h3>
<p>In this section, we link each sponsorship record to a legislator by comparing <code class="docutils literal notranslate"><span class="pre">sponsorships.short_name</span></code> with <code class="docutils literal notranslate"><span class="pre">meta_data.short_name</span></code>. We:</p>
<ol class="arabic simple">
<li><p>Define and document a reusable fuzzy‐matching function.</p></li>
<li><p>Apply it to generate a <code class="docutils literal notranslate"><span class="pre">matched_name</span></code>.</p></li>
<li><p>Separate matched and unmatched records.</p></li>
<li><p>Merge matched records to bring in legislator attributes.</p></li>
<li><p>Ensure unmatched records retain the required schema.</p></li>
<li><p>Concatenate into a final sponsorship table.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">rapidfuzz</span> <span class="kn">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">fuzz</span>

<span class="k">def</span> <span class="nf">fuzzy_merge</span><span class="p">(</span><span class="n">df_left</span><span class="p">,</span> <span class="n">df_right</span><span class="p">,</span> <span class="n">key_left</span><span class="p">,</span> <span class="n">key_right</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">85</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    For each value in df_left[key_left], find the best match in df_right[key_right].</span>
<span class="sd">    Returns a copy of df_left with a new column &#39;matched_name&#39; containing the match or None.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">choices</span> <span class="o">=</span> <span class="n">df_right</span><span class="p">[</span><span class="n">key_right</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">find_match</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">isna</span><span class="p">(</span><span class="n">val</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">extractOne</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">choices</span><span class="p">,</span> <span class="n">scorer</span><span class="o">=</span><span class="n">fuzz</span><span class="o">.</span><span class="n">token_sort_ratio</span><span class="p">,</span> <span class="n">score_cutoff</span><span class="o">=</span><span class="n">threshold</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">match</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="n">match</span> <span class="k">else</span> <span class="kc">None</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df_left</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;matched_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">key_left</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">find_match</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Apply fuzzy matching on the short_name handles</span>
<span class="n">sponsorships_matched</span> <span class="o">=</span> <span class="n">fuzzy_merge</span><span class="p">(</span>
    <span class="n">sponsorships</span><span class="p">,</span> <span class="n">meta_data</span><span class="p">,</span>
    <span class="n">key_left</span><span class="o">=</span><span class="s1">&#39;short_name&#39;</span><span class="p">,</span> <span class="n">key_right</span><span class="o">=</span><span class="s1">&#39;short_name&#39;</span><span class="p">,</span>
    <span class="n">threshold</span><span class="o">=</span><span class="mi">85</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We now have a <code class="docutils literal notranslate"><span class="pre">matched_name</span></code> for each sponsorship (or <code class="docutils literal notranslate"><span class="pre">None</span></code> if no suitable match). Next, we merge in the legislator’s details for matched records.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Isolate matched and unmatched sets</span>
<span class="n">matched</span>   <span class="o">=</span> <span class="n">sponsorships_matched</span><span class="p">[</span><span class="n">sponsorships_matched</span><span class="p">[</span><span class="s1">&#39;matched_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">unmatched</span> <span class="o">=</span> <span class="n">sponsorships_matched</span><span class="p">[</span><span class="n">sponsorships_matched</span><span class="p">[</span><span class="s1">&#39;matched_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Merge matched sponsorships with legislator attributes</span>
<span class="n">matched</span> <span class="o">=</span> <span class="n">matched</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">meta_data</span><span class="p">[[</span><span class="s1">&#39;short_name&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span><span class="s1">&#39;Chamber&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;District&#39;</span><span class="p">]],</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;matched_name&#39;</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;short_name&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># For unmatched, add empty columns matching the merge schema</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span><span class="s1">&#39;Chamber&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;District&#39;</span><span class="p">]:</span>
    <span class="n">unmatched</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<p>Finally, we drop auxiliary columns, standardize column names, and combine matched + unmatched into the final sponsorship table.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop temporary columns and rename for consistency</span>
<span class="c1"># --- Ensure sponsorship record ID and name are preserved under clear names ---</span>
<span class="n">matched</span> <span class="o">=</span> <span class="n">matched</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span>   <span class="s1">&#39;sponsor_record_id&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sponsor_name&#39;</span>
<span class="p">})</span>
<span class="n">unmatched</span> <span class="o">=</span> <span class="n">unmatched</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span>   <span class="s1">&#39;sponsor_record_id&#39;</span><span class="p">,</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;sponsor_name&#39;</span>
<span class="p">})</span>

<span class="c1"># --- Extract primary sponsors ---</span>
<span class="n">primary_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">matched</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">matched</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;primary&#39;</span><span class="p">,</span>
         <span class="p">[</span><span class="s1">&#39;sponsor_record_id&#39;</span><span class="p">,</span><span class="s1">&#39;sponsor_name&#39;</span><span class="p">,</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span>
          <span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span><span class="s1">&#39;Chamber&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;sponsor_name&#39;</span><span class="p">:</span> <span class="s1">&#39;primary_name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span>  <span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Party&#39;</span><span class="p">:</span>        <span class="s1">&#39;primary_party&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Chamber&#39;</span><span class="p">:</span>      <span class="s1">&#39;primary_chamber&#39;</span>
    <span class="p">})</span>
<span class="p">)</span>

<span class="c1"># --- Extract cosponsors ---</span>
<span class="n">cosponsor_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">matched</span>
    <span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">matched</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;cosponsor&#39;</span><span class="p">,</span>
         <span class="p">[</span><span class="s1">&#39;sponsor_name&#39;</span><span class="p">,</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span><span class="s1">&#39;Chamber&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;sponsor_name&#39;</span><span class="p">:</span>       <span class="s1">&#39;cosponsor_name&#39;</span><span class="p">,</span>
        <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span>        <span class="s1">&#39;cosponsor_bioguide_id&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Party&#39;</span><span class="p">:</span>              <span class="s1">&#39;cosponsor_party&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Chamber&#39;</span><span class="p">:</span>            <span class="s1">&#39;cosponsor_chamber&#39;</span>
    <span class="p">})</span>
<span class="p">)</span>

<span class="n">matched</span> <span class="o">=</span> <span class="n">matched</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span>
   <span class="s1">&#39;name_clean&#39;</span><span class="p">,</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span><span class="s1">&#39;middle_name&#39;</span><span class="p">,</span><span class="s1">&#39;last_name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_name_x&#39;</span><span class="p">,</span><span class="s1">&#39;matched_name&#39;</span><span class="p">,</span><span class="s1">&#39;short_name_y&#39;</span>
<span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="n">unmatched</span> <span class="o">=</span> <span class="n">unmatched</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span>
    <span class="s1">&#39;name_clean&#39;</span><span class="p">,</span><span class="s1">&#39;first_name&#39;</span><span class="p">,</span><span class="s1">&#39;middle_name&#39;</span><span class="p">,</span><span class="s1">&#39;last_name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;short_name&#39;</span><span class="p">,</span><span class="s1">&#39;matched_name&#39;</span>
<span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Combine into the final DataFrame</span>
<span class="n">final_sponsorships</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">matched</span><span class="p">,</span> <span class="n">unmatched</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Select and reorder only the columns we need downstream</span>
<span class="n">output_cols</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;name&#39;</span><span class="p">,</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span><span class="s1">&#39;primary&#39;</span><span class="p">,</span><span class="s1">&#39;classification&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span><span class="s1">&#39;Chamber&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;District&#39;</span>
<span class="p">]</span>

<span class="c1"># Rename sponsor_name back to name so output_cols can use &#39;name&#39;</span>
<span class="k">if</span> <span class="s1">&#39;sponsor_name&#39;</span> <span class="ow">in</span> <span class="n">final_sponsorships</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">final_sponsorships</span> <span class="o">=</span> <span class="n">final_sponsorships</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;sponsor_name&#39;</span><span class="p">:</span><span class="s1">&#39;name&#39;</span><span class="p">})</span>

<span class="n">final_sponsorships</span> <span class="o">=</span> <span class="n">final_sponsorships</span><span class="p">[</span><span class="n">output_cols</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final_sponsorships</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-09dc19b8-255f-4988-8b0c-d92d4ee896c0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>bill_id</th>
      <th>primary</th>
      <th>classification</th>
      <th>bioguide_id</th>
      <th>Party</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>David G. Valadao</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>V000129</td>
      <td>Republican</td>
      <td>House</td>
      <td>California</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>B001236</td>
      <td>Republican</td>
      <td>Senate</td>
      <td>Arkansas</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>G000559</td>
      <td>Democratic</td>
      <td>House</td>
      <td>California</td>
      <td>8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>K000393</td>
      <td>Republican</td>
      <td>Senate</td>
      <td>Louisiana</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>O000176</td>
      <td>Democratic</td>
      <td>House</td>
      <td>Maryland</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>J000307</td>
      <td>Republican</td>
      <td>House</td>
      <td>Michigan</td>
      <td>10</td>
    </tr>
    <tr>
      <th>6</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>M001231</td>
      <td>Democratic</td>
      <td>House</td>
      <td>New York</td>
      <td>22</td>
    </tr>
    <tr>
      <th>7</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>H001061</td>
      <td>Republican</td>
      <td>Senate</td>
      <td>North Dakota</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>8</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>J000302</td>
      <td>Republican</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>John Garamendi</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>F000479</td>
      <td>Democratic</td>
      <td>Senate</td>
      <td>Pennsylvania</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-09dc19b8-255f-4988-8b0c-d92d4ee896c0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-09dc19b8-255f-4988-8b0c-d92d4ee896c0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-09dc19b8-255f-4988-8b0c-d92d4ee896c0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-11d4bc00-73b0-45c8-98d5-dad161e261e2">
      <button class="colab-df-quickchart" onclick="quickchart('df-11d4bc00-73b0-45c8-98d5-dad161e261e2')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-11d4bc00-73b0-45c8-98d5-dad161e261e2 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="build-billsponsor-relationships">
<h3><strong>Build Bill–Sponsor Relationships</strong><a class="headerlink" href="#build-billsponsor-relationships" title="Link to this heading">#</a></h3>
<p>In this section, we construct the <code class="docutils literal notranslate"><span class="pre">bill_sponsor</span></code> DataFrame that pairs each <strong>primary sponsor</strong> with its <strong>cosponsors</strong> and flags bills that have any cross‐party support. We proceed in three subsections:</p>
<ol class="arabic simple">
<li><p><strong>Merge primary sponsors with cosponsors</strong> (one‐to‐many).</p></li>
<li><p><strong>Compute the cross‐party sponsorship flag</strong> at the bill level.</p></li>
<li><p><strong>Validate</strong> and preview the results.</p></li>
</ol>
<section id="merge-primary-sponsors-with-cosponsors">
<h4><strong>Merge Primary Sponsors with Cosponsors</strong><a class="headerlink" href="#merge-primary-sponsors-with-cosponsors" title="Link to this heading">#</a></h4>
<p>First, ensure we have exactly one primary sponsor per bill by deduplicating <code class="docutils literal notranslate"><span class="pre">primary_df</span></code> on <code class="docutils literal notranslate"><span class="pre">bill_id</span></code>. Then perform a standard left merge to attach all cosponsors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Deduplicate to one primary per bill</span>
<span class="n">primary_df_unique</span> <span class="o">=</span> <span class="n">primary_df</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="n">keep</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>

<span class="c1"># Merge primary sponsors (1 per bill) with all cosponsors (many per bill)</span>
<span class="n">bill_sponsor</span> <span class="o">=</span> <span class="n">primary_df_unique</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">cosponsor_df</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-cross-party-sponsorship-flag">
<h4><strong>Compute Cross-Party Sponsorship Flag</strong><a class="headerlink" href="#compute-cross-party-sponsorship-flag" title="Link to this heading">#</a></h4>
<p>We create a row‐level boolean indicating whether the cosponsor’s party differs from the primary’s, then collapse this to the bill level so if any row is <code class="docutils literal notranslate"><span class="pre">True</span></code>, the flag is <code class="docutils literal notranslate"><span class="pre">True</span></code> for that bill.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Row‐level flag: True if cosponsor_party ≠ primary_party</span>
<span class="n">bill_sponsor</span><span class="p">[</span><span class="s1">&#39;Cross Party Sponsorship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">bill_sponsor</span><span class="p">[</span><span class="s1">&#39;primary_party&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">bill_sponsor</span><span class="p">[</span><span class="s1">&#39;cosponsor_party&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Bill‐level flag: any True within each bill_id</span>
<span class="n">bill_sponsor</span><span class="p">[</span><span class="s1">&#39;Cross Party Sponsorship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">bill_sponsor</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;bill_id&#39;</span><span class="p">)[</span><span class="s1">&#39;Cross Party Sponsorship&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="validate-and-preview-results">
<h4><strong>Validate and Preview Results</strong><a class="headerlink" href="#validate-and-preview-results" title="Link to this heading">#</a></h4>
<p>Finally, we verify that every bill has a primary sponsor, report the count of cross‐party bills, and preview the first rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify bills in cosponsor_df without a matching primary</span>
<span class="n">missing_primary</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">cosponsor_df</span><span class="p">[</span><span class="s1">&#39;bill_id&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">primary_df_unique</span><span class="p">[</span><span class="s1">&#39;bill_id&#39;</span><span class="p">])</span>
<span class="k">if</span> <span class="n">missing_primary</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; Warning: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_primary</span><span class="p">)</span><span class="si">}</span><span class="s2"> bills lack a primary sponsor; they will still appear with NaNs for primary fields.&quot;</span><span class="p">)</span>

<span class="c1"># Summary of cross-party sponsorship</span>
<span class="n">distinct_flags</span> <span class="o">=</span> <span class="n">bill_sponsor</span><span class="p">[[</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span><span class="s1">&#39;Cross Party Sponsorship&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>
<span class="n">num_cross</span> <span class="o">=</span> <span class="n">distinct_flags</span><span class="p">[</span><span class="s1">&#39;Cross Party Sponsorship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">total_bills</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">distinct_flags</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">num_cross</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">total_bills</span><span class="si">}</span><span class="s2"> bills have cross-party cosponsors&quot;</span><span class="p">)</span>

<span class="c1"># Preview</span>
<span class="n">bill_sponsor</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Warning: 166 bills lack a primary sponsor; they will still appear with NaNs for primary fields.
 4511 of 4929 bills have cross-party cosponsors
</pre></div>
</div>
<div class="output text_html">
  <div id="df-1cb975a0-b570-4080-a1b5-a1c28669f920" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sponsor_record_id</th>
      <th>primary_name</th>
      <th>bill_id</th>
      <th>primary_bioguide_id</th>
      <th>primary_party</th>
      <th>primary_chamber</th>
      <th>cosponsor_name</th>
      <th>cosponsor_bioguide_id</th>
      <th>cosponsor_party</th>
      <th>cosponsor_chamber</th>
      <th>Cross Party Sponsorship</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>8a396a28-95ee-4b6b-8b3a-30aeb3675121</td>
      <td>Patrick Ryan</td>
      <td>ocd-bill/65082e82-df48-420f-b139-443325ee91c6</td>
      <td>R000579</td>
      <td>Democratic</td>
      <td>House</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>David G. Valadao</td>
      <td>V000129</td>
      <td>Republican</td>
      <td>House</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>John Garamendi</td>
      <td>B001236</td>
      <td>Republican</td>
      <td>Senate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>John Garamendi</td>
      <td>G000559</td>
      <td>Democratic</td>
      <td>House</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>John Garamendi</td>
      <td>K000393</td>
      <td>Republican</td>
      <td>Senate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>5</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>John Garamendi</td>
      <td>O000176</td>
      <td>Democratic</td>
      <td>House</td>
      <td>True</td>
    </tr>
    <tr>
      <th>6</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>John Garamendi</td>
      <td>J000307</td>
      <td>Republican</td>
      <td>House</td>
      <td>True</td>
    </tr>
    <tr>
      <th>7</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>John Garamendi</td>
      <td>M001231</td>
      <td>Democratic</td>
      <td>House</td>
      <td>True</td>
    </tr>
    <tr>
      <th>8</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>John Garamendi</td>
      <td>H001061</td>
      <td>Republican</td>
      <td>Senate</td>
      <td>True</td>
    </tr>
    <tr>
      <th>9</th>
      <td>e0ee50bd-a26b-4850-9c75-5858c504c7f1</td>
      <td>Josh Harder</td>
      <td>ocd-bill/71f7684b-7f48-40e2-9242-0da9a644d852</td>
      <td>H001090</td>
      <td>Democratic</td>
      <td>House</td>
      <td>John Garamendi</td>
      <td>J000302</td>
      <td>Republican</td>
      <td>House</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1cb975a0-b570-4080-a1b5-a1c28669f920')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1cb975a0-b570-4080-a1b5-a1c28669f920 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1cb975a0-b570-4080-a1b5-a1c28669f920');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-12c275b0-f335-46ba-afb6-899684889db8">
      <button class="colab-df-quickchart" onclick="quickchart('df-12c275b0-f335-46ba-afb6-899684889db8')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-12c275b0-f335-46ba-afb6-899684889db8 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="build-on-passage-vote-table">
<h3><strong>Build “On Passage” Vote Table</strong><a class="headerlink" href="#build-on-passage-vote-table" title="Link to this heading">#</a></h3>
<p>In this section we transform raw vote tallies (<code class="docutils literal notranslate"><span class="pre">counts</span></code>) and vote‐event metadata (<code class="docutils literal notranslate"><span class="pre">votes</span></code>, <code class="docutils literal notranslate"><span class="pre">bills</span></code>) into a clean table (<code class="docutils literal notranslate"><span class="pre">passage_votes</span></code>) containing, for each “On Passage” vote:</p>
<ul class="simple">
<li><p><strong>vote_id</strong> and <strong>bill_id</strong></p></li>
<li><p>Vote counts for <strong>yes</strong>, <strong>no</strong>, <strong>abstain</strong>, <strong>not voting</strong></p></li>
<li><p><strong>total_votes</strong></p></li>
<li><p>Bill metadata (number, title, primary sponsor info)</p></li>
</ul>
<p>Finally, we filter and join with our <code class="docutils literal notranslate"><span class="pre">bill_sponsor</span></code> table to attach sponsor parties and cross‐party flags.</p>
<section id="pivot-vote-counts-into-columns">
<h4><strong>Pivot Vote Counts into Columns</strong><a class="headerlink" href="#pivot-vote-counts-into-columns" title="Link to this heading">#</a></h4>
<p>Instead of looping, we use a vectorized pivot:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Drop the redundant &#39;id&#39; in counts</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">counts</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="c1"># Pivot so each option becomes its own column</span>
<span class="n">pivot_counts</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">counts</span>
    <span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;vote_event_id&#39;</span><span class="p">,</span>
                 <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;option&#39;</span><span class="p">,</span>
                 <span class="n">values</span><span class="o">=</span><span class="s1">&#39;value&#39;</span><span class="p">,</span>
                 <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;sum&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># Standardize column names</span>
<span class="n">pivot_counts</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">col</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="k">else</span> <span class="n">col</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">pivot_counts</span><span class="o">.</span><span class="n">columns</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="merge-with-vote-events-and-bills">
<h4><strong>Merge with Vote Events and Bills</strong><a class="headerlink" href="#merge-with-vote-events-and-bills" title="Link to this heading">#</a></h4>
<p>We merge the pivoted tallies back into <code class="docutils literal notranslate"><span class="pre">votes</span></code>, join on <code class="docutils literal notranslate"><span class="pre">bills</span></code>, filter to “<strong>bill”</strong> classification, and then to <strong>“On Passage”</strong> motions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge tallies into vote events</span>
<span class="n">votes</span> <span class="o">=</span> <span class="n">votes</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">pivot_counts</span><span class="p">,</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;vote_event_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Attach bill details and filter to classification = bill</span>
<span class="n">merged_votes_bills</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">votes</span>
    <span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">bills</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">suffixes</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;_bill&#39;</span><span class="p">))</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;classification == </span><span class="se">\&quot;</span><span class="s2">[&#39;bill&#39;]</span><span class="se">\&quot;</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Keep only “On Passage” motions</span>
<span class="n">passage_votes</span> <span class="o">=</span> <span class="n">merged_votes_bills</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">merged_votes_bills</span><span class="p">[</span><span class="s1">&#39;motion_text&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;On Passage&#39;</span><span class="p">,</span> <span class="n">na</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="p">[</span>
      <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;vote_event_id&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_id&#39;</span><span class="p">,</span>
      <span class="s1">&#39;yes&#39;</span><span class="p">,</span> <span class="s1">&#39;no&#39;</span><span class="p">,</span> <span class="s1">&#39;abstain&#39;</span><span class="p">,</span> <span class="s1">&#39;not_voting&#39;</span><span class="p">,</span>
      <span class="s1">&#39;motion_text&#39;</span><span class="p">,</span> <span class="s1">&#39;motion_classification&#39;</span><span class="p">,</span>
      <span class="s1">&#39;result&#39;</span><span class="p">,</span> <span class="s1">&#39;title&#39;</span>
    <span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="s1">&#39;vote_id&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vote_event_id&#39;</span><span class="p">:</span> <span class="s1">&#39;vote_event_id&#39;</span><span class="p">,</span>
    <span class="s1">&#39;not_voting&#39;</span><span class="p">:</span> <span class="s1">&#39;not_voting&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-total-votes-and-attach-sponsor-info">
<h4><strong>Compute Total Votes and Attach Sponsor Info</strong><a class="headerlink" href="#compute-total-votes-and-attach-sponsor-info" title="Link to this heading">#</a></h4>
<p>We calculate <code class="docutils literal notranslate"><span class="pre">total_votes</span></code> as the sum of all four columns, then merge with <code class="docutils literal notranslate"><span class="pre">bill_sponsor</span></code> to bring in <code class="docutils literal notranslate"><span class="pre">primary_party</span></code>, <code class="docutils literal notranslate"><span class="pre">Cross</span> <span class="pre">Party</span> <span class="pre">Sponsorship</span></code>, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Total votes per event</span>
<span class="n">passage_votes</span><span class="p">[</span><span class="s1">&#39;total_votes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">passage_votes</span><span class="p">[</span><span class="s1">&#39;yes&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">passage_votes</span><span class="p">[</span><span class="s1">&#39;no&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">passage_votes</span><span class="p">[</span><span class="s1">&#39;abstain&#39;</span><span class="p">]</span> <span class="o">+</span>
    <span class="n">passage_votes</span><span class="p">[</span><span class="s1">&#39;not_voting&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Merge sponsor info</span>
<span class="n">passage_votes</span> <span class="o">=</span> <span class="n">passage_votes</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">bill_sponsor</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Quick check</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total passage vote records: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">passage_votes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum of total_votes: </span><span class="si">{</span><span class="n">passage_votes</span><span class="p">[</span><span class="s1">&#39;total_votes&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total passage vote records: 3274
Sum of total_votes: 1278293.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="prepare-individual-vote-ids">
<h4><strong>Prepare Individual Vote IDs</strong><a class="headerlink" href="#prepare-individual-vote-ids" title="Link to this heading">#</a></h4>
<p>Finally, we extract the list of <code class="docutils literal notranslate"><span class="pre">vote_id</span></code>s for these passage events, and filter <code class="docutils literal notranslate"><span class="pre">ind_votes</span></code> accordingly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of valid passage vote IDs</span>
<span class="n">passage_votes_ids</span> <span class="o">=</span> <span class="n">passage_votes</span><span class="p">[</span><span class="s1">&#39;vote_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

<span class="c1"># Rename ind_votes field and filter</span>
<span class="n">ind_votes</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;note&#39;</span><span class="p">:</span><span class="s1">&#39;voter_bioguide_id&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ind_votes</span> <span class="o">=</span> <span class="n">ind_votes</span><span class="p">[</span><span class="n">ind_votes</span><span class="p">[</span><span class="s1">&#39;vote_event_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">passage_votes_ids</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total individual vote records retained: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ind_votes</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Total individual vote records retained: 7659
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ind_votes</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a64cf0e6-969e-4fbf-a078-a50c8ce84f01" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>vote_event_id</th>
      <th>option</th>
      <th>voter_name</th>
      <th>voter_id</th>
      <th>voter_bioguide_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1265</th>
      <td>36656e82-50a6-428d-97da-035257cd72f9</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>yes</td>
      <td>Rose</td>
      <td>ocd-person/a30feb1f-c9fe-5612-808e-8fe5a55b76dc</td>
      <td>R000612</td>
    </tr>
    <tr>
      <th>1423</th>
      <td>8d362275-8a0f-4bc3-828e-4eea8d0d5042</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>no</td>
      <td>Ross</td>
      <td>ocd-person/ea21df34-9ef4-5746-b83a-700bdc2d1918</td>
      <td>R000305</td>
    </tr>
    <tr>
      <th>1424</th>
      <td>51a77ce4-1f30-403f-aac0-bd5a7fd0fd3d</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>yes</td>
      <td>Rouzer</td>
      <td>ocd-person/5e9726e3-2aae-5708-9227-0e95ac43c203</td>
      <td>R000603</td>
    </tr>
    <tr>
      <th>1425</th>
      <td>9e56856a-4c49-4cc1-bced-2533cf35e205</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>yes</td>
      <td>Roy</td>
      <td>ocd-person/2398f81d-6371-544d-a7ff-24cf993a716b</td>
      <td>R000614</td>
    </tr>
    <tr>
      <th>1426</th>
      <td>42ce94c0-77c7-459c-b9ad-3cc654844e4d</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>no</td>
      <td>Ruiz</td>
      <td>ocd-person/4db06595-7db2-51a8-8574-703e9af111b9</td>
      <td>R000599</td>
    </tr>
    <tr>
      <th>1427</th>
      <td>1674538c-d27c-4db4-ae66-7003c7175f7a</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>yes</td>
      <td>Rulli</td>
      <td>ocd-person/91ba3b6a-a4c8-54ab-8964-8498641a6d8f</td>
      <td>R000619</td>
    </tr>
    <tr>
      <th>1428</th>
      <td>5d8d3f4a-b5b2-46a6-a382-56295f4295a6</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>yes</td>
      <td>Rutherford</td>
      <td>ocd-person/5ab7829c-a819-5616-ac0e-a0aaa359f493</td>
      <td>R000609</td>
    </tr>
    <tr>
      <th>1429</th>
      <td>d6c4d2d5-7773-48b1-9dc7-4f51aef70868</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>no</td>
      <td>Ryan</td>
      <td>ocd-person/10de7024-4b40-57b0-ae78-101372fd4a02</td>
      <td>R000579</td>
    </tr>
    <tr>
      <th>1430</th>
      <td>c7b2e9b0-99b4-4ba1-9608-a2826f364ba1</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>yes</td>
      <td>Salazar</td>
      <td>ocd-person/23524e03-1206-50cb-844d-ddea47f258da</td>
      <td>S000168</td>
    </tr>
    <tr>
      <th>1431</th>
      <td>0800bde7-eb50-4d91-9a3e-72c923518b05</td>
      <td>ocd-vote/f66a86ff-3923-44ac-bb38-9ebff7500b22</td>
      <td>no</td>
      <td>Salinas</td>
      <td>ocd-person/54f931b7-9a94-5c93-8585-0967370ffb86</td>
      <td>S001226</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a64cf0e6-969e-4fbf-a078-a50c8ce84f01')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a64cf0e6-969e-4fbf-a078-a50c8ce84f01 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a64cf0e6-969e-4fbf-a078-a50c8ce84f01');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-cd1fe816-47c7-42a0-87e8-f3eb1d739a2b">
      <button class="colab-df-quickchart" onclick="quickchart('df-cd1fe816-47c7-42a0-87e8-f3eb1d739a2b')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-cd1fe816-47c7-42a0-87e8-f3eb1d739a2b button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="process-individual-votes-compute-g-h-metrics">
<h3><strong>Process Individual Votes &amp; Compute G/H Metrics</strong><a class="headerlink" href="#process-individual-votes-compute-g-h-metrics" title="Link to this heading">#</a></h3>
<p>In this section we take our filtered individual‐vote records (<code class="docutils literal notranslate"><span class="pre">ind_votes</span></code>) and:</p>
<ol class="arabic simple">
<li><p><strong>Split</strong> into House vs. Senate to recover missing Senate IDs.</p></li>
<li><p><strong>Merge</strong> with legislator metadata to attach party, chamber, etc.</p></li>
<li><p><strong>Tag</strong> each vote with its bill sponsor’s party and cross‐party flag.</p></li>
<li><p><strong>Define</strong> the two boolean metrics (Sources H &amp; G).</p></li>
<li><p><strong>Summarize</strong> counts per legislator and <strong>merge back</strong> into <code class="docutils literal notranslate"><span class="pre">meta_data</span></code>.</p></li>
<li><p><strong>Normalize</strong> scores and <strong>export</strong> the final CSV.</p></li>
</ol>
<section id="split-house-senate-votes-and-recover-senate-ids">
<h4><strong>Split House &amp; Senate Votes and Recover Senate IDs</strong><a class="headerlink" href="#split-house-senate-votes-and-recover-senate-ids" title="Link to this heading">#</a></h4>
<p>House members have full <code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code> (length ≥ 5); Senate votes must be parsed from <code class="docutils literal notranslate"><span class="pre">voter_name</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure no missing IDs before splitting</span>
<span class="n">ind_votes</span> <span class="o">=</span> <span class="n">ind_votes</span><span class="p">[</span><span class="n">ind_votes</span><span class="p">[</span><span class="s1">&#39;voter_bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Split into House vs. Senate</span>
<span class="n">house_votes</span>  <span class="o">=</span> <span class="n">ind_votes</span><span class="p">[</span><span class="n">ind_votes</span><span class="p">[</span><span class="s1">&#39;voter_bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">senate_votes</span> <span class="o">=</span> <span class="n">ind_votes</span><span class="p">[</span><span class="n">ind_votes</span><span class="p">[</span><span class="s1">&#39;voter_bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">len</span><span class="p">()</span> <span class="o">&lt;</span>  <span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Extract Last Name &amp; State from &quot;Name (P-XX)&quot;</span>
<span class="n">senate_votes</span><span class="p">[[</span><span class="s1">&#39;Last Name&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">senate_votes</span><span class="p">[</span><span class="s1">&#39;voter_name&#39;</span><span class="p">]</span> \
    <span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(.+?)\s*\([\w-]?([A-Z]</span><span class="si">{2}</span><span class="s1">)\)&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_votes</span><span class="p">[</span><span class="s1">&#39;Last Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_votes</span><span class="p">[</span><span class="s1">&#39;Last Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>

<span class="c1"># Build lookup of senators by last_name</span>
<span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">()</span><span class="o">.</span><span class="n">str</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">senate_lookup</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">meta_data</span><span class="p">[</span><span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;Chamber&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Senate&#39;</span><span class="p">]</span>
    <span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;last_name&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;last_name&#39;</span><span class="p">)[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Map recovered IDs</span>
<span class="n">senate_votes</span><span class="p">[</span><span class="s1">&#39;voter_bioguide_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_votes</span><span class="p">[</span><span class="s1">&#39;Last Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">senate_lookup</span><span class="p">)</span>

<span class="c1"># Combine back and drop auxiliaries</span>
<span class="n">senate_votes</span> <span class="o">=</span> <span class="n">senate_votes</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;voter_name&#39;</span><span class="p">,</span><span class="s1">&#39;Last Name&#39;</span><span class="p">,</span><span class="s1">&#39;State&#39;</span><span class="p">])</span>
<span class="n">all_votes</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">house_votes</span><span class="p">,</span> <span class="n">senate_votes</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="merge-voter-metadata-attach-sponsor-info">
<h4><strong>Merge Voter Metadata &amp; Attach Sponsor Info</strong><a class="headerlink" href="#merge-voter-metadata-attach-sponsor-info" title="Link to this heading">#</a></h4>
<p>Join each vote to the voter’s <code class="docutils literal notranslate"><span class="pre">meta_data</span></code> record, then attach the bill sponsor’s party and cross‐party flag from <code class="docutils literal notranslate"><span class="pre">passage_votes</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge in legislator metadata</span>
<span class="n">all_votes</span> <span class="o">=</span> <span class="n">all_votes</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">meta_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;last_name&#39;</span><span class="p">]),</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;voter_bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Attach sponsor info via merge (vectorized)</span>
<span class="n">sponsor_info</span> <span class="o">=</span> <span class="n">passage_votes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;vote_id&#39;</span><span class="p">)[[</span><span class="s1">&#39;primary_party&#39;</span><span class="p">,</span><span class="s1">&#39;Cross Party Sponsorship&#39;</span><span class="p">]]</span>
<span class="n">all_votes</span> <span class="o">=</span> <span class="n">all_votes</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">sponsor_info</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;vote_event_id&#39;</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;primary_party&#39;</span><span class="p">:</span><span class="s1">&#39;Bill_Sponsor_Party&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="define-boolean-indicators-g-h">
<h4><strong>Define Boolean Indicators (G &amp; H)</strong><a class="headerlink" href="#define-boolean-indicators-g-h" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Source H:</strong> Voted “yes” on a bill sponsored by a different party.</p></li>
<li><p><strong>Source G:</strong> Voted “yes” on a cross‐party cosponsored bill.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;option&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Bill_Sponsor_Party&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Party&#39;</span><span class="p">])</span>
<span class="p">)</span>

<span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="p">(</span><span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;option&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;yes&#39;</span><span class="p">)</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Cross Party Sponsorship&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Optional: print totals for sanity check</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Votes for Other Party:&quot;</span><span class="p">,</span> <span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Votes for Cosponsored Bill:&quot;</span><span class="p">,</span> <span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Votes for Other Party: 221374
Votes for Cosponsored Bill: 761337
</pre></div>
</div>
</div>
</div>
</section>
<section id="aggregate-counts-per-legislator-merge-back">
<h4><strong>Aggregate Counts per Legislator &amp; Merge Back</strong><a class="headerlink" href="#aggregate-counts-per-legislator-merge-back" title="Link to this heading">#</a></h4>
<p>We summarize the two boolean indicators by legislator, then merge those totals into <code class="docutils literal notranslate"><span class="pre">meta_data</span></code>. Note the correct syntax for selecting multiple columns using a list.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter only relevant votes</span>
<span class="n">cross_votes</span> <span class="o">=</span> <span class="n">all_votes</span><span class="p">[</span>
    <span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span> <span class="o">|</span>
    <span class="n">all_votes</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1"># Group and sum by Name &amp; bioguide_id</span>
<span class="n">vote_summary</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">cross_votes</span>
    <span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">])[[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">,</span> <span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="p">)</span>

<span class="c1"># Merge summary back into meta_data</span>
<span class="n">meta_data</span> <span class="o">=</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">vote_summary</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Fill NaNs with zeros for legislators with no cross-party votes</span>
<span class="n">meta_data</span><span class="p">[[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">,</span> <span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">meta_data</span><span class="p">[[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">,</span> <span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]]</span>
    <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="normalize-scores-export-csvs">
<h4><strong>Normalize Scores &amp; Export CSVs</strong><a class="headerlink" href="#normalize-scores-export-csvs" title="Link to this heading">#</a></h4>
<p>Compute percentile‐style scores with the normal CDF, then save two outputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">normalize</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">ddof</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;norm_G&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">meta_data</span><span class="p">,</span> <span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">)</span>
<span class="n">meta_data</span><span class="p">[</span><span class="s1">&#39;norm_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">meta_data</span><span class="p">,</span> <span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="s1">&#39;Name_x&#39;</span> <span class="ow">in</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="n">meta_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Name_x&#39;</span><span class="p">:</span><span class="s1">&#39;Name&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Export Source G</span>
<span class="n">meta_data</span><span class="p">[[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">,</span><span class="s1">&#39;norm_G&#39;</span><span class="p">]]</span> \
    <span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;bridge_grade_source_g_vote_for_cosponsored_bills.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Export Source H</span>
<span class="n">meta_data</span><span class="p">[[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">,</span><span class="s1">&#39;norm_H&#39;</span><span class="p">]]</span> \
    <span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;bridge_grade_source_h_vote_for_other_party.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">meta_data</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;bridge_grade_votes_metrics_full.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Exported CSVs for Source G &amp; H.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Exported CSVs for Source G &amp; H.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="visualize-metrics-and-missing-data">
<h3><strong>Visualize Metrics and Missing Data</strong><a class="headerlink" href="#visualize-metrics-and-missing-data" title="Link to this heading">#</a></h3>
<p>We’ll produce three charts using our custom <code class="docutils literal notranslate"><span class="pre">ordered_purples</span></code> palette:</p>
<ol class="arabic simple">
<li><p><strong>Histogram of raw counts</strong> (<code class="docutils literal notranslate"><span class="pre">Vote</span> <span class="pre">for</span> <span class="pre">Cosponsored</span> <span class="pre">Bill</span></code>, <code class="docutils literal notranslate"><span class="pre">Vote</span> <span class="pre">for</span> <span class="pre">Other</span> <span class="pre">Party</span></code>)</p></li>
<li><p><strong>Histogram of normalized percentiles</strong> (<code class="docutils literal notranslate"><span class="pre">norm_G</span></code>, <code class="docutils literal notranslate"><span class="pre">norm_H</span></code>)</p></li>
<li><p><strong>Bar chart of missingness</strong> for <strong>all</strong> columns in <code class="docutils literal notranslate"><span class="pre">meta_data</span></code>, showing percentage on the y-axis and absolute missing count in the hover, with distinct bar outlines (gridlines between bars).</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>

<span class="c1"># Define our custom ordered Purples palette</span>
<span class="n">ordered_purples</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#3f007d&#39;</span><span class="p">,</span> <span class="s1">&#39;#54278f&#39;</span><span class="p">,</span> <span class="s1">&#39;#6a51a3&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;#807dba&#39;</span><span class="p">,</span> <span class="s1">&#39;#9e9ac8&#39;</span><span class="p">,</span> <span class="s1">&#39;#bcbddc&#39;</span><span class="p">]</span>

<span class="c1"># 1. Raw counts distribution</span>
<span class="n">raw_melt</span> <span class="o">=</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">,</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Metric&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span>
<span class="p">)</span>

<span class="n">fig1</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span>
    <span class="n">raw_melt</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Count&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Metric&#39;</span><span class="p">,</span> <span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;overlay&#39;</span><span class="p">,</span>
    <span class="n">nbins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="n">ordered_purples</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution of Bipartisan Vote Counts&#39;</span>
<span class="p">)</span>
<span class="n">fig1</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="n">legend_title_text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">fig1</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 2. Percentile distribution</span>
<span class="n">pct_melt</span> <span class="o">=</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span>
    <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;Name&#39;</span><span class="p">],</span>
    <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;norm_G&#39;</span><span class="p">,</span><span class="s1">&#39;norm_H&#39;</span><span class="p">],</span>
    <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;Metric&#39;</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;Percentile&#39;</span>
<span class="p">)</span>

<span class="n">fig2</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span>
    <span class="n">pct_melt</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Percentile&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;Metric&#39;</span><span class="p">,</span> <span class="n">barmode</span><span class="o">=</span><span class="s1">&#39;overlay&#39;</span><span class="p">,</span>
    <span class="n">nbins</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color_discrete_sequence</span><span class="o">=</span><span class="n">ordered_purples</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Distribution of Bipartisan Vote Percentiles&#39;</span>
<span class="p">)</span>
<span class="n">fig2</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="n">legend_title_text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">xaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">showgrid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">fig2</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># 3. Missing‐value profile for all columns</span>
<span class="n">missing_df</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">meta_data</span>
    <span class="o">.</span><span class="n">isna</span><span class="p">()</span>
    <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="s1">&#39;Column&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;MissingCount&#39;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;MissingPct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">missing_df</span><span class="p">[</span><span class="s1">&#39;MissingCount&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">meta_data</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">fig3</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">missing_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Column&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;MissingPct&#39;</span><span class="p">,</span>
    <span class="n">text</span><span class="o">=</span><span class="s1">&#39;MissingCount&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;MissingPct&#39;</span><span class="p">,</span>
    <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">ordered_purples</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Missing Values by Column&#39;</span>
<span class="p">)</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">update_traces</span><span class="p">(</span>
    <span class="n">marker_line_color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker_line_width</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;Missing (%)&#39;</span><span class="p">,</span> <span class="n">xaxis_tickangle</span><span class="o">=-</span><span class="mi">45</span>
<span class="p">)</span>
<span class="n">fig3</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="61af74b9-bd4c-4bf2-9190-f3935ad04b53" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("61af74b9-bd4c-4bf2-9190-f3935ad04b53")) {                    Plotly.newPlot(                        "61af74b9-bd4c-4bf2-9190-f3935ad04b53",                        [{"alignmentgroup":"True","bingroup":"x","hovertemplate":"Metric=Vote for Cosponsored Bill\u003cbr\u003eCount=%{x}\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Vote for Cosponsored Bill","marker":{"color":"#3f007d","opacity":0.5,"pattern":{"shape":""}},"name":"Vote for Cosponsored Bill","nbinsx":30,"offsetgroup":"Vote for Cosponsored Bill","orientation":"v","showlegend":true,"x":[2855.0,1116.0,2855.0,2855.0,2855.0,2855.0,1211.0,0.0,0.0,2855.0,0.0,0.0,2855.0,2855.0,255.0,1260.0,2797.0,2710.0,0.0,2855.0,2746.0,0.0,0.0,2807.0,2855.0,2855.0,2855.0,0.0,0.0,2855.0,146.0,2855.0,552.0,2855.0,350.0,350.0,146.0,1462.0,146.0,0.0,146.0,1629.0,845.0,350.0,437.0,352.0,552.0,972.0,2796.0,1227.0,2489.0,2746.0,552.0,350.0,233.0,973.0,350.0,146.0,552.0,255.0,350.0,350.0,350.0,639.0,350.0,146.0,146.0,146.0,2855.0,2855.0,146.0,350.0,146.0,1357.0,291.0,993.0,2855.0,1407.0,748.0,146.0,255.0,0.0,0.0,146.0,146.0,2855.0,2855.0,2855.0,233.0,0.0,2855.0,0.0,0.0,552.0,1199.0,453.0,845.0,805.0,0.0,0.0,641.0,0.0,0.0,0.0,2855.0,2855.0,2855.0,2855.0,405.0,2750.0,2855.0,750.0,146.0,2855.0,2855.0,2749.0,146.0,2855.0,2688.0,2746.0,2855.0,2702.0,457.0,2855.0,457.0,1484.0,146.0,516.0,2447.0,2855.0,2449.0,0.0,0.0,2855.0,1087.0,2855.0,146.0,146.0,795.0,2855.0,2855.0,2855.0,2855.0,2855.0,2855.0,348.0,2380.0,0.0,0.0,906.0,146.0,0.0,0.0,2855.0,2855.0,0.0,0.0,348.0,146.0,146.0,146.0,435.0,146.0,146.0,146.0,146.0,661.0,435.0,2855.0,1201.0,146.0,2746.0,2855.0,1403.0,0.0,0.0,708.0,2855.0,2855.0,2855.0,2855.0,2855.0,146.0,2855.0,2855.0,0.0,0.0,2855.0,2855.0,2855.0,2855.0,0.0,0.0,2855.0,2855.0,1403.0,2855.0,0.0,0.0,2855.0,2855.0,146.0,2397.0,2855.0,2855.0,0.0,0.0,2709.0,348.0,2855.0,2650.0,2746.0,348.0,0.0,0.0,146.0,1996.0,0.0,0.0,2746.0,435.0,494.0,435.0,639.0,1512.0,435.0,146.0,0.0,0.0,348.0,146.0,352.0,639.0,146.0,233.0,146.0,1199.0,540.0,0.0,0.0,2738.0,2855.0,1462.0,2855.0,2855.0,146.0,2855.0,1403.0,2258.0,2855.0,255.0,146.0,342.0,0.0,0.0,2855.0,1571.0,641.0,146.0,146.0,2855.0,2855.0,2855.0,0.0,0.0,2855.0,146.0,2855.0,2855.0,0.0,0.0,314.0,2746.0,2285.0,2855.0,233.0,2855.0,2855.0,2807.0,0.0,0.0,2855.0,2855.0,0.0,0.0,2855.0,2796.0,2855.0,0.0,0.0,1112.0,2796.0,1571.0,1379.0,0.0,0.0,1571.0,1462.0,0.0,0.0,457.0,2746.0,641.0,2855.0,1053.0,314.0,2855.0,255.0,435.0,146.0,643.0,146.0,0.0,0.0,233.0,1067.0,233.0,0.0,0.0,2855.0,2768.0,1571.0,1571.0,146.0,342.0,146.0,146.0,146.0,342.0,2855.0,146.0,146.0,146.0,1175.0,516.0,2855.0,914.0,1023.0,146.0,2551.0,1199.0,2855.0,2855.0,993.0,659.0,0.0,0.0,1571.0,435.0,2746.0,146.0,2855.0,2855.0,2855.0,2855.0,2855.0,2855.0,2855.0,146.0,2855.0,2854.0,0.0,0.0,2855.0,0.0,0.0,1425.0,2855.0,350.0,2768.0,2855.0,2855.0,2855.0,2649.0,1461.0,2464.0,146.0,2855.0,1308.0,2768.0,2855.0,0.0,0.0,2746.0,2578.0,2855.0,2855.0,2855.0,0.0,0.0,146.0,2855.0,146.0,912.0,1298.0,659.0,0.0,0.0,2807.0,1007.0,146.0,146.0,146.0,1008.0,2855.0,2855.0,2855.0,2855.0,2855.0,146.0,2855.0,2855.0,2855.0,2702.0,621.0,0.0,0.0,0.0,348.0,950.0,0.0,0.0,2855.0,2328.0,2855.0,2855.0,2746.0,556.0,2855.0,0.0,0.0,2855.0,0.0,0.0,2523.0,2855.0,2855.0,2578.0,2595.0,2797.0,2768.0,2746.0,639.0,0.0,0.0,2855.0,2855.0,2855.0,2855.0,2855.0,2855.0,204.0,2855.0,146.0,2796.0,2855.0,2855.0,2796.0,2855.0,2332.0,233.0,2855.0,2855.0,233.0,2855.0,2855.0,2855.0,2855.0,1839.0,2855.0,2746.0,2815.0,146.0,146.0,2855.0,699.0,824.0,1710.0,146.0,2855.0,146.0,2544.0,0.0,0.0,2855.0,2855.0,2855.0,2855.0,0.0,0.0,146.0,0.0,0.0,0.0,2855.0,2855.0,146.0,146.0,2855.0,2855.0,1294.0,146.0,2855.0,1203.0,233.0,0.0,0.0,348.0,348.0,1995.0,2855.0,2855.0,146.0,146.0,1512.0,146.0,348.0,0.0,0.0,2797.0,2855.0,0.0,0.0,2855.0,146.0,2855.0,146.0,2855.0,2855.0,2746.0,2855.0,0.0,0.0,2855.0,0.0,0.0],"xaxis":"x","yaxis":"y","type":"histogram"},{"alignmentgroup":"True","bingroup":"x","hovertemplate":"Metric=Vote for Other Party\u003cbr\u003eCount=%{x}\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"Vote for Other Party","marker":{"color":"#54278f","opacity":0.5,"pattern":{"shape":""}},"name":"Vote for Other Party","nbinsx":30,"offsetgroup":"Vote for Other Party","orientation":"v","showlegend":true,"x":[607.0,596.0,607.0,607.0,607.0,607.0,691.0,0.0,0.0,607.0,0.0,0.0,607.0,607.0,109.0,653.0,607.0,520.0,0.0,607.0,607.0,0.0,0.0,607.0,607.0,607.0,607.0,0.0,0.0,607.0,0.0,607.0,406.0,607.0,204.0,204.0,0.0,855.0,0.0,0.0,0.0,1022.0,406.0,204.0,204.0,0.0,406.0,620.0,607.0,913.0,607.0,607.0,406.0,204.0,0.0,366.0,204.0,0.0,406.0,109.0,263.0,204.0,204.0,406.0,204.0,0.0,0.0,0.0,607.0,607.0,0.0,204.0,0.0,750.0,58.0,592.0,607.0,800.0,515.0,0.0,109.0,0.0,0.0,0.0,0.0,607.0,607.0,607.0,0.0,0.0,607.0,0.0,0.0,406.0,592.0,307.0,406.0,285.0,0.0,0.0,202.0,0.0,0.0,0.0,607.0,607.0,607.0,607.0,0.0,607.0,607.0,311.0,0.0,607.0,607.0,607.0,0.0,607.0,607.0,607.0,607.0,607.0,311.0,607.0,311.0,964.0,0.0,370.0,401.0,607.0,607.0,0.0,0.0,607.0,854.0,607.0,0.0,0.0,394.0,607.0,607.0,607.0,607.0,607.0,607.0,202.0,607.0,0.0,0.0,673.0,0.0,0.0,0.0,607.0,607.0,0.0,0.0,202.0,0.0,0.0,0.0,202.0,0.0,0.0,0.0,0.0,515.0,202.0,607.0,594.0,0.0,607.0,607.0,796.0,0.0,0.0,307.0,607.0,607.0,607.0,607.0,607.0,0.0,607.0,607.0,0.0,0.0,607.0,607.0,607.0,607.0,0.0,0.0,607.0,607.0,796.0,607.0,0.0,0.0,607.0,607.0,0.0,461.0,607.0,607.0,0.0,0.0,461.0,202.0,607.0,461.0,607.0,202.0,0.0,0.0,0.0,1389.0,0.0,0.0,607.0,202.0,261.0,202.0,406.0,905.0,202.0,0.0,0.0,0.0,202.0,0.0,0.0,406.0,0.0,0.0,0.0,592.0,307.0,0.0,0.0,607.0,607.0,855.0,607.0,607.0,0.0,607.0,796.0,255.0,607.0,109.0,0.0,109.0,0.0,0.0,607.0,964.0,202.0,0.0,0.0,607.0,607.0,607.0,0.0,0.0,607.0,0.0,607.0,607.0,0.0,0.0,168.0,607.0,607.0,607.0,0.0,607.0,607.0,607.0,0.0,0.0,607.0,607.0,0.0,0.0,607.0,607.0,607.0,0.0,0.0,592.0,607.0,964.0,859.0,0.0,0.0,964.0,855.0,0.0,0.0,311.0,607.0,202.0,607.0,760.0,168.0,607.0,109.0,202.0,0.0,204.0,0.0,0.0,0.0,0.0,628.0,0.0,0.0,0.0,607.0,520.0,964.0,964.0,0.0,109.0,0.0,0.0,0.0,109.0,607.0,0.0,0.0,0.0,655.0,370.0,607.0,475.0,416.0,0.0,607.0,592.0,607.0,607.0,592.0,307.0,0.0,0.0,964.0,202.0,607.0,0.0,607.0,607.0,607.0,607.0,607.0,607.0,607.0,0.0,607.0,607.0,0.0,0.0,607.0,0.0,0.0,818.0,607.0,204.0,520.0,607.0,607.0,607.0,401.0,854.0,255.0,0.0,607.0,701.0,520.0,607.0,0.0,0.0,607.0,439.0,607.0,607.0,607.0,0.0,0.0,0.0,607.0,0.0,511.0,691.0,307.0,0.0,0.0,607.0,487.0,0.0,0.0,0.0,569.0,607.0,607.0,607.0,607.0,607.0,0.0,607.0,607.0,607.0,607.0,307.0,0.0,0.0,0.0,202.0,511.0,0.0,0.0,607.0,607.0,607.0,607.0,607.0,204.0,607.0,0.0,0.0,607.0,0.0,0.0,520.0,607.0,607.0,439.0,607.0,607.0,520.0,607.0,406.0,0.0,0.0,607.0,607.0,607.0,607.0,607.0,607.0,58.0,607.0,0.0,607.0,607.0,607.0,607.0,607.0,607.0,0.0,607.0,607.0,0.0,607.0,607.0,607.0,607.0,607.0,607.0,607.0,2208.0,0.0,0.0,607.0,260.0,678.0,1103.0,0.0,607.0,0.0,401.0,0.0,0.0,607.0,607.0,607.0,607.0,0.0,0.0,0.0,0.0,0.0,0.0,607.0,607.0,0.0,0.0,607.0,607.0,855.0,0.0,607.0,596.0,0.0,0.0,0.0,202.0,202.0,1388.0,607.0,607.0,0.0,0.0,905.0,0.0,202.0,0.0,0.0,607.0,607.0,0.0,0.0,607.0,0.0,607.0,0.0,607.0,607.0,607.0,607.0,0.0,0.0,607.0,0.0,0.0],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Count"},"showgrid":true},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"count"},"showgrid":true},"legend":{"title":{"text":""},"tracegroupgap":0},"title":{"text":"Distribution of Bipartisan Vote Counts"},"barmode":"overlay","plot_bgcolor":"white","paper_bgcolor":"white"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('61af74b9-bd4c-4bf2-9190-f3935ad04b53');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div><div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="fb8560b4-8c98-4c1b-9009-5ee120b0b803" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("fb8560b4-8c98-4c1b-9009-5ee120b0b803")) {                    Plotly.newPlot(                        "fb8560b4-8c98-4c1b-9009-5ee120b0b803",                        [{"alignmentgroup":"True","bingroup":"x","hovertemplate":"Metric=norm_G\u003cbr\u003ePercentile=%{x}\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"norm_G","marker":{"color":"#3f007d","opacity":0.5,"pattern":{"shape":""}},"name":"norm_G","nbinsx":30,"offsetgroup":"norm_G","orientation":"v","showlegend":true,"x":[88.32118908547119,42.15295115263524,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,45.14128611244547,13.796995584157628,13.796995584157628,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,18.786759619209132,46.69458517853391,87.38673532699869,85.88944595326889,13.796995584157628,88.32118908547119,86.52302717326819,13.796995584157628,13.796995584157628,87.55146113657855,88.32118908547119,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,16.531268536218196,88.32118908547119,25.832214716614942,88.32118908547119,20.900110919471548,20.900110919471548,16.531268536218196,53.12513410996117,16.531268536218196,13.796995584157628,16.531268536218196,58.38769417993252,33.92659725673382,20.900110919471548,22.95307368703588,20.946056871704634,25.832214716614942,37.713469827801376,87.37017956198908,45.64778548023127,81.56263655408709,86.52302717326819,25.832214716614942,20.900110919471548,18.31684657363525,37.743819032307236,20.900110919471548,16.531268536218196,25.832214716614942,18.786759619209132,20.900110919471548,20.900110919471548,20.900110919471548,28.128518151190413,20.900110919471548,16.531268536218196,16.531268536218196,16.531268536218196,88.32118908547119,88.32118908547119,16.531268536218196,20.900110919471548,16.531268536218196,49.78209068104353,19.571594964278788,38.352369550796105,88.32118908547119,51.37526833242973,31.137574154144644,16.531268536218196,18.786759619209132,13.796995584157628,13.796995584157628,16.531268536218196,16.531268536218196,88.32118908547119,88.32118908547119,88.32118908547119,18.31684657363525,13.796995584157628,88.32118908547119,13.796995584157628,13.796995584157628,25.832214716614942,44.761925424709545,23.34256451404092,33.92659725673382,32.76466655577085,13.796995584157628,13.796995584157628,28.182443854052664,13.796995584157628,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,22.18512517401876,86.59220075607186,88.32118908547119,31.19406986194015,16.531268536218196,88.32118908547119,88.32118908547119,86.57493027181403,16.531268536218196,88.32118908547119,85.49246669281129,86.52302717326819,88.32118908547119,85.7459507205441,23.440507004550664,88.32118908547119,23.440507004550664,53.82358301590789,16.531268536218196,24.91125890546951,80.65550230311887,88.32118908547119,80.69930708670425,13.796995584157628,13.796995584157628,88.32118908547119,41.24884193523773,88.32118908547119,16.531268536218196,16.531268536218196,32.4767183329406,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,20.85422438031755,79.15321801423015,13.796995584157628,13.796995584157628,35.72802434463195,16.531268536218196,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,20.85422438031755,16.531268536218196,16.531268536218196,16.531268536218196,22.904644683626085,16.531268536218196,16.531268536218196,16.531268536218196,16.531268536218196,28.724423051750026,22.904644683626085,88.32118908547119,44.82511989783406,16.531268536218196,86.52302717326819,88.32118908547119,51.247861184207366,13.796995584157628,13.796995584157628,30.017124552403875,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,16.531268536218196,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,51.247861184207366,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,16.531268536218196,79.54076695614482,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,85.87156281278732,20.85422438031755,88.32118908547119,84.78922344139792,86.52302717326819,20.85422438031755,13.796995584157628,13.796995584157628,16.531268536218196,69.32189205747122,13.796995584157628,13.796995584157628,86.52302717326819,22.904644683626085,24.35717138157138,22.904644683626085,28.128518151190413,54.710787334162234,22.904644683626085,16.531268536218196,13.796995584157628,13.796995584157628,20.85422438031755,16.531268536218196,20.946056871704634,28.128518151190413,16.531268536218196,18.31684657363525,16.531268536218196,44.761925424709545,25.523281354951553,13.796995584157628,13.796995584157628,86.38394641597105,88.32118908547119,53.12513410996117,88.32118908547119,88.32118908547119,16.531268536218196,88.32118908547119,51.247861184207366,76.24763166086947,88.32118908547119,18.786759619209132,16.531268536218196,20.716921641047293,13.796995584157628,13.796995584157628,88.32118908547119,56.57204956529077,28.182443854052664,16.531268536218196,16.531268536218196,88.32118908547119,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,16.531268536218196,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,20.083280945155792,86.52302717326819,76.90918805082909,88.32118908547119,18.31684657363525,88.32118908547119,88.32118908547119,87.55146113657855,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,87.37017956198908,88.32118908547119,13.796995584157628,13.796995584157628,42.02798881099567,87.37017956198908,56.57204956529077,50.483196327590804,13.796995584157628,13.796995584157628,56.57204956529077,53.12513410996117,13.796995584157628,13.796995584157628,23.440507004550664,86.52302717326819,28.182443854052664,88.32118908547119,40.194768682742755,20.083280945155792,88.32118908547119,18.786759619209132,22.904644683626085,16.531268536218196,28.236419328820006,16.531268536218196,13.796995584157628,13.796995584157628,18.31684657363525,40.62798239189515,18.31684657363525,13.796995584157628,13.796995584157628,88.32118908547119,86.90046076249655,56.57204956529077,56.57204956529077,16.531268536218196,20.716921641047293,16.531268536218196,16.531268536218196,16.531268536218196,20.716921641047293,88.32118908547119,16.531268536218196,16.531268536218196,16.531268536218196,44.00467387537876,24.91125890546951,88.32118908547119,35.96675977581643,39.27056381780417,16.531268536218196,82.85244370392859,44.761925424709545,88.32118908547119,88.32118908547119,38.352369550796105,28.670003808783374,13.796995584157628,13.796995584157628,56.57204956529077,22.904644683626085,86.52302717326819,16.531268536218196,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,16.531268536218196,88.32118908547119,88.30550518118592,13.796995584157628,13.796995584157628,88.32118908547119,13.796995584157628,13.796995584157628,51.94840805035123,88.32118908547119,20.900110919471548,86.90046076249655,88.32118908547119,88.32118908547119,88.32118908547119,84.77041636568697,53.09336192486796,81.02590861939693,16.531268536218196,88.32118908547119,48.22109729652719,86.90046076249655,88.32118908547119,13.796995584157628,13.796995584157628,86.52302717326819,83.39565598774792,88.32118908547119,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,16.531268536218196,88.32118908547119,16.531268536218196,35.9070241286096,47.90278402948645,28.670003808783374,13.796995584157628,13.796995584157628,87.55146113657855,38.7800811524772,16.531268536218196,16.531268536218196,16.531268536218196,38.81068482323645,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,16.531268536218196,88.32118908547119,88.32118908547119,88.32118908547119,85.7459507205441,27.645441567383568,13.796995584157628,13.796995584157628,13.796995584157628,20.85422438031755,37.047737841888505,13.796995584157628,13.796995584157628,88.32118908547119,77.94121793841889,88.32118908547119,88.32118908547119,86.52302717326819,25.935621442483264,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,13.796995584157628,13.796995584157628,82.27725632503,88.32118908547119,88.32118908547119,83.39565598774792,83.73191010828661,87.38673532699869,86.90046076249655,86.52302717326819,28.128518151190413,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,17.708728052530216,88.32118908547119,16.531268536218196,87.37017956198908,88.32118908547119,88.32118908547119,87.37017956198908,88.32118908547119,78.03585844510135,18.31684657363525,88.32118908547119,88.32118908547119,18.31684657363525,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,64.7870543530343,88.32118908547119,86.52302717326819,87.68215437553988,16.531268536218196,16.531268536218196,88.32118908547119,29.767557423184414,33.3145900005853,60.89285699614886,16.531268536218196,88.32118908547119,16.531268536218196,82.70977745771668,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,88.32118908547119,88.32118908547119,13.796995584157628,13.796995584157628,16.531268536218196,13.796995584157628,13.796995584157628,13.796995584157628,88.32118908547119,88.32118908547119,16.531268536218196,16.531268536218196,88.32118908547119,88.32118908547119,47.775495026552505,16.531268536218196,88.32118908547119,44.88832750584946,18.31684657363525,13.796995584157628,13.796995584157628,20.85422438031755,20.85422438031755,69.29383259209085,88.32118908547119,88.32118908547119,16.531268536218196,16.531268536218196,54.710787334162234,16.531268536218196,20.85422438031755,13.796995584157628,13.796995584157628,87.38673532699869,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,16.531268536218196,88.32118908547119,16.531268536218196,88.32118908547119,88.32118908547119,86.52302717326819,88.32118908547119,13.796995584157628,13.796995584157628,88.32118908547119,13.796995584157628,13.796995584157628],"xaxis":"x","yaxis":"y","type":"histogram"},{"alignmentgroup":"True","bingroup":"x","hovertemplate":"Metric=norm_H\u003cbr\u003ePercentile=%{x}\u003cbr\u003ecount=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"norm_H","marker":{"color":"#54278f","opacity":0.5,"pattern":{"shape":""}},"name":"norm_H","nbinsx":30,"offsetgroup":"norm_H","orientation":"v","showlegend":true,"x":[78.65964695433848,77.63068070609873,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,85.5673915565704,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,21.628617744742517,82.65352228595265,78.65964695433848,69.80278221405005,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,78.65964695433848,56.24455505600303,78.65964695433848,31.437254237635155,31.437254237635155,12.913205196306437,94.3087046500068,12.913205196306437,12.913205196306437,12.913205196306437,98.26090254032395,56.24455505600303,31.437254237635155,31.437254237635155,12.913205196306437,56.24455505600303,79.83939413239773,78.65964695433848,96.12333883117121,78.65964695433848,78.65964695433848,56.24455505600303,31.437254237635155,12.913205196306437,51.20892386576665,31.437254237635155,12.913205196306437,56.24455505600303,21.628617744742517,38.34743126677411,31.437254237635155,31.437254237635155,56.24455505600303,31.437254237635155,12.913205196306437,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,31.437254237635155,12.913205196306437,89.40226199198811,17.193411029233825,77.24963047913214,78.65964695433848,92.02550414830624,69.24751982037087,12.913205196306437,21.628617744742517,12.913205196306437,12.913205196306437,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,12.913205196306437,56.24455505600303,77.24963047913214,43.76943517832566,56.24455505600303,41.03701100714821,12.913205196306437,12.913205196306437,31.212457391000825,12.913205196306437,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,44.269851008796124,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,44.269851008796124,78.65964695433848,44.269851008796124,97.3006082700524,12.913205196306437,51.71469732887427,55.618922193671395,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,94.27236757041322,78.65964695433848,12.913205196306437,12.913205196306437,54.7407128456836,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,31.212457391000825,78.65964695433848,12.913205196306437,12.913205196306437,84.23092338950703,12.913205196306437,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,31.212457391000825,12.913205196306437,12.913205196306437,12.913205196306437,31.212457391000825,12.913205196306437,12.913205196306437,12.913205196306437,12.913205196306437,69.24751982037087,31.212457391000825,78.65964695433848,77.44061087103546,12.913205196306437,78.65964695433848,78.65964695433848,91.83567029003028,12.913205196306437,12.913205196306437,43.76943517832566,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,91.83567029003028,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,62.990863589164235,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,62.990863589164235,31.212457391000825,78.65964695433848,62.990863589164235,78.65964695433848,31.212457391000825,12.913205196306437,12.913205196306437,12.913205196306437,99.94714486886855,12.913205196306437,12.913205196306437,78.65964695433848,31.212457391000825,38.105475156269456,31.212457391000825,56.24455505600303,95.90537043630685,31.212457391000825,12.913205196306437,12.913205196306437,12.913205196306437,31.212457391000825,12.913205196306437,12.913205196306437,56.24455505600303,12.913205196306437,12.913205196306437,12.913205196306437,77.24963047913214,43.76943517832566,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,94.3087046500068,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,91.83567029003028,37.38242689858856,78.65964695433848,21.628617744742517,12.913205196306437,21.628617744742517,12.913205196306437,12.913205196306437,78.65964695433848,97.3006082700524,31.212457391000825,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,27.50293794745803,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,77.24963047913214,78.65964695433848,97.3006082700524,94.45224068887683,12.913205196306437,12.913205196306437,97.3006082700524,94.3087046500068,12.913205196306437,12.913205196306437,44.269851008796124,78.65964695433848,31.212457391000825,78.65964695433848,89.9714159715166,27.50293794745803,78.65964695433848,21.628617744742517,31.212457391000825,12.913205196306437,31.437254237635155,12.913205196306437,12.913205196306437,12.913205196306437,12.913205196306437,80.54556613360214,12.913205196306437,12.913205196306437,12.913205196306437,78.65964695433848,69.80278221405005,97.3006082700524,97.3006082700524,12.913205196306437,21.628617744742517,12.913205196306437,12.913205196306437,12.913205196306437,21.628617744742517,78.65964695433848,12.913205196306437,12.913205196306437,12.913205196306437,82.81563690911247,51.71469732887427,78.65964695433848,64.65467555203328,57.49099596888462,12.913205196306437,78.65964695433848,77.24963047913214,78.65964695433848,78.65964695433848,77.24963047913214,43.76943517832566,12.913205196306437,12.913205196306437,97.3006082700524,31.212457391000825,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,12.913205196306437,92.83863912766657,78.65964695433848,31.437254237635155,69.80278221405005,78.65964695433848,78.65964695433848,78.65964695433848,55.618922193671395,94.27236757041322,37.38242689858856,12.913205196306437,78.65964695433848,86.27590112695287,69.80278221405005,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,60.32759916781356,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,68.80010397698615,85.5673915565704,43.76943517832566,12.913205196306437,12.913205196306437,78.65964695433848,66.05898197376303,12.913205196306437,12.913205196306437,12.913205196306437,74.98907173601998,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,43.76943517832566,12.913205196306437,12.913205196306437,12.913205196306437,31.212457391000825,68.80010397698615,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,31.437254237635155,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,12.913205196306437,69.80278221405005,78.65964695433848,78.65964695433848,60.32759916781356,78.65964695433848,78.65964695433848,69.80278221405005,78.65964695433848,56.24455505600303,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,17.193411029233825,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,99.99999978526613,12.913205196306437,12.913205196306437,78.65964695433848,37.98467060544056,84.61006772138776,99.10526255596524,12.913205196306437,78.65964695433848,12.913205196306437,55.618922193671395,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,12.913205196306437,12.913205196306437,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,94.3087046500068,12.913205196306437,78.65964695433848,77.63068070609873,12.913205196306437,12.913205196306437,12.913205196306437,31.212457391000825,31.212457391000825,99.94654839556374,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,95.90537043630685,12.913205196306437,31.212457391000825,12.913205196306437,12.913205196306437,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,78.65964695433848,12.913205196306437,78.65964695433848,78.65964695433848,78.65964695433848,78.65964695433848,12.913205196306437,12.913205196306437,78.65964695433848,12.913205196306437,12.913205196306437],"xaxis":"x","yaxis":"y","type":"histogram"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Percentile"},"showgrid":true},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"count"},"showgrid":true},"legend":{"title":{"text":""},"tracegroupgap":0},"title":{"text":"Distribution of Bipartisan Vote Percentiles"},"barmode":"overlay","plot_bgcolor":"white","paper_bgcolor":"white"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('fb8560b4-8c98-4c1b-9009-5ee120b0b803');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div><div class="output text_html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.35.2.min.js"></script>                <div id="bdc1ea4c-6367-4ac9-bf87-488c205367a5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("bdc1ea4c-6367-4ac9-bf87-488c205367a5")) {                    Plotly.newPlot(                        "bdc1ea4c-6367-4ac9-bf87-488c205367a5",                        [{"alignmentgroup":"True","hovertemplate":"Column=%{x}\u003cbr\u003eMissingPct=%{marker.color}\u003cbr\u003eMissingCount=%{text}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"","marker":{"color":[0.0,0.0,0.0,0.0,18.65671641791045,0.0,0.0,0.0,0.0,0.0,0.0,19.776119402985074,0.0,0.0,0.0,0.0],"coloraxis":"coloraxis","pattern":{"shape":""},"line":{"color":"black","width":1}},"name":"","offsetgroup":"","orientation":"v","showlegend":false,"text":[0.0,0.0,0.0,0.0,100.0,0.0,0.0,0.0,0.0,0.0,0.0,106.0,0.0,0.0,0.0,0.0],"textposition":"auto","x":["Name","Chamber","bioguide_id","State","District","Party","name_clean","first_name","middle_name","last_name","short_name","Name_y","Vote for Other Party","Vote for Cosponsored Bill","norm_G","norm_H"],"xaxis":"x","y":[0.0,0.0,0.0,0.0,18.65671641791045,0.0,0.0,0.0,0.0,0.0,0.0,19.776119402985074,0.0,0.0,0.0,0.0],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Column"},"tickangle":-45},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Missing (%)"}},"coloraxis":{"colorbar":{"title":{"text":"MissingPct"}},"colorscale":[[0.0,"#3f007d"],[0.2,"#54278f"],[0.4,"#6a51a3"],[0.6,"#807dba"],[0.8,"#9e9ac8"],[1.0,"#bcbddc"]]},"legend":{"tracegroupgap":0},"title":{"text":"Missing Values by Column"},"barmode":"relative","plot_bgcolor":"white","paper_bgcolor":"white"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('bdc1ea4c-6367-4ac9-bf87-488c205367a5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html></div></div>
</div>
</section>
<section id="interpretation-of-visualizations">
<h3><strong>Interpretation of Visualizations</strong><a class="headerlink" href="#interpretation-of-visualizations" title="Link to this heading">#</a></h3>
<section id="distribution-of-bipartisan-vote-counts">
<h4><strong>Distribution of Bipartisan Vote Counts</strong><a class="headerlink" href="#distribution-of-bipartisan-vote-counts" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Both metrics are highly right-skewed: most legislators cast relatively few cross-party or opposite-party “yes” votes, while a small handful have very high counts.</p></li>
<li><p>The tall bar at low counts (near zero) shows that many legislators rarely vote across party lines or on bills they didn’t sponsor.</p></li>
<li><p>The long tail—especially visible for <code class="docutils literal notranslate"><span class="pre">Vote</span> <span class="pre">for</span> <span class="pre">Other</span> <span class="pre">Party</span></code>—highlights a subset of highly bipartisan voters who consistently cross party lines.</p></li>
</ul>
</section>
<section id="distribution-of-bipartisan-vote-percentiles">
<h4><strong>Distribution of Bipartisan Vote Percentiles</strong><a class="headerlink" href="#distribution-of-bipartisan-vote-percentiles" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Translating raw counts into percentiles produces two distributions clustering at the extremes:</p>
<ul>
<li><p>A dense peak at the low end (0–20 %) for the majority who rarely cross party lines.</p></li>
<li><p>A secondary peak at the high end (80–100 %) representing the top performers in each metric.</p></li>
</ul>
</li>
<li><p>This bimodal shape underscores the polarization in voting behavior: most legislators either seldom or frequently cross the aisle, with fewer in the middle.</p></li>
</ul>
</section>
<section id="missing-values-by-column">
<h4><strong>Missing Values by Column</strong><a class="headerlink" href="#missing-values-by-column" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Two columns stand out with substantial missingness:</p>
<ul>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">District</span></code></strong> (~18 % missing): some legislators in the metadata lacked district information (e.g. Senators, delegates, or historical entries).</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">Name_y</span></code></strong> (~19 % missing): a vestige of earlier merges where some records failed to align on the legislator’s name.</p></li>
</ul>
</li>
<li><p>All other key metrics and metadata fields (party, chamber, vote counts, percentiles) are fully populated, ensuring our Bridge Grade calculations aren’t impaired by missing data in the core indicators.</p></li>
</ul>
<p>Overall, these charts confirm that our metrics capture a polarized but meaningful spectrum of bipartisan activity, and that data completeness is sufficient for robust Bridge Grade scoring.</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Source%20C-D-E-F.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Source C-D-E-F: App Communications Calculations Data Processing</p>
      </div>
    </a>
    <a class="right-next"
       href="Source%20M.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Source M: Cook Political Partisan Voting Index (PVI) Processing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources">Data Sources</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files">Input Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-details">Data Source Details</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs">Outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-g-votes-for-cosponsored-bills">Source G: Votes for Cosponsored Bills</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-h-votes-for-bills-sponsored-by-opposing-party">Source H: Votes for Bills Sponsored by Opposing Party</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-dataset">Complete Dataset</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements">Technical Requirements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-notes">Performance Notes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality">Data Quality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-integrity-notes">Data Integrity Notes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitations">Limitations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-walkthrough-source-g-h"><strong>Notebook Walkthrough: Source G-H</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preprocessing-for-bridge-grades-vote-based-bipartisanship-data"><strong>Preprocessing for Bridge Grades: Vote-Based Bipartisanship Data</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#match-sponsorships-to-legislators"><strong>Match Sponsorships to Legislators</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-and-normalize-name-fields"><strong>Clean and Normalize Name Fields</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#split-name-clean-into-components"><strong>Split <code class="docutils literal notranslate"><span class="pre">name_clean</span></code> into Components</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#build-short-name-handle"><strong>Build Short Name Handle</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#fuzzy-match-sponsorships-to-legislators"><strong>Fuzzy Match Sponsorships to Legislators</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-billsponsor-relationships"><strong>Build Bill–Sponsor Relationships</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-primary-sponsors-with-cosponsors"><strong>Merge Primary Sponsors with Cosponsors</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cross-party-sponsorship-flag"><strong>Compute Cross-Party Sponsorship Flag</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#validate-and-preview-results"><strong>Validate and Preview Results</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-on-passage-vote-table"><strong>Build “On Passage” Vote Table</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#pivot-vote-counts-into-columns"><strong>Pivot Vote Counts into Columns</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-with-vote-events-and-bills"><strong>Merge with Vote Events and Bills</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-total-votes-and-attach-sponsor-info"><strong>Compute Total Votes and Attach Sponsor Info</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-individual-vote-ids"><strong>Prepare Individual Vote IDs</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#process-individual-votes-compute-g-h-metrics"><strong>Process Individual Votes &amp; Compute G/H Metrics</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#split-house-senate-votes-and-recover-senate-ids"><strong>Split House &amp; Senate Votes and Recover Senate IDs</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-voter-metadata-attach-sponsor-info"><strong>Merge Voter Metadata &amp; Attach Sponsor Info</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#define-boolean-indicators-g-h"><strong>Define Boolean Indicators (G &amp; H)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aggregate-counts-per-legislator-merge-back"><strong>Aggregate Counts per Legislator &amp; Merge Back</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#normalize-scores-export-csvs"><strong>Normalize Scores &amp; Export CSVs</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualize-metrics-and-missing-data"><strong>Visualize Metrics and Missing Data</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation-of-visualizations"><strong>Interpretation of Visualizations</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-bipartisan-vote-counts"><strong>Distribution of Bipartisan Vote Counts</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#distribution-of-bipartisan-vote-percentiles"><strong>Distribution of Bipartisan Vote Percentiles</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#missing-values-by-column"><strong>Missing Values by Column</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bridge Grades Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>