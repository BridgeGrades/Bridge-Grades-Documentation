
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Bridge Pledge 119: Final Bridge Grade Calculation Engine &#8212; Bridge Grades Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Bridge_Pledge_119';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Source A-B: Legislator and Sponsorship Data Processing" href="Source%20A-B.html" />
    <link rel="prev" title="Bridge Grades Data Sources" href="Sources%20of%20Information.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-light" alt="Bridge Grades Documentation - Home"/>
    <script>document.write(`<img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-dark" alt="Bridge Grades Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Project%20Explanation.html"><strong>About Bridge Grades Project: Bridge Grades Data Pipeline Overview</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Sources%20of%20Information.html">Bridge Grades Data Sources</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Bridge Pledge 119: Final Bridge Grade Calculation Engine</a></li>

<li class="toctree-l1"><a class="reference internal" href="Source%20A-B.html">Source A-B: Legislator and Sponsorship Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20C-D-E-F.html">Source C-D-E-F: App Communications Calculations Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20G-H.html">Source G-H: Vote-Based Bipartisanship Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20M.html">Source M: Cook Political Partisan Voting Index (PVI) Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20N.html">Source N: VoteView Member Ideology Scores Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Next%20Steps.html"><strong>Next Steps</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FBridge_Pledge_119.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Bridge_Pledge_119.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Bridge Pledge 119: Final Bridge Grade Calculation Engine</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Bridge Pledge 119: Final Bridge Grade Calculation Engine</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources">Data Sources</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files">Input Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output Files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-functions">Main Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-and-setup">1. Configuration and Setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attendance-filtering">2. Attendance Filtering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-integration">3. Data Source Integration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-solvers-caucus-bonus">4. Problem Solvers Caucus Bonus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-score-calculation">5. Final Score Calculation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grade-assignment">6. Grade Assignment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs">Outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-datasets">Final Datasets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-columns-in-output">Key Columns in Output</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements">Technical Requirements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-processing-notes">Data Processing Notes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality">Data Quality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-checks">Validation Checks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#known-limitations">Known Limitations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insights">Key Insights</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scoring-philosophy">Scoring Philosophy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grade-distribution">Grade Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transparency-features">Transparency Features</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-walkthrough-bridge-pledge"><strong>Notebook Walkthrough: Bridge Pledge</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-supporting-libaries">Import supporting Libaries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-variables">Adjust Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Data Sources:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-table">Base Table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-members-below-attendance-threshold">Remove members below attendance threshold</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-data">Source Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#source-a-authors-of-bills-with-cross-party-sponsors">Source_A: Authors of Bills with Cross Party Sponsors</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-b-ranked-people-who-cosponsor-bills">Source_B: Ranked People who Cosponsor Bills</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-c-communication-bipartisanship-sum">Source_C: Communication: Bipartisanship (Sum)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-d-communication-bipartisanship-mean">Source_D: Communication: Bipartisanship (Mean)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-e-attack-personal-sum">Source_E: Attack_Personal (Sum)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-f-attack-personal-mean">Source_F: Attack_Personal (Mean)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-g-votes-for-cosponsored-bill">Source_G: Votes for Cosponsored Bill</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-h-votes-for-bill-sponsored-by-opposing-party">Source_H: Votes for Bill Sponsored by Opposing Party</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-m-cook-political-pvi">Source_M: Cook Political PVI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-n-vote-view-ideological-score">Source N: Vote view ideological score</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-o-app-ideology-score">Source O - APP Ideology Score</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-p-caucus-bump">Source_P: Caucus Bump</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#score-calculation-final-score">Score Calculation &amp; Final Score</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="bridge-pledge-119-final-bridge-grade-calculation-engine">
<h1>Bridge Pledge 119: Final Bridge Grade Calculation Engine<a class="headerlink" href="#bridge-pledge-119-final-bridge-grade-calculation-engine" title="Link to this heading">#</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>This notebook serves as the <strong>central scoring engine</strong> for the Bridge Grades methodology, combining all processed data sources to calculate final Bridge Grades for members of the 119th U.S. Congress. It implements the complete scoring algorithm that transforms raw collaboration metrics into letter grades (A, B, C, F) that identify “bridgers” from “dividers.”</p>
<p>The notebook processes data from <strong>10 different sources</strong> (A, B, C, D, E, F, G, H, M, N, O, P) and applies configurable weights to generate normalized scores that are then converted to final Bridge Grades.</p>
</section>
<hr class="docutils" />
<section id="data-sources">
<h2>Data Sources<a class="headerlink" href="#data-sources" title="Link to this heading">#</a></h2>
<section id="input-files">
<h3>Input Files<a class="headerlink" href="#input-files" title="Link to this heading">#</a></h3>
<p>All processed data sources from previous notebooks:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">119th</span> <span class="pre">Congress.csv</span></code></strong> - Master congressional roster with bioguide IDs, states, districts, parties, and chambers</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ranked_cross_party_sponsorships.csv</span></code></strong> - Source A: Authors of bills with cross-party sponsors</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">ranked_cosponsors_cross_party_bills.csv</span></code></strong> - Source B: Cosponsors of cross-party bills</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">app_communications_2025_04_24.csv</span></code></strong> - Source C/D/E/F: APP communications data (bipartisanship and personal attacks)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">votes.csv</span></code></strong> - Source G/H: Voting data (currently weighted at 0)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">house_pvi.csv</span></code></strong> - Source M: Cook Political PVI for House districts</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">senate_pvi.csv</span></code></strong> - Source M: Cook Political PVI for Senate states</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">HS119_members.csv</span></code></strong> - Source N: VoteView ideological scores</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">APP</span> <span class="pre">2025-04-25.csv</span></code></strong> - Source O: APP ideology scores</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">2025-04-25</span> <span class="pre">app</span> <span class="pre">raw</span> <span class="pre">profiles.csv</span></code></strong> - Attendance data for filtering</p></li>
</ul>
</section>
<section id="output-files">
<h3>Output Files<a class="headerlink" href="#output-files" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">house_scores_119.xlsx</span></code></strong> - Complete House member scores and grades</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">senate_scores_119.xlsx</span></code></strong> - Complete Senate member scores and grades</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="main-functions">
<h2>Main Functions<a class="headerlink" href="#main-functions" title="Link to this heading">#</a></h2>
<section id="configuration-and-setup">
<h3>1. Configuration and Setup<a class="headerlink" href="#configuration-and-setup" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Sets up scoring parameters and loads all data sources</p>
<p><strong>Key Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">att_pct</span> <span class="pre">=</span> <span class="pre">0.2</span></code> - Minimum attendance threshold (20%) for grading eligibility</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ps_score</span> <span class="pre">=</span> <span class="pre">25</span></code> - Bonus points for Problem Solvers Caucus members</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weights</span></code> - Configurable weights for each data source (A=2, B=1, C=0.5, D=0.5, etc.)</p></li>
</ul>
<p><strong>Code Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>    <span class="c1"># Source_A: Authors of Bills with Cross Party Sponsors</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>    <span class="c1"># Source_B: Ranked People who Cosponsor Bills</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Source_C: Communication: Bipartisanship (Sum)</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Source_D: Communication: Bipartisanship (Mean)</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Source_E: Attack_Personal (Sum)</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="c1"># Source_F: Attack_Personal (Mean)</span>
    <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>    <span class="c1"># Source_G: Votes for Cosponsored Bill (disabled)</span>
    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>    <span class="c1"># Source_H: Votes for Bill Sponsored by Opposing Party (disabled)</span>
    <span class="s1">&#39;M&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span> <span class="c1"># Source_M: PVI multiplier</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span> <span class="mf">0.0005</span><span class="p">,</span> <span class="c1"># Source_N: VoteView ideological score multiplier</span>
    <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mi">0</span>     <span class="c1"># Source_O: APP Ideology Score (disabled)</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="attendance-filtering">
<h3>2. Attendance Filtering<a class="headerlink" href="#attendance-filtering" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Removes members with attendance below threshold from grading</p>
<p><strong>Process:</strong></p>
<ul class="simple">
<li><p>Calculates attendance percentage for each member</p></li>
<li><p>Filters out members below 20% attendance threshold</p></li>
<li><p>Applies filtering to both House and Senate datasets</p></li>
</ul>
</section>
<section id="data-source-integration">
<h3>3. Data Source Integration<a class="headerlink" href="#data-source-integration" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Merges all processed data sources into master datasets</p>
<p><strong>For Each Source (A through O):</strong></p>
<ul class="simple">
<li><p>Loads processed CSV file</p></li>
<li><p>Merges with master dataset using bioguide_id</p></li>
<li><p>Fills missing values appropriately (0 for counts, mean for percentages)</p></li>
<li><p>Calculates normalized scores using normal distribution CDF</p></li>
<li><p>Renames columns with source prefix for clarity</p></li>
</ul>
<p><strong>Example for Source A:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge source data</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_A</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values with 0</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate normalized score</span>
<span class="n">mean_A</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_A</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">mean_A</span><span class="p">,</span> <span class="n">std_A</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
</pre></div>
</div>
</section>
<section id="problem-solvers-caucus-bonus">
<h3>4. Problem Solvers Caucus Bonus<a class="headerlink" href="#problem-solvers-caucus-bonus" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Awards bonus points to members of the Problem Solvers Caucus</p>
<p><strong>Process:</strong></p>
<ul class="simple">
<li><p>Defines list of 45 Problem Solvers Caucus members by bioguide_id</p></li>
<li><p>Awards 25 bonus points to qualifying members</p></li>
<li><p>Creates Source P score column</p></li>
</ul>
</section>
<section id="final-score-calculation">
<h3>5. Final Score Calculation<a class="headerlink" href="#final-score-calculation" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Combines all normalized scores using weighted algorithm</p>
<p><strong>Algorithm:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cal_score</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="c1"># Calculate base score (score_T) from weighted normalized values</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;norm_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    
    <span class="c1"># Apply ideology multipliers</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_M&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_N&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>
    
    <span class="c1"># Calculate final score including caucus bonus</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_P&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_M&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_N&#39;</span><span class="p">]</span>
    
    <span class="c1"># Normalize final score</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">],</span> <span class="n">mean_U</span><span class="p">,</span> <span class="n">std_U</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    
    <span class="k">return</span> <span class="n">temp_data</span>
</pre></div>
</div>
</section>
<section id="grade-assignment">
<h3>6. Grade Assignment<a class="headerlink" href="#grade-assignment" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Converts final scores to letter grades using statistical thresholds</p>
<p><strong>Grading Logic:</strong></p>
<ul class="simple">
<li><p><strong>A Grade:</strong> Score &gt; mean + standard deviation</p></li>
<li><p><strong>B Grade:</strong> Score &gt; median</p></li>
<li><p><strong>C Grade:</strong> Score &gt; mean - standard deviation</p></li>
<li><p><strong>F Grade:</strong> Score ≤ mean - standard deviation</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="outputs">
<h2>Outputs<a class="headerlink" href="#outputs" title="Link to this heading">#</a></h2>
<section id="final-datasets">
<h3>Final Datasets<a class="headerlink" href="#final-datasets" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>House Scores Dataset</strong> (<code class="docutils literal notranslate"><span class="pre">house_scores_119.xlsx</span></code>)</p>
<ul class="simple">
<li><p>All House members with complete scoring breakdown</p></li>
<li><p>Individual source scores and normalized values</p></li>
<li><p>Final composite score and letter grade</p></li>
</ul>
</li>
<li><p><strong>Senate Scores Dataset</strong> (<code class="docutils literal notranslate"><span class="pre">senate_scores_119.xlsx</span></code>)</p>
<ul class="simple">
<li><p>All Senate members with complete scoring breakdown</p></li>
<li><p>Individual source scores and normalized values</p></li>
<li><p>Final composite score and letter grade</p></li>
</ul>
</li>
</ol>
</section>
<section id="key-columns-in-output">
<h3>Key Columns in Output<a class="headerlink" href="#key-columns-in-output" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Identification:</strong> Name, Chamber, bioguide_id, State, District, Party</p></li>
<li><p><strong>Raw Source Data:</strong> A through O source values</p></li>
<li><p><strong>Normalized Scores:</strong> norm_A through norm_O (0-100 scale)</p></li>
<li><p><strong>Composite Scores:</strong> score_T (base), score_P (caucus), score_M (PVI), score_N (ideology), score_U (final)</p></li>
<li><p><strong>Final Results:</strong> norm_U (normalized final), Grade (A/B/C/F)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="technical-requirements">
<h2>Technical Requirements<a class="headerlink" href="#technical-requirements" title="Link to this heading">#</a></h2>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>pandas</strong> - Data manipulation and analysis</p></li>
<li><p><strong>numpy</strong> - Numerical operations</p></li>
<li><p><strong>scipy.stats</strong> - Statistical functions (normal distribution CDF)</p></li>
<li><p><strong>seaborn</strong> - Data visualization</p></li>
<li><p><strong>matplotlib.pyplot</strong> - Plotting</p></li>
</ul>
</section>
<section id="data-processing-notes">
<h3>Data Processing Notes<a class="headerlink" href="#data-processing-notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Missing Value Handling:</strong> Fills missing values with 0 for counts, column mean for percentages</p></li>
<li><p><strong>Duplicate Removal:</strong> Removes duplicate bioguide_id entries</p></li>
<li><p><strong>Data Type Conversion:</strong> Converts numeric columns to appropriate types for export</p></li>
<li><p><strong>Chamber Separation:</strong> Processes House and Senate separately due to different data structures</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="data-quality">
<h2>Data Quality<a class="headerlink" href="#data-quality" title="Link to this heading">#</a></h2>
<section id="validation-checks">
<h3>Validation Checks<a class="headerlink" href="#validation-checks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Attendance Filtering:</strong> Removes members below 20% attendance threshold</p></li>
<li><p><strong>Duplicate Handling:</strong> Removes duplicate bioguide_id entries</p></li>
<li><p><strong>Missing Data:</strong> Appropriate filling strategies for each data type</p></li>
<li><p><strong>Score Validation:</strong> Ensures all scores are within expected ranges</p></li>
</ul>
</section>
<section id="known-limitations">
<h3>Known Limitations<a class="headerlink" href="#known-limitations" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Source G/H:</strong> Currently weighted at 0 due to dataset limitations</p></li>
<li><p><strong>Source O:</strong> Currently weighted at 0 (APP ideology scores)</p></li>
<li><p><strong>Attendance Data:</strong> Relies on APP profiles for attendance calculations</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="key-insights">
<h2>Key Insights<a class="headerlink" href="#key-insights" title="Link to this heading">#</a></h2>
<section id="scoring-philosophy">
<h3>Scoring Philosophy<a class="headerlink" href="#scoring-philosophy" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Non-Ideological Focus:</strong> Bridge Grades measure collaboration, not political beliefs</p></li>
<li><p><strong>Statistical Normalization:</strong> All scores normalized using normal distribution CDF</p></li>
<li><p><strong>Weighted Combination:</strong> Configurable weights allow fine-tuning of source importance</p></li>
<li><p><strong>Bonus Recognition:</strong> Problem Solvers Caucus members receive additional recognition</p></li>
</ol>
</section>
<section id="grade-distribution">
<h3>Grade Distribution<a class="headerlink" href="#grade-distribution" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Top Performers:</strong> Members earning A grades demonstrate exceptional bipartisan collaboration</p></li>
<li><p><strong>Middle Tier:</strong> B and C grades represent varying levels of collaborative behavior</p></li>
<li><p><strong>Bottom Tier:</strong> F grades indicate members who consistently engage in divisive behavior</p></li>
</ul>
</section>
<section id="transparency-features">
<h3>Transparency Features<a class="headerlink" href="#transparency-features" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Complete Traceability:</strong> Every score component is preserved in output files</p></li>
<li><p><strong>Configurable Weights:</strong> All source weights can be adjusted for different scoring priorities</p></li>
<li><p><strong>Statistical Basis:</strong> Grades based on statistical thresholds rather than arbitrary cutoffs</p></li>
</ul>
</section>
</section>
<section id="notebook-walkthrough-bridge-pledge">
<h2><strong>Notebook Walkthrough: Bridge Pledge</strong><a class="headerlink" href="#notebook-walkthrough-bridge-pledge" title="Link to this heading">#</a></h2>
<section id="import-supporting-libaries">
<h3>Import supporting Libaries<a class="headerlink" href="#import-supporting-libaries" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>  
</pre></div>
</div>
</div>
</div>
</section>
<section id="adjust-variables">
<h3>Adjust Variables<a class="headerlink" href="#adjust-variables" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#add minimum attendance percentage as a DECIMAL  (anyone with an attendance percentage lower than this</span>
<span class="c1">#will not be graded)</span>

<span class="n">att_pct</span><span class="o">=</span><span class="mf">.2</span>

<span class="c1">#add raw point score boost for problem solvers caucus</span>

<span class="n">ps_score</span><span class="o">=</span><span class="mi">25</span>

<span class="c1">#Adjust weights for each Source</span>
<span class="n">weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="c1"># Source_A: Authors of Bills with Cross Party Sponsors</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="c1"># Source_B: Ranked People who Cosponsor Bills</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span><span class="c1"># Source_C: Communication: Bipartisanship (Sum)</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span><span class="c1"># Source_D: Communication: Bipartisanship (Mean)</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span><span class="c1"># Source_E: Attack_Personal (Sum)</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mf">.5</span><span class="p">,</span><span class="c1"># Source_F: Attack_Personal (Mean)</span>
    <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># Source_G: Votes for Cosponsored Bill</span>
    <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># Source_H: Votes for Bill Sponsored by Opposing Party</span>
    
<span class="c1">#The following weights are multiplied against a norm value of 100 so set the number based on that percentage</span>
<span class="c1">#if you want 10% set this value to .001</span>
    <span class="s1">&#39;M&#39;</span><span class="p">:</span><span class="mf">.001</span><span class="p">,</span> <span class="c1">#Source_M: PVI</span>
    <span class="s1">&#39;N&#39;</span><span class="p">:</span><span class="mf">.0005</span><span class="p">,</span> <span class="c1"># Source N: Vote view ideological score</span>
    <span class="s1">&#39;O&#39;</span><span class="p">:</span> <span class="mi">0</span> <span class="c1"># Source O - APP Ideology Score</span>
<span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;A&#39;: 2, &#39;B&#39;: 1, &#39;C&#39;: 0.5, &#39;D&#39;: 0.5, &#39;E&#39;: 0.5, &#39;F&#39;: 0.5, &#39;G&#39;: 0, &#39;H&#39;: 0, &#39;M&#39;: 0.001, &#39;N&#39;: 0.0005, &#39;O&#39;: 0}
</pre></div>
</div>
</div>
</div>
</section>
<section id="id1">
<h3>Data Sources:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Links to All Source Files</span>
<span class="c1">#Congressional Data (List of all Congress people with bioguides, states, and districts)</span>
<span class="n">meta_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;119th Congress.csv&#39;</span><span class="p">)</span>

<span class="n">source_APP_profiles</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;2025-04-25 app raw profiles.csv&#39;</span><span class="p">)</span>

<span class="c1">#Source A: Cross Party CoSponsorship</span>
<span class="n">source_A</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ranked_cross_party_sponsorships.csv&#39;</span><span class="p">)</span>

<span class="c1">#Source B:  Cosponsors Cross Party Bills</span>
<span class="n">source_B</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ranked_cosponsors_cross_party_bills.csv&#39;</span><span class="p">)</span>

<span class="c1">#Source C/D/E/F: APP processed communications data </span>
<span class="n">source_APP</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;app_communications_2025_04_24.csv&#39;</span><span class="p">)</span>

<span class="c1">#Source G/H: Vote Data</span>
<span class="n">source_vote</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;votes.csv&#39;</span><span class="p">)</span>

<span class="c1">#Source M House: Cook Political PVI</span>
<span class="n">source_M_house</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;house_pvi.csv&#39;</span><span class="p">)</span>

<span class="c1">#Source M Senate: Cook Political PVI</span>
<span class="n">source_M_senate</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;senate_pvi.csv&#39;</span><span class="p">)</span>

<span class="c1">#Source N: Vote View Ideological Scores</span>
<span class="n">source_N</span> <span class="o">=</span>  <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;HS119_members.csv&#39;</span><span class="p">)</span>

<span class="c1">#Source 0: APP Raw data</span>
<span class="n">source_O</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;APP 2025-04-25.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">FileNotFoundError</span><span class="g g-Whitespace">                         </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#Links to All Source Files</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1">#Congressional Data (List of all Congress people with bioguides, states, and districts)</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">meta_data</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;119th Congress.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">source_APP_profiles</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;2025-04-25 app raw profiles.csv&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="c1">#Source A: Cross Party CoSponsorship</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\parsers\readers.py:1026,</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, date_format, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options, dtype_backend)</span>
<span class="g g-Whitespace">   </span><span class="mi">1013</span> <span class="n">kwds_defaults</span> <span class="o">=</span> <span class="n">_refine_defaults_read</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1014</span>     <span class="n">dialect</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1015</span>     <span class="n">delimiter</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1022</span>     <span class="n">dtype_backend</span><span class="o">=</span><span class="n">dtype_backend</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1023</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1024</span> <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1026</span> <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\parsers\readers.py:620,</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">617</span> <span class="n">_validate_names</span><span class="p">(</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;names&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
<span class="g g-Whitespace">    </span><span class="mi">619</span> <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">620</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">622</span> <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">623</span>     <span class="k">return</span> <span class="n">parser</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\parsers\readers.py:1620,</span> in <span class="ni">TextFileReader.__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">   </span><span class="mi">1617</span>     <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">   </span><span class="mi">1619</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="p">:</span> <span class="n">IOHandles</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="ne">-&gt; </span><span class="mi">1620</span> <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\parsers\readers.py:1880,</span> in <span class="ni">TextFileReader._make_engine</span><span class="nt">(self, f, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1878</span>     <span class="k">if</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1879</span>         <span class="n">mode</span> <span class="o">+=</span> <span class="s2">&quot;b&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1880</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="o">=</span> <span class="n">get_handle</span><span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">1881</span>     <span class="n">f</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1882</span>     <span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1883</span>     <span class="n">encoding</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1884</span>     <span class="n">compression</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;compression&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1885</span>     <span class="n">memory_map</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1886</span>     <span class="n">is_text</span><span class="o">=</span><span class="n">is_text</span><span class="p">,</span>
<span class="g g-Whitespace">   </span><span class="mi">1887</span>     <span class="n">errors</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1888</span>     <span class="n">storage_options</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="g g-Whitespace">   </span><span class="mi">1889</span> <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1890</span> <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">   </span><span class="mi">1891</span> <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span><span class="o">.</span><span class="n">handle</span>

<span class="nn">File ~\miniconda3\Lib\site-packages\pandas\io\common.py:873,</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">868</span> <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>     <span class="c1"># Check whether the filename is to be opened in binary mode.</span>
<span class="g g-Whitespace">    </span><span class="mi">870</span>     <span class="c1"># Binary mode does not support &#39;encoding&#39; and &#39;newline&#39;.</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>     <span class="k">if</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span> <span class="ow">and</span> <span class="s2">&quot;b&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">872</span>         <span class="c1"># Encoding</span>
<span class="ne">--&gt; </span><span class="mi">873</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">874</span>             <span class="n">handle</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">875</span>             <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">876</span>             <span class="n">encoding</span><span class="o">=</span><span class="n">ioargs</span><span class="o">.</span><span class="n">encoding</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">877</span>             <span class="n">errors</span><span class="o">=</span><span class="n">errors</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">878</span>             <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">879</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">880</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">881</span>         <span class="c1"># Binary mode</span>
<span class="g g-Whitespace">    </span><span class="mi">882</span>         <span class="n">handle</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">ioargs</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

<span class="ne">FileNotFoundError</span>: [Errno 2] No such file or directory: &#39;119th Congress.csv&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="base-table">
<h3>Base Table<a class="headerlink" href="#base-table" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Upload a CSV of the current members of Congress with bioguide ids, state, district, party, and chamber columns</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#file_path=&#39;/content/drive/My Drive/Colab Notebooks/119th Congress.csv&#39;</span>
<span class="c1">#meta_data=pd.read_csv(file_path)</span>
<span class="n">meta_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create df of only house members</span>
<span class="n">house_final</span><span class="o">=</span><span class="n">meta_data</span><span class="p">[</span><span class="n">meta_data</span><span class="p">[</span><span class="s2">&quot;Chamber&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;House&quot;</span><span class="p">]</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create df of only senate members</span>
<span class="n">senate_final</span><span class="o">=</span><span class="n">meta_data</span><span class="p">[</span><span class="n">meta_data</span><span class="p">[</span><span class="s2">&quot;Chamber&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;Senate&quot;</span><span class="p">]</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="remove-members-below-attendance-threshold">
<h3>Remove members below attendance threshold<a class="headerlink" href="#remove-members-below-attendance-threshold" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#useing source_APP_profiles create a dataframe with names, bioguide ides and attendances</span>

<span class="n">source_att</span><span class="o">=</span><span class="n">source_APP_profiles</span><span class="p">[[</span><span class="s1">&#39;full_name&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">,</span> <span class="s1">&#39;attendance_max&#39;</span><span class="p">]]</span>
<span class="c1">#fill NAs with 0</span>
<span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">#create attendance percentage</span>
<span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_pct&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span><span class="o">/</span> <span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_max&#39;</span><span class="p">]</span>

<span class="c1">#create dataframe of members with percentage below mark set above</span>
<span class="n">source_att_low</span><span class="o">=</span><span class="n">source_att</span><span class="p">[</span><span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_pct&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">att_pct</span><span class="p">]</span>

<span class="c1">#drop duplicate rows</span>
<span class="n">source_att_low</span><span class="o">=</span><span class="n">source_att_low</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1">#print dataframe of low atteandance members</span>
<span class="n">source_att_low</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>full_name</th>
      <th>bioguide_id</th>
      <th>attendance_total</th>
      <th>attendance_max</th>
      <th>attendance_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>96</th>
      <td>Eleanor Norton</td>
      <td>N000147</td>
      <td>2.0</td>
      <td>72</td>
      <td>0.027778</td>
    </tr>
    <tr>
      <th>208</th>
      <td>Stacey Plaskett</td>
      <td>P000610</td>
      <td>0.0</td>
      <td>72</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>211</th>
      <td>Aumua Amata Radewagen</td>
      <td>R000600</td>
      <td>0.0</td>
      <td>72</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>407</th>
      <td>James (Jim) Moylan</td>
      <td>M001219</td>
      <td>0.0</td>
      <td>72</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>502</th>
      <td>Kimberlyn King-Hinds</td>
      <td>K000404</td>
      <td>0.0</td>
      <td>72</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>522</th>
      <td>Pablo José Hernández Rivera</td>
      <td>H001103</td>
      <td>0.0</td>
      <td>72</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>537</th>
      <td>Jimmy Patronis</td>
      <td>P000622</td>
      <td>0.0</td>
      <td>72</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>538</th>
      <td>Randall Fine</td>
      <td>F000484</td>
      <td>0.0</td>
      <td>72</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create list of bioguide_ids to delete</span>
<span class="n">bioguide_id_delete</span> <span class="o">=</span> <span class="n">source_att_low</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1">#delete bioguide_ids from grades of members with low attendance</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="o">~</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bioguide_id_delete</span><span class="p">)]</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="o">~</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">bioguide_id_delete</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="source-data">
<h3>Source Data<a class="headerlink" href="#source-data" title="Link to this heading">#</a></h3>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="source-a-authors-of-bills-with-cross-party-sponsors">
<h1>Source_A: Authors of Bills with Cross Party Sponsors<a class="headerlink" href="#source-a-authors-of-bills-with-cross-party-sponsors" title="Link to this heading">#</a></h1>
<p>Rewards authors of bills with cross party sponsors. This counts the total number of bills each representative has that have cross-party sponsors. Representatives with the highest sum and rewarded more and have the highest rank.</p>
<ul class="simple">
<li><p>Download data here for 119th Congress: <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">https://open.pluralpolicy.com/data/session-csv/</a></p></li>
<li><p>Date downloaded: April 24, 2025</p></li>
<li><p>Jupyter Notebook Used to Obtain Data: bill_authors_cosponsors.ipynb</p></li>
<li><p>NOTE: missing values should be filled with 0</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load and filter the source file</span>
<span class="c1">#source_A = pd.read_csv(&#39;/content/drive/My Drive/Colab Notebooks/ranked_cross_party_sponsorships.csv&#39;)</span>
<span class="n">source_A</span> <span class="o">=</span> <span class="n">source_A</span><span class="p">[[</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]]</span>
<span class="n">source_A</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_bioguide_id</th>
      <th>num_bills_with_cross_party_cosponsors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K000367</td>
      <td>28</td>
    </tr>
    <tr>
      <th>1</th>
      <td>B001243</td>
      <td>26</td>
    </tr>
    <tr>
      <th>2</th>
      <td>F000466</td>
      <td>25</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_A</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values with 0 </span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_A</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_A</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">mean_A</span><span class="p">,</span> <span class="n">std_A</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">#rename column to include source A</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">:</span> <span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">})</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_A</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values with 0</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_A</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_A</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">mean_A</span><span class="p">,</span> <span class="n">std_A</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">:</span> <span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">})</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="source-b-ranked-people-who-cosponsor-bills">
<h2>Source_B: Ranked People who Cosponsor Bills<a class="headerlink" href="#source-b-ranked-people-who-cosponsor-bills" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Download data here for 119th Congress: <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">https://open.pluralpolicy.com/data/session-csv/</a></p></li>
<li><p>Date downloaded: April 24, 2025</p></li>
<li><p>Jupyter Notebook Used to Obtain Data: bill_authors_cosponsors.ipynb</p></li>
<li><p>NOTE: missing values should be filled with 0</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load and Filter the Source File</span>
<span class="c1">#source_B = pd.read_csv(&#39;/content/drive/My Drive/Colab Notebooks/ranked_cosponsors_cross_party_bills.csv&#39;)</span>
<span class="n">source_B</span> <span class="o">=</span> <span class="n">source_B</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_B</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_B</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_B</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">mean_B</span><span class="p">,</span> <span class="n">std_B</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">:</span> <span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">})</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_B</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_B</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_B</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">mean_B</span><span class="p">,</span> <span class="n">std_B</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">:</span> <span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">})</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="source-c-communication-bipartisanship-sum">
<h2>Source_C: Communication: Bipartisanship (Sum)<a class="headerlink" href="#source-c-communication-bipartisanship-sum" title="Link to this heading">#</a></h2>
<p>Rewards representatives who participate in bipartisanship communication. This counts the total number of communications for each representative that are supportive of another representative of the opposite party. Those with a higher sum are rewarded more.</p>
<ul class="simple">
<li><p>Download data: <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> - select US officials in left menu; then select “Download 2025”</p></li>
<li><p>Date downloaded: April 24, 2025</p></li>
<li><p>Jupyter Notebook Used to Obtain Data: app_rhetoric_calculations.ipynb</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load and filter the source file</span>
<span class="c1">#source_C = pd.read_csv(&#39;/content/drive/My Drive/Colab Notebooks/app_communications_2025_jc.csv&#39;)</span>
<span class="n">source_C</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_C</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;outcome_bipartisanship&#39; with 0</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_C</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_C</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">mean_C</span><span class="p">,</span> <span class="n">std_C</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">:</span> <span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>2.0</td>
      <td>16.907135</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>6.0</td>
      <td>21.499539</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>4.0</td>
      <td>19.118864</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>9.0</td>
      <td>25.375115</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>20.0</td>
      <td>42.113599</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_C</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;outcome_bipartisanship&#39; with 0</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_C</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_C</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">mean_C</span><span class="p">,</span> <span class="n">std_C</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">:</span> <span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>195.0</td>
      <td>99.071522</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>64.0</td>
      <td>49.168328</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>22.0</td>
      <td>21.702803</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>42.0</td>
      <td>33.735663</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>25.0</td>
      <td>23.334275</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="source-d-communication-bipartisanship-mean">
<h2>Source_D: Communication: Bipartisanship (Mean)<a class="headerlink" href="#source-d-communication-bipartisanship-mean" title="Link to this heading">#</a></h2>
<p>Rewards representatives who participate in bipartisanship communication. This measures the percent of communication that is supportive of a bipartisan representative. Those with a higher percentage of bipartisan communication are rewarded more.</p>
<ul class="simple">
<li><p>Download data: <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> - select US officials in left menu; then select “Download 2025”</p></li>
<li><p>Date downloaded: April 24, 2025</p></li>
<li><p>Jupyter Notebook Used to Obtain Data: app_rhetoric_calculations.ipynb</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load and filter the source file</span>
<span class="c1">#source_D = pd.read_csv(&#39;/content/drive/My Drive/Colab Notebooks/app_communications_2025_jc.csv&#39;)</span>
<span class="n">source_D</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_D</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;outcome_bipartisanship_pct&#39; with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_D</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_D</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">mean_D</span><span class="p">,</span> <span class="n">std_D</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">:</span> <span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">})</span>
<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>2.0</td>
      <td>16.907135</td>
      <td>0.921659</td>
      <td>11.212972</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>6.0</td>
      <td>21.499539</td>
      <td>3.896104</td>
      <td>31.339530</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>4.0</td>
      <td>19.118864</td>
      <td>2.985075</td>
      <td>23.899455</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>9.0</td>
      <td>25.375115</td>
      <td>5.660377</td>
      <td>47.853567</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>20.0</td>
      <td>42.113599</td>
      <td>9.900990</td>
      <td>83.781977</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_D</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;outcome_bipartisanship_pct&#39; with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_D</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_D</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">mean_D</span><span class="p">,</span> <span class="n">std_D</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">:</span> <span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">})</span>
<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>195.0</td>
      <td>99.071522</td>
      <td>14.896868</td>
      <td>94.641353</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>64.0</td>
      <td>49.168328</td>
      <td>4.155844</td>
      <td>20.794303</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>22.0</td>
      <td>21.702803</td>
      <td>5.655527</td>
      <td>31.737555</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>42.0</td>
      <td>33.735663</td>
      <td>4.615385</td>
      <td>23.889999</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>25.0</td>
      <td>23.334275</td>
      <td>6.281407</td>
      <td>36.927725</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="source-e-attack-personal-sum">
<h2>Source_E: Attack_Personal (Sum)<a class="headerlink" href="#source-e-attack-personal-sum" title="Link to this heading">#</a></h2>
<p>Punishes any communication that is a personal attack. This specifically measures the total number of personal attacks. Those with a large sum will be rewarded less and thus ranked lower.</p>
<ul class="simple">
<li><p>Download data: <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> - select US officials in left menu; then select “Download 2025”</p></li>
<li><p>Date downloaded: April 24, 2025</p></li>
<li><p>Jupyter Notebook Used to Obtain Data: app_rhetoric_calculations.ipynb</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load and filter the source file</span>
<span class="n">source_E</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;attack_personal&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_E</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;attack_personal&#39; with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_E</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_E</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;attack_personal&#39; column; inverse (the more attacks the lower score)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">mean_E</span><span class="p">,</span> <span class="n">std_E</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">:</span> <span class="s1">&#39;E: attack_personal&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>2.0</td>
      <td>16.907135</td>
      <td>0.921659</td>
      <td>11.212972</td>
      <td>4.0</td>
      <td>66.930387</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>6.0</td>
      <td>21.499539</td>
      <td>3.896104</td>
      <td>31.339530</td>
      <td>1.0</td>
      <td>70.897521</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>4.0</td>
      <td>19.118864</td>
      <td>2.985075</td>
      <td>23.899455</td>
      <td>2.0</td>
      <td>69.599852</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>9.0</td>
      <td>25.375115</td>
      <td>5.660377</td>
      <td>47.853567</td>
      <td>2.0</td>
      <td>69.599852</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>20.0</td>
      <td>42.113599</td>
      <td>9.900990</td>
      <td>83.781977</td>
      <td>1.0</td>
      <td>70.897521</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_E</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;attack_personal&#39; with the column mean</span>
<span class="n">mean_E</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_D</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_E</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_E</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;attack_personal&#39; column; inverse (the more attacks the lower score)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">mean_E</span><span class="p">,</span> <span class="n">std_E</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">:</span> <span class="s1">&#39;E: attack_personal&#39;</span><span class="p">})</span>
<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>195.0</td>
      <td>99.071522</td>
      <td>14.896868</td>
      <td>94.641353</td>
      <td>6.0</td>
      <td>72.608868</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>64.0</td>
      <td>49.168328</td>
      <td>4.155844</td>
      <td>20.794303</td>
      <td>37.0</td>
      <td>57.661395</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>22.0</td>
      <td>21.702803</td>
      <td>5.655527</td>
      <td>31.737555</td>
      <td>3.0</td>
      <td>73.907274</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>42.0</td>
      <td>33.735663</td>
      <td>4.615385</td>
      <td>23.889999</td>
      <td>29.0</td>
      <td>61.732932</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>25.0</td>
      <td>23.334275</td>
      <td>6.281407</td>
      <td>36.927725</td>
      <td>28.0</td>
      <td>62.233857</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="source-f-attack-personal-mean">
<h2>Source_F: Attack_Personal (Mean)<a class="headerlink" href="#source-f-attack-personal-mean" title="Link to this heading">#</a></h2>
<p>Punishes any communication that is a personal attack. This measures the percent of communication that is in the form of a personal attack for each representative.  Those with a larger percentage will be rewarded less and thus ranked lower.</p>
<ul class="simple">
<li><p>Download data: <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> - select US officials in left menu; then select “Download 2025”</p></li>
<li><p>Date downloaded: April 24, 2025</p></li>
<li><p>Jupyter Notebook Used to Obtain Data: app_rhetoric_calculations.ipynb</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load and filter the source file</span>
<span class="n">source_F</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_F</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;attack_personal_pct&#39; with the column mean</span>
<span class="n">mean_F</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_F</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_F</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_F</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column; inverse the number (more attacks = lower score)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">mean_F</span><span class="p">,</span> <span class="n">std_F</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">:</span> <span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>2.0</td>
      <td>16.907135</td>
      <td>0.921659</td>
      <td>11.212972</td>
      <td>4.0</td>
      <td>66.930387</td>
      <td>1.843318</td>
      <td>63.634059</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>6.0</td>
      <td>21.499539</td>
      <td>3.896104</td>
      <td>31.339530</td>
      <td>1.0</td>
      <td>70.897521</td>
      <td>0.649351</td>
      <td>74.929176</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>4.0</td>
      <td>19.118864</td>
      <td>2.985075</td>
      <td>23.899455</td>
      <td>2.0</td>
      <td>69.599852</td>
      <td>1.492537</td>
      <td>67.139080</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>9.0</td>
      <td>25.375115</td>
      <td>5.660377</td>
      <td>47.853567</td>
      <td>2.0</td>
      <td>69.599852</td>
      <td>1.257862</td>
      <td>69.404697</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>20.0</td>
      <td>42.113599</td>
      <td>9.900990</td>
      <td>83.781977</td>
      <td>1.0</td>
      <td>70.897521</td>
      <td>0.495050</td>
      <td>76.241075</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_F</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;attack_personal_pct&#39; with the column mean</span>
<span class="n">mean_F</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_F</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_F</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_F</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column; inverse the number (more attacks = lower score)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">mean_F</span><span class="p">,</span> <span class="n">std_F</span><span class="p">))</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">:</span> <span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>195.0</td>
      <td>99.071522</td>
      <td>14.896868</td>
      <td>94.641353</td>
      <td>6.0</td>
      <td>72.608868</td>
      <td>0.458365</td>
      <td>79.696131</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>64.0</td>
      <td>49.168328</td>
      <td>4.155844</td>
      <td>20.794303</td>
      <td>37.0</td>
      <td>57.661395</td>
      <td>2.402597</td>
      <td>67.891643</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>22.0</td>
      <td>21.702803</td>
      <td>5.655527</td>
      <td>31.737555</td>
      <td>3.0</td>
      <td>73.907274</td>
      <td>0.771208</td>
      <td>77.991333</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>42.0</td>
      <td>33.735663</td>
      <td>4.615385</td>
      <td>23.889999</td>
      <td>29.0</td>
      <td>61.732932</td>
      <td>3.186813</td>
      <td>62.437226</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>25.0</td>
      <td>23.334275</td>
      <td>6.281407</td>
      <td>36.927725</td>
      <td>28.0</td>
      <td>62.233857</td>
      <td>7.035176</td>
      <td>34.172700</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="source-g-votes-for-cosponsored-bill">
<h2>Source_G: Votes for Cosponsored Bill<a class="headerlink" href="#source-g-votes-for-cosponsored-bill" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Download data: <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">https://open.pluralpolicy.com/data/session-csv/</a></p></li>
<li><p>Date donwloaded: April 24, 2025</p></li>
<li><p>Data cleaned in following file:  Vote_Counts.ipynb</p></li>
<li><p>As of now this receives 0 weight because of low amount of data and concerns about bills that are making it to the floor only being those sponsored by Republicans.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>

<span class="c1"># Load and filter the source file</span>
<span class="n">source_G</span> <span class="o">=</span> <span class="n">source_vote</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]]</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_G</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;outcome_bipartisanship_pct&#39; with the column mean</span>
<span class="n">mean_G</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_G</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_G</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_G</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_G&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">],</span> <span class="n">mean_G</span><span class="p">,</span> <span class="n">std_G</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">:</span> <span class="s1">&#39;G: Vote for Cosponsored Bill&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>2.0</td>
      <td>16.907135</td>
      <td>0.921659</td>
      <td>11.212972</td>
      <td>4.0</td>
      <td>66.930387</td>
      <td>1.843318</td>
      <td>63.634059</td>
      <td>7.0</td>
      <td>82.186103</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>6.0</td>
      <td>21.499539</td>
      <td>3.896104</td>
      <td>31.339530</td>
      <td>1.0</td>
      <td>70.897521</td>
      <td>0.649351</td>
      <td>74.929176</td>
      <td>4.0</td>
      <td>40.504494</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>4.0</td>
      <td>19.118864</td>
      <td>2.985075</td>
      <td>23.899455</td>
      <td>2.0</td>
      <td>69.599852</td>
      <td>1.492537</td>
      <td>67.139080</td>
      <td>7.0</td>
      <td>82.186103</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>9.0</td>
      <td>25.375115</td>
      <td>5.660377</td>
      <td>47.853567</td>
      <td>2.0</td>
      <td>69.599852</td>
      <td>1.257862</td>
      <td>69.404697</td>
      <td>7.0</td>
      <td>82.186103</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>20.0</td>
      <td>42.113599</td>
      <td>9.900990</td>
      <td>83.781977</td>
      <td>1.0</td>
      <td>70.897521</td>
      <td>0.495050</td>
      <td>76.241075</td>
      <td>7.0</td>
      <td>82.186103</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>

<span class="c1"># Load and filter the source file</span>
<span class="n">source_G</span> <span class="o">=</span> <span class="n">source_vote</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]]</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_G</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;outcome_bipartisanship_pct&#39; with the column mean</span>
<span class="n">mean_G</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_G</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_G</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_G</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_G&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">],</span> <span class="n">mean_G</span><span class="p">,</span> <span class="n">std_G</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Vote for Cosponsored Bill&#39;</span><span class="p">:</span> <span class="s1">&#39;G: Vote for Cosponsored Bill&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>195.0</td>
      <td>99.071522</td>
      <td>14.896868</td>
      <td>94.641353</td>
      <td>6.0</td>
      <td>72.608868</td>
      <td>0.458365</td>
      <td>79.696131</td>
      <td>3.0</td>
      <td>78.955497</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>64.0</td>
      <td>49.168328</td>
      <td>4.155844</td>
      <td>20.794303</td>
      <td>37.0</td>
      <td>57.661395</td>
      <td>2.402597</td>
      <td>67.891643</td>
      <td>3.0</td>
      <td>78.955497</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>22.0</td>
      <td>21.702803</td>
      <td>5.655527</td>
      <td>31.737555</td>
      <td>3.0</td>
      <td>73.907274</td>
      <td>0.771208</td>
      <td>77.991333</td>
      <td>3.0</td>
      <td>78.955497</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>42.0</td>
      <td>33.735663</td>
      <td>4.615385</td>
      <td>23.889999</td>
      <td>29.0</td>
      <td>61.732932</td>
      <td>3.186813</td>
      <td>62.437226</td>
      <td>3.0</td>
      <td>78.955497</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>25.0</td>
      <td>23.334275</td>
      <td>6.281407</td>
      <td>36.927725</td>
      <td>28.0</td>
      <td>62.233857</td>
      <td>7.035176</td>
      <td>34.172700</td>
      <td>2.0</td>
      <td>49.675660</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="source-h-votes-for-bill-sponsored-by-opposing-party">
<h2>Source_H: Votes for Bill Sponsored by Opposing Party<a class="headerlink" href="#source-h-votes-for-bill-sponsored-by-opposing-party" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Download data: <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">https://open.pluralpolicy.com/data/session-csv/</a></p></li>
<li><p>Date donwloaded: April 24, 2025</p></li>
<li><p>Data cleaned in following file:  Vote_Counts.ipynb</p></li>
<li><p>As of now this receives 0 weight because of low amount of data and concerns about bills that are making it to the floor only being those sponsored by Republicans.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_vote</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>Vote for Other Party</th>
      <th>Vote for Cosponsored Bill</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>6.0</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>

<span class="c1"># Load and filter the source file</span>
<span class="n">source_H</span> <span class="o">=</span> <span class="n">source_vote</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]]</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_H</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;outcome_bipartisanship_pct&#39; with the column mean</span>
<span class="n">mean_H</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_H</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_H</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_H</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">],</span> <span class="n">mean_H</span><span class="p">,</span> <span class="n">std_H</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">:</span> <span class="s1">&#39;H: Vote for Other Party&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>0.921659</td>
      <td>11.212972</td>
      <td>4.0</td>
      <td>66.930387</td>
      <td>1.843318</td>
      <td>63.634059</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>...</td>
      <td>3.896104</td>
      <td>31.339530</td>
      <td>1.0</td>
      <td>70.897521</td>
      <td>0.649351</td>
      <td>74.929176</td>
      <td>4.0</td>
      <td>40.504494</td>
      <td>6.0</td>
      <td>93.707648</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>...</td>
      <td>2.985075</td>
      <td>23.899455</td>
      <td>2.0</td>
      <td>69.599852</td>
      <td>1.492537</td>
      <td>67.139080</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>...</td>
      <td>5.660377</td>
      <td>47.853567</td>
      <td>2.0</td>
      <td>69.599852</td>
      <td>1.257862</td>
      <td>69.404697</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>9.900990</td>
      <td>83.781977</td>
      <td>1.0</td>
      <td>70.897521</td>
      <td>0.495050</td>
      <td>76.241075</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>

<span class="c1"># Load and filter the source file</span>
<span class="n">source_H</span> <span class="o">=</span> <span class="n">source_vote</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]]</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_H</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;outcome_bipartisanship_pct&#39; with the column mean</span>
<span class="n">mean_H</span><span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_H</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_H</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_H</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">],</span> <span class="n">mean_H</span><span class="p">,</span> <span class="n">std_H</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="c1"># Remove duplicates based on &#39;bioguide_id&#39;</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Vote for Other Party&#39;</span><span class="p">:</span> <span class="s1">&#39;H: Vote for Other Party&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>...</td>
      <td>14.896868</td>
      <td>94.641353</td>
      <td>6.0</td>
      <td>72.608868</td>
      <td>0.458365</td>
      <td>79.696131</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>...</td>
      <td>4.155844</td>
      <td>20.794303</td>
      <td>37.0</td>
      <td>57.661395</td>
      <td>2.402597</td>
      <td>67.891643</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>...</td>
      <td>5.655527</td>
      <td>31.737555</td>
      <td>3.0</td>
      <td>73.907274</td>
      <td>0.771208</td>
      <td>77.991333</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>...</td>
      <td>4.615385</td>
      <td>23.889999</td>
      <td>29.0</td>
      <td>61.732932</td>
      <td>3.186813</td>
      <td>62.437226</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>...</td>
      <td>6.281407</td>
      <td>36.927725</td>
      <td>28.0</td>
      <td>62.233857</td>
      <td>7.035176</td>
      <td>34.172700</td>
      <td>2.0</td>
      <td>49.675660</td>
      <td>2.0</td>
      <td>98.313512</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div></div>
</div>
</section>
<section id="source-m-cook-political-pvi">
<h2>Source_M: Cook Political PVI<a class="headerlink" href="#source-m-cook-political-pvi" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>This data was obtained by Brad via a paid subscription at: <a class="reference external" href="https://www.cookpolitical.com/cook-pvi">https://www.cookpolitical.com/cook-pvi</a></p></li>
<li><p>Date downloaded: April 17, 2025</p></li>
<li><p>Data cleaned in following file: PVI Pre-Processing.ipynb</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE</span>

<span class="n">source_M_house</span><span class="o">=</span><span class="n">source_M_house</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]]</span>

<span class="c1"># Merge the dataframes</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_M_house</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;2023_pvi_raw&#39; with 0</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_M</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_M</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">],</span> <span class="n">mean_M</span><span class="p">,</span> <span class="n">std_M</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">:</span> <span class="s1">&#39;M: PVI&#39;</span><span class="p">})</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;M: PVI&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_M&#39;</span><span class="p">])</span>
<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
      <th>M: PVI</th>
      <th>norm_M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>4.0</td>
      <td>66.930387</td>
      <td>1.843318</td>
      <td>63.634059</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>27</td>
      <td>95.107163</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>...</td>
      <td>1.0</td>
      <td>70.897521</td>
      <td>0.649351</td>
      <td>74.929176</td>
      <td>4.0</td>
      <td>40.504494</td>
      <td>6.0</td>
      <td>93.707648</td>
      <td>5</td>
      <td>17.779565</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>...</td>
      <td>2.0</td>
      <td>69.599852</td>
      <td>1.492537</td>
      <td>67.139080</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>23</td>
      <td>88.226800</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>...</td>
      <td>2.0</td>
      <td>69.599852</td>
      <td>1.257862</td>
      <td>69.404697</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>33</td>
      <td>99.083130</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>1.0</td>
      <td>70.897521</td>
      <td>0.495050</td>
      <td>76.241075</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>15</td>
      <td>59.813959</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE</span>

<span class="n">source_M_senate</span><span class="o">=</span><span class="n">source_M_senate</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]]</span>

<span class="c1"># Merge the dataframes</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_M_senate</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;2023_pvi_raw&#39; with 0</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_M</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_M</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;outcome_bipartisanship&#39; column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">],</span> <span class="n">mean_M</span><span class="p">,</span> <span class="n">std_M</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>


<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;2025 Cook PVI Number&#39;</span><span class="p">:</span> <span class="s1">&#39;M: PVI&#39;</span><span class="p">})</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;M: PVI&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_M&#39;</span><span class="p">])</span>
<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
      <th>M: PVI</th>
      <th>norm_M</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>...</td>
      <td>6.0</td>
      <td>72.608868</td>
      <td>0.458365</td>
      <td>79.696131</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>14.81</td>
      <td>85.084556</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>...</td>
      <td>37.0</td>
      <td>57.661395</td>
      <td>2.402597</td>
      <td>67.891643</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>14.81</td>
      <td>85.084556</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>...</td>
      <td>3.0</td>
      <td>73.907274</td>
      <td>0.771208</td>
      <td>77.991333</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>6.46</td>
      <td>36.169822</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>...</td>
      <td>29.0</td>
      <td>61.732932</td>
      <td>3.186813</td>
      <td>62.437226</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>6.46</td>
      <td>36.169822</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>...</td>
      <td>28.0</td>
      <td>62.233857</td>
      <td>7.035176</td>
      <td>34.172700</td>
      <td>2.0</td>
      <td>49.675660</td>
      <td>2.0</td>
      <td>98.313512</td>
      <td>0.00</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div></div></div>
</div>
</section>
<section id="source-n-vote-view-ideological-score">
<h2>Source N: Vote view ideological score<a class="headerlink" href="#source-n-vote-view-ideological-score" title="Link to this heading">#</a></h2>
<p>Add multiplier to scores based on distance from ideological center to reward bridging by non-centrist polls</p>
<ul class="simple">
<li><p>Download data here: <a class="reference external" href="https://voteview.com/congress/senate/-1/text">https://voteview.com/congress/senate/-1/text</a> ; <a class="reference external" href="https://voteview.com/congress/house/-1/text">https://voteview.com/congress/house/-1/text</a></p></li>
<li><p>Date downloaded: April 21, 2025</p></li>
<li><p>Note this scoring is done with the absolute value of the downloaded data in order to measure how far each side is from the center.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter columns to keep only &#39;bioguide_id&#39; and &#39;nominate_dim1&#39;</span>
<span class="n">source_N</span> <span class="o">=</span> <span class="n">source_N</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]]</span>
<span class="c1">#take absolutely value of nominate_dim1</span>
<span class="n">source_N</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">source_N</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">])</span>
<span class="c1"># Preview the filtered source DataFrame</span>
<span class="n">source_N</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>nominate_dim1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>R000575</td>
      <td>0.379</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S001185</td>
      <td>0.401</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000609</td>
      <td>0.677</td>
    </tr>
    <tr>
      <th>3</th>
      <td>M001212</td>
      <td>0.642</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S001220</td>
      <td>0.621</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE </span>
<span class="c1"># Merge source_N with the final DataFrame on &#39;bioguide_id&#39;</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_N</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;nominate_dim1&#39; with the column mean</span>
<span class="n">mean_N</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">source_N</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_N</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_N</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_N</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;nominate_dim1&#39; column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">],</span> <span class="n">mean_N</span><span class="p">,</span> <span class="n">std_N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Drop duplicates based on &#39;bioguide_id&#39; if any exist</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">:</span> <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
      <th>M: PVI</th>
      <th>norm_M</th>
      <th>N: nominate_dim1</th>
      <th>norm_N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>1.843318</td>
      <td>63.634059</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>27</td>
      <td>95.107163</td>
      <td>0.642</td>
      <td>85.782269</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>...</td>
      <td>0.649351</td>
      <td>74.929176</td>
      <td>4.0</td>
      <td>40.504494</td>
      <td>6.0</td>
      <td>93.707648</td>
      <td>5</td>
      <td>17.779565</td>
      <td>0.375</td>
      <td>30.853754</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>...</td>
      <td>1.492537</td>
      <td>67.139080</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>23</td>
      <td>88.226800</td>
      <td>0.379</td>
      <td>31.686958</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>...</td>
      <td>1.257862</td>
      <td>69.404697</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>33</td>
      <td>99.083130</td>
      <td>0.405</td>
      <td>37.314717</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>0.495050</td>
      <td>76.241075</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>15</td>
      <td>59.813959</td>
      <td>0.621</td>
      <td>82.819560</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE </span>
<span class="c1"># Merge source_N with the final DataFrame on &#39;bioguide_id&#39;</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_N</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;nominate_dim1&#39; with the column mean</span>
<span class="n">mean_N</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">source_N</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_N</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_N</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_N</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;nominate_dim1&#39; column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">],</span> <span class="n">mean_N</span><span class="p">,</span> <span class="n">std_N</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Drop duplicates based on &#39;bioguide_id&#39; if any exist</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">:</span> <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
      <th>M: PVI</th>
      <th>norm_M</th>
      <th>N: nominate_dim1</th>
      <th>norm_N</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>...</td>
      <td>0.458365</td>
      <td>79.696131</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>14.81</td>
      <td>85.084556</td>
      <td>0.582</td>
      <td>73.310212</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>...</td>
      <td>2.402597</td>
      <td>67.891643</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>14.81</td>
      <td>85.084556</td>
      <td>0.936</td>
      <td>99.518569</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>...</td>
      <td>0.771208</td>
      <td>77.991333</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>6.46</td>
      <td>36.169822</td>
      <td>0.207</td>
      <td>7.199248</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>...</td>
      <td>3.186813</td>
      <td>62.437226</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>6.46</td>
      <td>36.169822</td>
      <td>0.482</td>
      <td>52.657646</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>...</td>
      <td>7.035176</td>
      <td>34.172700</td>
      <td>2.0</td>
      <td>49.675660</td>
      <td>2.0</td>
      <td>98.313512</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.374</td>
      <td>29.690143</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div></div></div>
</div>
</section>
<section id="source-o-app-ideology-score">
<h2>Source O - APP Ideology Score<a class="headerlink" href="#source-o-app-ideology-score" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Download data: profiles.csv from <a class="reference external" href="http://americanpoliticalpulse.com/data">americanpoliticalpulse.com/data</a></p></li>
<li><p>Date downloaded: 04/24/2025</p></li>
<li><p>Notes: Previously APP reported ideology_intensity; they have stopped reporting that number, but it is the absolute value of ideology_ideology so we are using that and converting it to the absolute value</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter columns to keep only &#39;bioguide_id&#39; and &#39;nominate_dim1&#39;</span>
<span class="n">source_O</span> <span class="o">=</span> <span class="n">source_O</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]]</span>
<span class="c1">#use the absolute value of ideology_ideology</span>
<span class="n">source_O</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">source_O</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">])</span>
<span class="c1"># Preview the filtered source DataFrame</span>
<span class="n">source_O</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>ideology_ideology</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>C000127</td>
      <td>0.306</td>
    </tr>
    <tr>
      <th>1</th>
      <td>K000367</td>
      <td>0.280</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S000033</td>
      <td>0.543</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W000802</td>
      <td>0.354</td>
    </tr>
    <tr>
      <th>4</th>
      <td>B001261</td>
      <td>0.538</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#HOUSE </span>
<span class="c1"># Merge source_O with the final DataFrame on &#39;bioguide_id&#39;</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">source_O</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;nominate_dim1&#39; with the column mean</span>
<span class="n">mean_O</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">source_O</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_O</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_O</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_O</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;nominate_dim1&#39; column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">],</span> <span class="n">mean_O</span><span class="p">,</span> <span class="n">std_O</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Drop duplicates based on &#39;bioguide_id&#39; if any exist</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">:</span> <span class="s1">&#39;O: ideology_ideology&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
      <th>M: PVI</th>
      <th>norm_M</th>
      <th>N: nominate_dim1</th>
      <th>norm_N</th>
      <th>O: ideology_ideology</th>
      <th>norm_O</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>27</td>
      <td>95.107163</td>
      <td>0.642</td>
      <td>85.782269</td>
      <td>0.642</td>
      <td>85.782269</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>...</td>
      <td>4.0</td>
      <td>40.504494</td>
      <td>6.0</td>
      <td>93.707648</td>
      <td>5</td>
      <td>17.779565</td>
      <td>0.375</td>
      <td>30.853754</td>
      <td>0.375</td>
      <td>30.853754</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>...</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>23</td>
      <td>88.226800</td>
      <td>0.379</td>
      <td>31.686958</td>
      <td>0.379</td>
      <td>31.686958</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>...</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>33</td>
      <td>99.083130</td>
      <td>0.405</td>
      <td>37.314717</td>
      <td>0.405</td>
      <td>37.314717</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>7.0</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>15</td>
      <td>59.813959</td>
      <td>0.621</td>
      <td>82.819560</td>
      <td>0.621</td>
      <td>82.819560</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#SENATE </span>
<span class="c1"># Merge source_O with the final DataFrame on &#39;bioguide_id&#39;</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">source_O</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Fill missing values in &#39;nominate_dim1&#39; with the column mean</span>
<span class="n">mean_O</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">source_O</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">mean_O</span><span class="p">)</span>

<span class="c1"># Calculate mean and standard deviation for normalization</span>
<span class="n">mean_O</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">std_O</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Normalize the &#39;nominate_dim1&#39; column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">],</span> <span class="n">mean_O</span><span class="p">,</span> <span class="n">std_O</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Drop duplicates based on &#39;bioguide_id&#39; if any exist</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ideology_ideology&#39;</span><span class="p">:</span> <span class="s1">&#39;O: ideology_ideology&#39;</span><span class="p">})</span>

<span class="c1"># Output the preview the updated DataFrame</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>G: Vote for Cosponsored Bill</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
      <th>M: PVI</th>
      <th>norm_M</th>
      <th>N: nominate_dim1</th>
      <th>norm_N</th>
      <th>O: ideology_ideology</th>
      <th>norm_O</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Katie Boyd Britt</td>
      <td>Senate</td>
      <td>B001319</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>0.0</td>
      <td>13.72</td>
      <td>0.0</td>
      <td>7.84</td>
      <td>...</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>14.81</td>
      <td>85.084556</td>
      <td>0.582</td>
      <td>73.310212</td>
      <td>0.582</td>
      <td>73.310212</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Tommy Tuberville</td>
      <td>Senate</td>
      <td>T000278</td>
      <td>Alabama</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>10.0</td>
      <td>20.08</td>
      <td>...</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>14.81</td>
      <td>85.084556</td>
      <td>0.936</td>
      <td>99.518569</td>
      <td>0.936</td>
      <td>99.518569</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Lisa Murkowski</td>
      <td>Senate</td>
      <td>M001153</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>93.40</td>
      <td>31.0</td>
      <td>64.56</td>
      <td>...</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>6.46</td>
      <td>36.169822</td>
      <td>0.207</td>
      <td>7.199248</td>
      <td>0.207</td>
      <td>7.199248</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Dan Sullivan</td>
      <td>Senate</td>
      <td>S001198</td>
      <td>Alaska</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>84.59</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>...</td>
      <td>3.0</td>
      <td>78.955497</td>
      <td>0.0</td>
      <td>26.880262</td>
      <td>6.46</td>
      <td>36.169822</td>
      <td>0.482</td>
      <td>52.657646</td>
      <td>0.482</td>
      <td>52.657646</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Ruben Gallego</td>
      <td>Senate</td>
      <td>G000574</td>
      <td>Arizona</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2.0</td>
      <td>22.12</td>
      <td>37.0</td>
      <td>76.42</td>
      <td>...</td>
      <td>2.0</td>
      <td>49.675660</td>
      <td>2.0</td>
      <td>98.313512</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.374</td>
      <td>29.690143</td>
      <td>0.374</td>
      <td>29.690143</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div></div></div>
</div>
</section>
<section id="source-p-caucus-bump">
<h2>Source_P: Caucus Bump<a class="headerlink" href="#source-p-caucus-bump" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">problem_solvers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;Brian Fitzpatrick&#39;</span><span class="p">,</span> <span class="s1">&#39;Tom Suozzi&#39;</span><span class="p">,</span> <span class="s1">&#39;Josh Gottheimer&#39;</span><span class="p">,</span> <span class="s1">&#39;Ed Case&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Nicole Malliotakis&#39;</span><span class="p">,</span> <span class="s1">&#39;Andrew Garbarino&#39;</span><span class="p">,</span> <span class="s1">&#39;Don Bacon&#39;</span><span class="p">,</span> <span class="s1">&#39;Salud Carbajal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Rob Bresnahan&#39;</span><span class="p">,</span> <span class="s1">&#39;Juan Ciscomani&#39;</span><span class="p">,</span> <span class="s1">&#39;Ben Cline&#39;</span><span class="p">,</span> <span class="s1">&#39;Jim Costa&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Angie Craig&#39;</span><span class="p">,</span> <span class="s1">&#39;Henry Cuellar&#39;</span><span class="p">,</span> <span class="s1">&#39;Don Davis&#39;</span><span class="p">,</span> <span class="s1">&#39;Debbie Dingell&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Chuck Edwards&#39;</span><span class="p">,</span> <span class="s1">&#39;Gabe Evans&#39;</span><span class="p">,</span> <span class="s1">&#39;Marie Gluesenkamp Perez&#39;</span><span class="p">,</span> <span class="s1">&#39;Jared Golden&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Josh Harder&#39;</span><span class="p">,</span> <span class="s1">&#39;Chrissy Houlahan&#39;</span><span class="p">,</span> <span class="s1">&#39;Steven Horsford&#39;</span><span class="p">,</span> <span class="s1">&#39;Greg Landsman&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Susie Lee&#39;</span><span class="p">,</span> <span class="s1">&#39;Donald Norcross&#39;</span><span class="p">,</span> <span class="s1">&#39;Jimmy Panetta&#39;</span><span class="p">,</span> <span class="s1">&#39;Chris Pappas&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Scott Peters&#39;</span><span class="p">,</span> <span class="s1">&#39;Brittany Pettersen&#39;</span><span class="p">,</span> <span class="s1">&#39;Brad Schneider&#39;</span><span class="p">,</span> <span class="s1">&#39;Hillary Scholten&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Darren Soto&#39;</span><span class="p">,</span> <span class="s1">&#39;Haley Stevens&#39;</span><span class="p">,</span> <span class="s1">&#39;Emilia Sykes&#39;</span><span class="p">,</span> <span class="s1">&#39;Dusty Johnson&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;David Joyce&#39;</span><span class="p">,</span> <span class="s1">&#39;Thomas Kean Jr.&#39;</span><span class="p">,</span> <span class="s1">&#39;Young Kim&#39;</span><span class="p">,</span> <span class="s1">&#39;Nick LaLota&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;Mike Lawler&#39;</span><span class="p">,</span> <span class="s1">&#39;Daniel Meuser&#39;</span><span class="p">,</span> <span class="s1">&#39;Blake Moore&#39;</span><span class="p">,</span> <span class="s1">&#39;James Moylan&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Maria Elvira Salazar&#39;</span><span class="p">,</span> <span class="s1">&#39;Bryan Steil&#39;</span><span class="p">,</span> <span class="s1">&#39;David Valadao&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;F000466&#39;</span><span class="p">,</span> <span class="s1">&#39;S001201&#39;</span><span class="p">,</span> <span class="s1">&#39;G000583&#39;</span><span class="p">,</span> <span class="s1">&#39;C001055&#39;</span><span class="p">,</span>
        <span class="s1">&#39;M000317&#39;</span><span class="p">,</span> <span class="s1">&#39;G000597&#39;</span><span class="p">,</span> <span class="s1">&#39;B001298&#39;</span><span class="p">,</span> <span class="s1">&#39;C001112&#39;</span><span class="p">,</span>
        <span class="s1">&#39;B001327&#39;</span><span class="p">,</span> <span class="s1">&#39;C001133&#39;</span><span class="p">,</span> <span class="s1">&#39;C001118&#39;</span><span class="p">,</span> <span class="s1">&#39;C001059&#39;</span><span class="p">,</span>
        <span class="s1">&#39;C001119&#39;</span><span class="p">,</span> <span class="s1">&#39;C001063&#39;</span><span class="p">,</span> <span class="s1">&#39;D000230&#39;</span><span class="p">,</span> <span class="s1">&#39;D000624&#39;</span><span class="p">,</span>
        <span class="s1">&#39;E000246&#39;</span><span class="p">,</span> <span class="s1">&#39;E000300&#39;</span><span class="p">,</span> <span class="s1">&#39;G000600&#39;</span><span class="p">,</span> <span class="s1">&#39;G000592&#39;</span><span class="p">,</span>
        <span class="s1">&#39;H001090&#39;</span><span class="p">,</span> <span class="s1">&#39;H001085&#39;</span><span class="p">,</span> <span class="s1">&#39;H001066&#39;</span><span class="p">,</span> <span class="s1">&#39;L000601&#39;</span><span class="p">,</span>
        <span class="s1">&#39;L000590&#39;</span><span class="p">,</span> <span class="s1">&#39;N000188&#39;</span><span class="p">,</span> <span class="s1">&#39;P000613&#39;</span><span class="p">,</span> <span class="s1">&#39;P000614&#39;</span><span class="p">,</span>
        <span class="s1">&#39;P000608&#39;</span><span class="p">,</span> <span class="s1">&#39;P000620&#39;</span><span class="p">,</span> <span class="s1">&#39;S001190&#39;</span><span class="p">,</span> <span class="s1">&#39;S001221&#39;</span><span class="p">,</span>
        <span class="s1">&#39;S001200&#39;</span><span class="p">,</span> <span class="s1">&#39;S001215&#39;</span><span class="p">,</span> <span class="s1">&#39;S001223&#39;</span><span class="p">,</span> <span class="s1">&#39;J000301&#39;</span><span class="p">,</span>
        <span class="s1">&#39;J000295&#39;</span><span class="p">,</span> <span class="s1">&#39;K000398&#39;</span><span class="p">,</span> <span class="s1">&#39;K000397&#39;</span><span class="p">,</span> <span class="s1">&#39;L000598&#39;</span><span class="p">,</span>
        <span class="s1">&#39;L000599&#39;</span><span class="p">,</span> <span class="s1">&#39;M001204&#39;</span><span class="p">,</span> <span class="s1">&#39;M001213&#39;</span><span class="p">,</span> <span class="s1">&#39;M001219&#39;</span><span class="p">,</span>
        <span class="s1">&#39;S000168&#39;</span><span class="p">,</span> <span class="s1">&#39;S001213&#39;</span><span class="p">,</span> <span class="s1">&#39;V000129&#39;</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1">#convert to dataframe to add to meta_data</span>
<span class="n">problem_solv_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">problem_solvers</span><span class="p">)</span>

<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;score_P&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">problem_solv_df</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;score_P&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;score_P&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ps_score</span><span class="p">,</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;score_P&#39;</span><span class="p">])</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>norm_G</th>
      <th>H: Vote for Other Party</th>
      <th>norm_H</th>
      <th>M: PVI</th>
      <th>norm_M</th>
      <th>N: nominate_dim1</th>
      <th>norm_N</th>
      <th>O: ideology_ideology</th>
      <th>norm_O</th>
      <th>score_P</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>27</td>
      <td>95.107163</td>
      <td>0.642</td>
      <td>85.782269</td>
      <td>0.642</td>
      <td>85.782269</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>...</td>
      <td>40.504494</td>
      <td>6.0</td>
      <td>93.707648</td>
      <td>5</td>
      <td>17.779565</td>
      <td>0.375</td>
      <td>30.853754</td>
      <td>0.375</td>
      <td>30.853754</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>...</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>23</td>
      <td>88.226800</td>
      <td>0.379</td>
      <td>31.686958</td>
      <td>0.379</td>
      <td>31.686958</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>...</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>33</td>
      <td>99.083130</td>
      <td>0.405</td>
      <td>37.314717</td>
      <td>0.405</td>
      <td>37.314717</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>82.186103</td>
      <td>0.0</td>
      <td>26.259061</td>
      <td>15</td>
      <td>59.813959</td>
      <td>0.621</td>
      <td>82.819560</td>
      <td>0.621</td>
      <td>82.819560</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
</section>
<section id="score-calculation-final-score">
<h2>Score Calculation &amp; Final Score<a class="headerlink" href="#score-calculation-final-score" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cal_score</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">):</span>
    <span class="c1"># Copy the data to avoid modifying the original dataframe</span>
    <span class="n">temp_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Initialize columns</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Calculate &#39;score_T&#39; by adding weighted norm values for each category</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;norm_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
    <span class="c1"># Calculate scores for ideology multipliers BEFORE the caucus score</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_M&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;M&#39;</span><span class="p">])</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_N&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_N&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;N&#39;</span><span class="p">])</span>
    
    <span class="c1">#calculate score_U </span>
    <span class="k">if</span> <span class="s1">&#39;score_P&#39;</span> <span class="ow">in</span> <span class="n">temp_data</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
        <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_P&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_M&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_N&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span> <span class="o">=</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_M&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_N&#39;</span><span class="p">]</span>
    
    
    <span class="c1"># Calculate mean, std, and median of &#39;score_S&#39;</span>
    <span class="n">mean_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">std_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">median_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Normalize &#39;score_S&#39; using the cumulative distribution function (CDF)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">],</span> <span class="n">mean_U</span><span class="p">,</span> <span class="n">std_U</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Define the grade assignment function based on the calculated scores</span>
    <span class="k">def</span> <span class="nf">assign_grade</span><span class="p">(</span><span class="n">grade</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">mean_U</span> <span class="o">+</span> <span class="n">std_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;A&#39;</span>
        <span class="k">elif</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">median_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;B&#39;</span>
        <span class="k">elif</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">mean_U</span> <span class="o">-</span> <span class="n">std_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;C&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;F&#39;</span>

    <span class="c1"># Apply the grade assignment to the &#39;score_S&#39; column</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">assign_grade</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">temp_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># HOUSE: Call the function to get the final scores and grades</span>
<span class="n">house_scores</span> <span class="o">=</span> <span class="n">cal_score</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="c1"># Display the specific columns</span>
<span class="n">house_scores</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>Party</th>
      <th>score_U</th>
      <th>Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001212</td>
      <td>Barry Moore</td>
      <td>Republican</td>
      <td>258.838026</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F000481</td>
      <td>Shomari Figures</td>
      <td>Democratic</td>
      <td>183.648405</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>R000575</td>
      <td>Mike D. Rogers</td>
      <td>Republican</td>
      <td>211.454516</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A000055</td>
      <td>Robert B. Aderholt</td>
      <td>Republican</td>
      <td>215.158736</td>
      <td>C</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S001220</td>
      <td>Dale W. Strong</td>
      <td>Republican</td>
      <td>264.082603</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_scores</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>norm_N</th>
      <th>O: ideology_ideology</th>
      <th>norm_O</th>
      <th>score_P</th>
      <th>score_T</th>
      <th>score_M</th>
      <th>score_N</th>
      <th>score_U</th>
      <th>norm_U</th>
      <th>Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barry Moore</td>
      <td>House</td>
      <td>M001212</td>
      <td>Alabama</td>
      <td>1</td>
      <td>Republican</td>
      <td>4.0</td>
      <td>60.01</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>85.782269</td>
      <td>0.642</td>
      <td>85.782269</td>
      <td>0</td>
      <td>227.450275</td>
      <td>21.632150</td>
      <td>9.755600</td>
      <td>258.838026</td>
      <td>50.245183</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Shomari Figures</td>
      <td>House</td>
      <td>F000481</td>
      <td>Alabama</td>
      <td>2</td>
      <td>Democratic</td>
      <td>0.0</td>
      <td>18.83</td>
      <td>10.0</td>
      <td>40.72</td>
      <td>...</td>
      <td>30.853754</td>
      <td>0.375</td>
      <td>30.853754</td>
      <td>0</td>
      <td>177.746090</td>
      <td>3.160248</td>
      <td>2.742067</td>
      <td>183.648405</td>
      <td>20.127641</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Mike D. Rogers</td>
      <td>House</td>
      <td>R000575</td>
      <td>Alabama</td>
      <td>3</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>2.0</td>
      <td>26.30</td>
      <td>...</td>
      <td>31.686958</td>
      <td>0.379</td>
      <td>31.686958</td>
      <td>0</td>
      <td>191.522696</td>
      <td>16.897435</td>
      <td>3.034386</td>
      <td>211.454516</td>
      <td>29.970883</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Robert B. Aderholt</td>
      <td>House</td>
      <td>A000055</td>
      <td>Alabama</td>
      <td>4</td>
      <td>Republican</td>
      <td>1.0</td>
      <td>27.43</td>
      <td>5.0</td>
      <td>31.40</td>
      <td>...</td>
      <td>37.314717</td>
      <td>0.405</td>
      <td>37.314717</td>
      <td>0</td>
      <td>192.494356</td>
      <td>19.072943</td>
      <td>3.591436</td>
      <td>215.158736</td>
      <td>31.430045</td>
      <td>C</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Dale W. Strong</td>
      <td>House</td>
      <td>S001220</td>
      <td>Alabama</td>
      <td>5</td>
      <td>Republican</td>
      <td>2.0</td>
      <td>37.62</td>
      <td>3.0</td>
      <td>27.95</td>
      <td>...</td>
      <td>82.819560</td>
      <td>0.621</td>
      <td>82.819560</td>
      <td>0</td>
      <td>239.808310</td>
      <td>14.343884</td>
      <td>9.930409</td>
      <td>264.082603</td>
      <td>52.589761</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 35 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_scores</span><span class="p">[</span><span class="n">house_scores</span><span class="p">[</span><span class="s2">&quot;Grade&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;score_U&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>norm_N</th>
      <th>O: ideology_ideology</th>
      <th>norm_O</th>
      <th>score_P</th>
      <th>score_T</th>
      <th>score_M</th>
      <th>score_N</th>
      <th>score_U</th>
      <th>norm_U</th>
      <th>Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39</th>
      <td>Jimmy Panetta</td>
      <td>House</td>
      <td>P000613</td>
      <td>California</td>
      <td>19</td>
      <td>Democratic</td>
      <td>9.0</td>
      <td>95.31</td>
      <td>121.0</td>
      <td>100.00</td>
      <td>...</td>
      <td>15.865525</td>
      <td>0.290</td>
      <td>15.865525</td>
      <td>25</td>
      <td>451.505113</td>
      <td>32.771370</td>
      <td>3.581683</td>
      <td>512.858166</td>
      <td>99.784723</td>
      <td>A</td>
    </tr>
    <tr>
      <th>322</th>
      <td>Brian K. Fitzpatrick</td>
      <td>House</td>
      <td>F000466</td>
      <td>Pennsylvania</td>
      <td>1</td>
      <td>Republican</td>
      <td>25.0</td>
      <td>100.00</td>
      <td>247.0</td>
      <td>100.00</td>
      <td>...</td>
      <td>2.949718</td>
      <td>0.139</td>
      <td>2.949718</td>
      <td>25</td>
      <td>473.243581</td>
      <td>0.000000</td>
      <td>0.697968</td>
      <td>498.941548</td>
      <td>99.652045</td>
      <td>A</td>
    </tr>
    <tr>
      <th>60</th>
      <td>Young Kim</td>
      <td>House</td>
      <td>K000397</td>
      <td>California</td>
      <td>40</td>
      <td>Republican</td>
      <td>12.0</td>
      <td>99.43</td>
      <td>31.0</td>
      <td>79.22</td>
      <td>...</td>
      <td>11.393143</td>
      <td>0.255</td>
      <td>11.393143</td>
      <td>25</td>
      <td>451.201918</td>
      <td>3.693110</td>
      <td>2.570304</td>
      <td>482.465331</td>
      <td>99.403185</td>
      <td>A</td>
    </tr>
    <tr>
      <th>271</th>
      <td>Michael Lawler</td>
      <td>House</td>
      <td>L000599</td>
      <td>New York</td>
      <td>17</td>
      <td>Republican</td>
      <td>16.0</td>
      <td>99.99</td>
      <td>84.0</td>
      <td>99.97</td>
      <td>...</td>
      <td>5.545484</td>
      <td>0.189</td>
      <td>5.545484</td>
      <td>25</td>
      <td>451.502377</td>
      <td>0.000000</td>
      <td>1.251900</td>
      <td>477.754277</td>
      <td>99.307614</td>
      <td>A</td>
    </tr>
    <tr>
      <th>265</th>
      <td>Nicole Malliotakis</td>
      <td>House</td>
      <td>M000317</td>
      <td>New York</td>
      <td>11</td>
      <td>Republican</td>
      <td>20.0</td>
      <td>100.00</td>
      <td>27.0</td>
      <td>73.05</td>
      <td>...</td>
      <td>23.830525</td>
      <td>0.339</td>
      <td>23.830525</td>
      <td>25</td>
      <td>430.967770</td>
      <td>15.851870</td>
      <td>5.135094</td>
      <td>476.954734</td>
      <td>99.290117</td>
      <td>A</td>
    </tr>
    <tr>
      <th>74</th>
      <td>Joe Neguse</td>
      <td>House</td>
      <td>N000191</td>
      <td>Colorado</td>
      <td>2</td>
      <td>Democratic</td>
      <td>11.0</td>
      <td>98.76</td>
      <td>50.0</td>
      <td>96.11</td>
      <td>...</td>
      <td>42.534610</td>
      <td>0.428</td>
      <td>42.534610</td>
      <td>0</td>
      <td>432.618762</td>
      <td>34.525442</td>
      <td>9.200635</td>
      <td>476.344839</td>
      <td>99.276509</td>
      <td>A</td>
    </tr>
    <tr>
      <th>244</th>
      <td>Josh Gottheimer</td>
      <td>House</td>
      <td>G000583</td>
      <td>New Jersey</td>
      <td>5</td>
      <td>Democratic</td>
      <td>10.0</td>
      <td>97.50</td>
      <td>75.0</td>
      <td>99.87</td>
      <td>...</td>
      <td>3.980605</td>
      <td>0.162</td>
      <td>3.980605</td>
      <td>25</td>
      <td>445.766939</td>
      <td>4.505209</td>
      <td>0.887211</td>
      <td>476.159359</td>
      <td>99.272325</td>
      <td>A</td>
    </tr>
    <tr>
      <th>413</th>
      <td>Marie Gluesenkamp Perez</td>
      <td>House</td>
      <td>G000600</td>
      <td>Washington</td>
      <td>3</td>
      <td>Democratic</td>
      <td>10.0</td>
      <td>97.50</td>
      <td>42.0</td>
      <td>91.36</td>
      <td>...</td>
      <td>1.432623</td>
      <td>0.088</td>
      <td>1.432623</td>
      <td>25</td>
      <td>449.662218</td>
      <td>0.000000</td>
      <td>0.322098</td>
      <td>474.984317</td>
      <td>99.245321</td>
      <td>A</td>
    </tr>
    <tr>
      <th>201</th>
      <td>Debbie Dingell</td>
      <td>House</td>
      <td>D000624</td>
      <td>Michigan</td>
      <td>6</td>
      <td>Democratic</td>
      <td>7.0</td>
      <td>86.58</td>
      <td>46.0</td>
      <td>94.10</td>
      <td>...</td>
      <td>36.427356</td>
      <td>0.401</td>
      <td>36.427356</td>
      <td>25</td>
      <td>418.449797</td>
      <td>19.203326</td>
      <td>7.621510</td>
      <td>470.274633</td>
      <td>99.128026</td>
      <td>A</td>
    </tr>
    <tr>
      <th>159</th>
      <td>Zachary Nunn</td>
      <td>House</td>
      <td>N000193</td>
      <td>Iowa</td>
      <td>3</td>
      <td>Republican</td>
      <td>13.0</td>
      <td>99.75</td>
      <td>44.0</td>
      <td>92.83</td>
      <td>...</td>
      <td>16.151871</td>
      <td>0.292</td>
      <td>16.151871</td>
      <td>0</td>
      <td>459.725341</td>
      <td>4.646282</td>
      <td>3.712712</td>
      <td>468.084335</td>
      <td>99.068231</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 35 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Senate: Call the function to get the final scores and grades</span>
<span class="n">senate_scores</span> <span class="o">=</span> <span class="n">cal_score</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span>
<span class="c1"># Display the specific columns</span>
<span class="n">senate_scores</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>Party</th>
      <th>score_U</th>
      <th>Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B001319</td>
      <td>Katie Boyd Britt</td>
      <td>Republican</td>
      <td>233.782522</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1</th>
      <td>T000278</td>
      <td>Tommy Tuberville</td>
      <td>Republican</td>
      <td>184.086059</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001153</td>
      <td>Lisa Murkowski</td>
      <td>Republican</td>
      <td>368.150389</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S001198</td>
      <td>Dan Sullivan</td>
      <td>Republican</td>
      <td>325.783769</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>G000574</td>
      <td>Ruben Gallego</td>
      <td>Democratic</td>
      <td>201.963428</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_scores</span><span class="p">[</span><span class="n">senate_scores</span><span class="p">[</span><span class="s2">&quot;Grade&quot;</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;A&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;score_U&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Chamber</th>
      <th>bioguide_id</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>...</th>
      <th>N: nominate_dim1</th>
      <th>norm_N</th>
      <th>O: ideology_ideology</th>
      <th>norm_O</th>
      <th>score_T</th>
      <th>score_M</th>
      <th>score_N</th>
      <th>score_U</th>
      <th>norm_U</th>
      <th>Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>44</th>
      <td>Amy Klobuchar</td>
      <td>Senate</td>
      <td>K000367</td>
      <td>Minnesota</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>28.0</td>
      <td>99.97</td>
      <td>81.0</td>
      <td>99.94</td>
      <td>...</td>
      <td>0.280</td>
      <td>14.558566</td>
      <td>0.280</td>
      <td>14.558566</td>
      <td>456.812294</td>
      <td>7.137402</td>
      <td>3.325266</td>
      <td>467.274962</td>
      <td>98.888469</td>
      <td>A</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Chuck Grassley</td>
      <td>Senate</td>
      <td>G000386</td>
      <td>Iowa</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>21.0</td>
      <td>98.98</td>
      <td>30.0</td>
      <td>62.39</td>
      <td>...</td>
      <td>0.361</td>
      <td>27.240496</td>
      <td>0.361</td>
      <td>27.240496</td>
      <td>418.977552</td>
      <td>14.195688</td>
      <td>5.706578</td>
      <td>438.879819</td>
      <td>97.563850</td>
      <td>A</td>
    </tr>
    <tr>
      <th>54</th>
      <td>Catherine Cortez Masto</td>
      <td>Senate</td>
      <td>C001113</td>
      <td>Nevada</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>20.0</td>
      <td>98.45</td>
      <td>55.0</td>
      <td>96.07</td>
      <td>...</td>
      <td>0.353</td>
      <td>25.784611</td>
      <td>0.353</td>
      <td>25.784611</td>
      <td>425.937693</td>
      <td>0.000000</td>
      <td>5.491319</td>
      <td>431.429012</td>
      <td>97.050370</td>
      <td>A</td>
    </tr>
    <tr>
      <th>34</th>
      <td>Bill Cassidy</td>
      <td>Senate</td>
      <td>C001075</td>
      <td>Louisiana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>23.0</td>
      <td>99.59</td>
      <td>33.0</td>
      <td>68.76</td>
      <td>...</td>
      <td>0.464</td>
      <td>48.670439</td>
      <td>0.464</td>
      <td>48.670439</td>
      <td>395.488385</td>
      <td>25.367615</td>
      <td>9.624297</td>
      <td>430.480297</td>
      <td>96.978963</td>
      <td>A</td>
    </tr>
    <tr>
      <th>42</th>
      <td>Gary C. Peters</td>
      <td>Senate</td>
      <td>P000595</td>
      <td>Michigan</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>22.0</td>
      <td>99.35</td>
      <td>65.0</td>
      <td>99.03</td>
      <td>...</td>
      <td>0.246</td>
      <td>10.666802</td>
      <td>0.246</td>
      <td>10.666802</td>
      <td>415.359872</td>
      <td>0.000000</td>
      <td>2.215281</td>
      <td>417.575153</td>
      <td>95.857360</td>
      <td>A</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Jerry Moran</td>
      <td>Senate</td>
      <td>M000934</td>
      <td>Kansas</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>14.0</td>
      <td>88.13</td>
      <td>23.0</td>
      <td>46.48</td>
      <td>...</td>
      <td>0.414</td>
      <td>37.785808</td>
      <td>0.414</td>
      <td>37.785808</td>
      <td>388.355310</td>
      <td>17.997187</td>
      <td>7.337160</td>
      <td>413.689656</td>
      <td>95.460167</td>
      <td>A</td>
    </tr>
    <tr>
      <th>84</th>
      <td>John Cornyn</td>
      <td>Senate</td>
      <td>C001056</td>
      <td>Texas</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>23.0</td>
      <td>99.59</td>
      <td>34.0</td>
      <td>70.77</td>
      <td>...</td>
      <td>0.470</td>
      <td>50.000000</td>
      <td>0.470</td>
      <td>50.000000</td>
      <td>390.865584</td>
      <td>12.839729</td>
      <td>9.771640</td>
      <td>413.476952</td>
      <td>95.437568</td>
      <td>A</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Alex Padilla</td>
      <td>Senate</td>
      <td>P000145</td>
      <td>California</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>14.0</td>
      <td>88.13</td>
      <td>51.0</td>
      <td>93.68</td>
      <td>...</td>
      <td>0.390</td>
      <td>32.836064</td>
      <td>0.390</td>
      <td>32.836064</td>
      <td>376.289951</td>
      <td>25.897118</td>
      <td>6.177941</td>
      <td>408.365010</td>
      <td>94.866733</td>
      <td>A</td>
    </tr>
    <tr>
      <th>57</th>
      <td>Jeanne Shaheen</td>
      <td>Senate</td>
      <td>S001181</td>
      <td>New Hampshire</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>12.0</td>
      <td>80.41</td>
      <td>67.0</td>
      <td>99.29</td>
      <td>...</td>
      <td>0.232</td>
      <td>9.304708</td>
      <td>0.232</td>
      <td>9.304708</td>
      <td>398.445947</td>
      <td>5.404110</td>
      <td>1.853712</td>
      <td>405.703769</td>
      <td>94.547831</td>
      <td>A</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Christopher A. Coons</td>
      <td>Senate</td>
      <td>C001088</td>
      <td>Delaware</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>15.0</td>
      <td>91.05</td>
      <td>68.0</td>
      <td>99.40</td>
      <td>...</td>
      <td>0.236</td>
      <td>9.680048</td>
      <td>0.236</td>
      <td>9.680048</td>
      <td>380.482069</td>
      <td>17.581864</td>
      <td>1.841542</td>
      <td>399.905476</td>
      <td>93.798837</td>
      <td>A</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 34 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#reorder house_scores so score_P is after score_T as it is not included in score_T</span>
<span class="n">house_scores</span><span class="o">=</span><span class="n">house_scores</span><span class="p">[[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Chamber&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;District&#39;</span><span class="p">,</span> <span class="s1">&#39;Party&#39;</span><span class="p">,</span>
       <span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_A&#39;</span><span class="p">,</span>
       <span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_B&#39;</span><span class="p">,</span>
       <span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_C&#39;</span><span class="p">,</span> <span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_D&#39;</span><span class="p">,</span> <span class="s1">&#39;E: attack_personal&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_E&#39;</span><span class="p">,</span> <span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_F&#39;</span><span class="p">,</span> <span class="s1">&#39;G: Vote for Cosponsored Bill&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_G&#39;</span><span class="p">,</span>
       <span class="s1">&#39;H: Vote for Other Party&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_H&#39;</span><span class="p">,</span> <span class="s1">&#39;M: PVI&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_M&#39;</span><span class="p">,</span>
       <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_N&#39;</span><span class="p">,</span> <span class="s1">&#39;O: ideology_ideology&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_O&#39;</span><span class="p">,</span>
        <span class="s1">&#39;score_T&#39;</span><span class="p">,</span><span class="s1">&#39;score_P&#39;</span><span class="p">,</span> <span class="s1">&#39;score_M&#39;</span><span class="p">,</span> <span class="s1">&#39;score_N&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_U&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#convert numeric columns to numeric for purposes of export</span>

<span class="n">sen_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_A&#39;</span><span class="p">,</span>
       <span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_B&#39;</span><span class="p">,</span>
       <span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_C&#39;</span><span class="p">,</span> <span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_D&#39;</span><span class="p">,</span> <span class="s1">&#39;E: attack_personal&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_E&#39;</span><span class="p">,</span> <span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_F&#39;</span><span class="p">,</span> <span class="s1">&#39;G: Vote for Cosponsored Bill&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_G&#39;</span><span class="p">,</span>
       <span class="s1">&#39;H: Vote for Other Party&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_H&#39;</span><span class="p">,</span> <span class="s1">&#39;M: PVI&#39;</span><span class="p">,</span>
       <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_N&#39;</span><span class="p">,</span> <span class="s1">&#39;score_T&#39;</span><span class="p">,</span> <span class="s1">&#39;score_M&#39;</span><span class="p">,</span> <span class="s1">&#39;score_N&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_U&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sen_columns</span><span class="p">:</span>
    <span class="n">senate_scores</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">senate_scores</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

<span class="n">house_columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_A&#39;</span><span class="p">,</span>
       <span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_B&#39;</span><span class="p">,</span>
       <span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_C&#39;</span><span class="p">,</span> <span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_D&#39;</span><span class="p">,</span> <span class="s1">&#39;E: attack_personal&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_E&#39;</span><span class="p">,</span> <span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_F&#39;</span><span class="p">,</span> <span class="s1">&#39;G: Vote for Cosponsored Bill&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_G&#39;</span><span class="p">,</span>
       <span class="s1">&#39;H: Vote for Other Party&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_H&#39;</span><span class="p">,</span> <span class="s1">&#39;M: PVI&#39;</span><span class="p">,</span> <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;norm_N&#39;</span><span class="p">,</span> <span class="s1">&#39;score_T&#39;</span><span class="p">,</span><span class="s1">&#39;score_P&#39;</span><span class="p">,</span> <span class="s1">&#39;score_M&#39;</span><span class="p">,</span> <span class="s1">&#39;score_N&#39;</span><span class="p">,</span><span class="s1">&#39;score_U&#39;</span><span class="p">,</span>  <span class="s1">&#39;norm_U&#39;</span><span class="p">]</span>
<span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">house_columns</span><span class="p">:</span>
    <span class="n">house_scores</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">house_scores</span><span class="p">[</span><span class="n">col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#export scores as excel</span>
<span class="n">senate_scores</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;senate_scores_119.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;119 Grades&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">house_scores</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;house_scores_119.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;119 Grades&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Senate: Call the function to get the final scores and grades</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">cal_score</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span> <span class="c1"># Assign the result back to senate_final</span>
<span class="c1"># Display the specific columns</span>
<span class="n">senate_final</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>Party</th>
      <th>score_U</th>
      <th>Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>B001319</td>
      <td>Katie Boyd Britt</td>
      <td>Republican</td>
      <td>233.782522</td>
      <td>C</td>
    </tr>
    <tr>
      <th>1</th>
      <td>T000278</td>
      <td>Tommy Tuberville</td>
      <td>Republican</td>
      <td>184.086059</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001153</td>
      <td>Lisa Murkowski</td>
      <td>Republican</td>
      <td>368.150389</td>
      <td>A</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S001198</td>
      <td>Dan Sullivan</td>
      <td>Republican</td>
      <td>325.783769</td>
      <td>B</td>
    </tr>
    <tr>
      <th>4</th>
      <td>G000574</td>
      <td>Ruben Gallego</td>
      <td>Democratic</td>
      <td>201.963428</td>
      <td>C</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">]</span>
<span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Democratic&#39;</span><span class="p">,</span><span class="s1">&#39;Republican&#39;</span><span class="p">,</span><span class="s1">&#39;Independent&#39;</span><span class="p">]</span>
<span class="c1"># prompt: using senate_final plot &quot;Grade&quot; by &quot;Party&quot;</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Grade&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">senate_final</span><span class="p">,</span>  <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">],</span><span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> 
              <span class="n">hue_order</span><span class="o">=</span><span class="n">hue_order</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Senate Bridge Grade Distribution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/54cfafb782894e5e6957285fce2135e9f45572cd0e93a4f1da8fe9c46e1c906f.png" src="_images/54cfafb782894e5e6957285fce2135e9f45572cd0e93a4f1da8fe9c46e1c906f.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># House: Call the function to get the final scores and grades</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">cal_score</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">weights</span><span class="p">)</span> <span class="c1"># Assign the result back to house_final</span>
<span class="c1"># Display the specific columns</span>
<span class="n">house_final</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>Party</th>
      <th>score_U</th>
      <th>Grade</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001212</td>
      <td>Barry Moore</td>
      <td>Republican</td>
      <td>258.838026</td>
      <td>B</td>
    </tr>
    <tr>
      <th>1</th>
      <td>F000481</td>
      <td>Shomari Figures</td>
      <td>Democratic</td>
      <td>183.648405</td>
      <td>C</td>
    </tr>
    <tr>
      <th>2</th>
      <td>R000575</td>
      <td>Mike D. Rogers</td>
      <td>Republican</td>
      <td>211.454516</td>
      <td>C</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A000055</td>
      <td>Robert B. Aderholt</td>
      <td>Republican</td>
      <td>215.158736</td>
      <td>C</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S001220</td>
      <td>Dale W. Strong</td>
      <td>Republican</td>
      <td>264.082603</td>
      <td>B</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">order</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span><span class="s2">&quot;B&quot;</span><span class="p">,</span><span class="s2">&quot;C&quot;</span><span class="p">,</span><span class="s2">&quot;F&quot;</span><span class="p">]</span>
<span class="n">hue_order</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Democratic&#39;</span><span class="p">,</span><span class="s1">&#39;Republican&#39;</span><span class="p">,</span><span class="s1">&#39;Independent&#39;</span><span class="p">]</span>
<span class="c1"># prompt: using senate_final plot &quot;Grade&quot; by &quot;Party&quot;</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Grade&#39;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">house_final</span><span class="p">,</span>  <span class="n">palette</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">],</span>
              <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span> <span class="n">hue_order</span><span class="o">=</span><span class="n">hue_order</span><span class="p">)</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;House Bridge Grade Distribution&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/365ab4c9e6f3f5374d2c798eb2e8ab68cdbee3511c8ff2e1acff23b11a3baa85.png" src="_images/365ab4c9e6f3f5374d2c798eb2e8ab68cdbee3511c8ff2e1acff23b11a3baa85.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Sources%20of%20Information.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Bridge Grades Data Sources</p>
      </div>
    </a>
    <a class="right-next"
       href="Source%20A-B.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Source A-B: Legislator and Sponsorship Data Processing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Bridge Pledge 119: Final Bridge Grade Calculation Engine</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources">Data Sources</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files">Input Files</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files">Output Files</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-functions">Main Functions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-and-setup">1. Configuration and Setup</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attendance-filtering">2. Attendance Filtering</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-integration">3. Data Source Integration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#problem-solvers-caucus-bonus">4. Problem Solvers Caucus Bonus</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-score-calculation">5. Final Score Calculation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grade-assignment">6. Grade Assignment</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs">Outputs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-datasets">Final Datasets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-columns-in-output">Key Columns in Output</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements">Technical Requirements</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies">Dependencies</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-processing-notes">Data Processing Notes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality">Data Quality</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-checks">Validation Checks</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#known-limitations">Known Limitations</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#key-insights">Key Insights</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scoring-philosophy">Scoring Philosophy</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grade-distribution">Grade Distribution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transparency-features">Transparency Features</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-walkthrough-bridge-pledge"><strong>Notebook Walkthrough: Bridge Pledge</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#import-supporting-libaries">Import supporting Libaries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#adjust-variables">Adjust Variables</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Data Sources:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#base-table">Base Table</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-members-below-attendance-threshold">Remove members below attendance threshold</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-data">Source Data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#source-a-authors-of-bills-with-cross-party-sponsors">Source_A: Authors of Bills with Cross Party Sponsors</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-b-ranked-people-who-cosponsor-bills">Source_B: Ranked People who Cosponsor Bills</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-c-communication-bipartisanship-sum">Source_C: Communication: Bipartisanship (Sum)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-d-communication-bipartisanship-mean">Source_D: Communication: Bipartisanship (Mean)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-e-attack-personal-sum">Source_E: Attack_Personal (Sum)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-f-attack-personal-mean">Source_F: Attack_Personal (Mean)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-g-votes-for-cosponsored-bill">Source_G: Votes for Cosponsored Bill</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-h-votes-for-bill-sponsored-by-opposing-party">Source_H: Votes for Bill Sponsored by Opposing Party</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-m-cook-political-pvi">Source_M: Cook Political PVI</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-n-vote-view-ideological-score">Source N: Vote view ideological score</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-o-app-ideology-score">Source O - APP Ideology Score</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#source-p-caucus-bump">Source_P: Caucus Bump</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#score-calculation-final-score">Score Calculation &amp; Final Score</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bridge Grades Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>