
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Bridge Grades Calculation: Final Bridge Grade Calculation Engine &#8212; Bridge Grades Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Bridge_Grades_Calculation';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Suggested Weights for Bridge Grades System" href="Suggested_Weights.html" />
    <link rel="prev" title="Source N: VoteView Member Ideology Scores Processing" href="Source%20N.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-light" alt="Bridge Grades Documentation - Home"/>
    <script>document.write(`<img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-dark" alt="Bridge Grades Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Project%20Explanation.html"><strong>About Bridge Grades Project</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Sources%20of%20Information.html"><strong>Bridge Grades Data Sources</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Current_Legislators/get_current_members.html"><strong>Current Legislators Data Collection: Congress.gov API</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Current_Legislators/get_legislator_info_plural.html"><strong>Plural Policy Legislator Data Processing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20A-B.html"><strong>Source A-B: Legislator and Sponsorship Data Processing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20C-D-E-F.html"><strong>Source C-D-E-F: App Communications Calculations Data Processing</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Source%20M.html"><strong>Source M: Cook Political Partisan Voting Index (PVI) Processing</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Source%20N.html"><strong>Source N: VoteView Member Ideology Scores Processing</strong></a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Bridge Grades Calculation: Final Bridge Grade Calculation Engine</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Suggested_Weights.html"><strong>Suggested Weights for Bridge Grades System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Next%20Steps.html"><strong>Next Steps</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FBridge_Grades_Calculation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Bridge_Grades_Calculation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Bridge Grades Calculation: Final Bridge Grade Calculation Engine</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Bridge Grades Calculation: Final Bridge Grade Calculation Engine</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources"><strong>Data Sources</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files"><strong>Input Files</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files"><strong>Output Files</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-functions"><strong>Main Functions</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-and-setup"><strong>1. Configuration and Setup</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attendance-filtering"><strong>2. Attendance Filtering</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-integration"><strong>3. Data Source Integration</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-score-calculation"><strong>4. Final Score Calculation</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs"><strong>Outputs</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-datasets"><strong>Final Datasets</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-columns-in-output"><strong>Key Columns in Output</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements"><strong>Technical Requirements</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies"><strong>Dependencies</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-processing-notes"><strong>Data Processing Notes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality"><strong>Data Quality</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-checks"><strong>Validation Checks</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-walkthrough-bridge-grades-calculation"><strong>Notebook Walkthrough: Bridge Grades Calculation</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-file-existence-checks"><strong>Configuration &amp; File Existence Checks</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataframes-validate-weights"><strong>Load DataFrames &amp; Validate Weights</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-base-member-tables"><strong>Build Base Member Tables</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Attendance Filtering</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-a-authors-of-bills-with-cross-party-sponsors"><strong>Source A: Authors of Bills with Cross-Party Sponsors</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-a"><strong>Load &amp; Prepare Source A</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-normalize-for-house"><strong>Merge &amp; Normalize for House</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-normalize-for-senate"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-b-ranked-people-who-cosponsor-bills"><strong>Source B: Ranked People Who Cosponsor Bills</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-b"><strong>Load &amp; Prepare Source B</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Merge &amp; Normalize for House</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-c-communication-bipartisanship-sum"><strong>Source C: Communication – Bipartisanship (Sum)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-c"><strong>Load &amp; Prepare Source C</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-d-communication-bipartisanship-mean"><strong>Source D: Communication – Bipartisanship (Mean)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-d"><strong>Load &amp; Prepare Source D</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-e-attack-personal-sum"><strong>Source E: Attack_Personal (Sum)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-e"><strong>Load &amp; Prepare Source E</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>Merge &amp; Normalize for House</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-f-attack-personal-pct"><strong>Source F: Attack_Personal (Pct)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-validate-source-f"><strong>Load &amp; Validate Source F</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-m-cook-political-partisan-voting-index-pvi"><strong>Source M: Cook Political Partisan Voting Index (PVI)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-cap-for-house"><strong>Merge &amp; Cap for House</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-cap-for-senate"><strong>Merge &amp; Cap for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-n-voteview-member-ideology-score"><strong>Source N: Voteview Member Ideology Score</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-prepare-apply-problem-solvers-caucus-bump"><strong>Section: Prepare &amp; Apply “Problem Solvers Caucus” Bump</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-p-problem-solvers-caucus-bump"><strong>Source P: Problem Solvers Caucus “Bump”</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#score-calculation-final-grades"><strong>Score Calculation &amp; Final Grades</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-scoring-function"><strong>Build the Scoring Function</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-up-for-final-output"><strong>Clean up for final output</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#party"><strong>Party</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#district-and-state-district"><strong>district and state_district</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#reorganize-columns"><strong>Reorganize columns</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="bridge-grades-calculation-final-bridge-grade-calculation-engine">
<h1><strong>Bridge Grades Calculation: Final Bridge Grade Calculation Engine</strong><a class="headerlink" href="#bridge-grades-calculation-final-bridge-grade-calculation-engine" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Overview</p>
<p>This notebook serves as the <strong>central scoring engine</strong> for the Bridge Grades methodology, combining all processed data sources to calculate final Bridge Grades for members of the 119th U.S. Congress. It implements the complete scoring algorithm that transforms raw collaboration metrics into letter grades (A, B, C, F) that identify “bridgers” from “dividers.”</p>
<p>The notebook processes data from different sources (A, B, C, D, E, F, M, N, P) and applies configurable weights to generate normalized scores that are then converted to final Bridge Grades.</p>
</div>
<section id="data-sources">
<h2><strong>Data Sources</strong><a class="headerlink" href="#data-sources" title="Link to this heading">#</a></h2>
<section id="input-files">
<h3><strong>Input Files</strong><a class="headerlink" href="#input-files" title="Link to this heading">#</a></h3>
<p>All processed data sources from previous notebooks:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">119th_Congress_20250809.csv</span></code></strong> - Master congressional roster with bioguide IDs, states, districts, parties, and chambers</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_a_cross_party_supported_bills.csv</span></code></strong> - Source A: Authors of bills with cross-party sponsors</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_b_cross_party_cosponsors.csv</span></code></strong> - Source B: Cosponsors of cross-party bills</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grades_source_cdef_app_communication.csv</span></code></strong> - Source C/D/E/F: APP communications data (bipartisanship and personal attacks)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_m_house_pvi.csv</span></code></strong> - Source M: Cook Political PVI for House districts (House)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_m_senate_pvi.csv</span></code></strong> - Source M: Cook Political PVI for House districts (Senate)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_n_house_ideology.csv</span></code></strong> - Source N: VoteView ideological scores (House)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_n_senate_ideology.csv</span></code></strong> - Source N: VoteView ideological scores (Senate)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">problem_solvers.csv</span></code></strong> - Source P: Problem Solvers Caucus</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">profiles.csv</span></code></strong> - Attendance data for filtering</p></li>
</ul>
</section>
<section id="output-files">
<h3><strong>Output Files</strong><a class="headerlink" href="#output-files" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">house_scores_119.xlsx</span></code></strong> - Complete House member scores and grades</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">senate_scores_119.xlsx</span></code></strong> - Complete Senate member scores and grades</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="main-functions">
<h2><strong>Main Functions</strong><a class="headerlink" href="#main-functions" title="Link to this heading">#</a></h2>
<section id="configuration-and-setup">
<h3><strong>1. Configuration and Setup</strong><a class="headerlink" href="#configuration-and-setup" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Sets up scoring parameters and loads all data sources</p>
<p><strong>Key Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">att_pct</span> <span class="pre">=</span> <span class="pre">0.2</span></code> - Minimum attendance threshold (20%) for grading eligibility</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weights</span></code> - Configurable weights for each data source (A=3, B=3, C=1, D=1, etc.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bonus_scaling_factor</span></code>: scaling factors that control the effect of bonuses on the score. (All these factors were sought by methodologies assigned individually to each one)</p></li>
</ul>
<p><strong>Code Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">att_pct</span>   <span class="o">=</span> <span class="mf">0.2</span>    <span class="c1"># minimum attendance proportion</span>

<span class="n">weights</span>   <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>     <span class="c1"># Source A: num_bills_with_cross_party_cosponsors</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>     <span class="c1"># Source B: num_cross_party_cosponsored_bills</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source C: communications that support members of the opposite party</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source D: proportion of communications that support members of the opposite party</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source E: communications classified as personal attacks</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source F: proportion of communications classified as personal attacks</span>
<span class="p">}</span>

<span class="n">bonuses</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pvi_value_cap&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="c1"># number of PVI points to cap at</span>
    <span class="s1">&#39;max_P_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="c1"># scaling factor for P bonus</span>
    <span class="s1">&#39;max_N_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="c1"># scaling factor for N bonus</span>
    <span class="s1">&#39;max_M_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.38</span> <span class="c1"># scaling factor for M bonus</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="attendance-filtering">
<h3><strong>2. Attendance Filtering</strong><a class="headerlink" href="#attendance-filtering" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Removes members with attendance below threshold from grading</p>
<p><strong>Process:</strong></p>
<ul class="simple">
<li><p>Calculates attendance percentage for each member</p></li>
<li><p>Filters out members below 20% attendance threshold</p></li>
<li><p>Applies filtering to both House and Senate datasets</p></li>
</ul>
</section>
<section id="data-source-integration">
<h3><strong>3. Data Source Integration</strong><a class="headerlink" href="#data-source-integration" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Merges all processed data sources into master datasets</p>
<p><strong>For Each Source (A through F):</strong></p>
<ul class="simple">
<li><p>Loads processed CSV file</p></li>
<li><p>Merges with master dataset using bioguide_id</p></li>
<li><p>Fills missing values appropriately (0 for counts, mean for percentages)</p></li>
<li><p>Calculates normalized scores using normal distribution CDF</p></li>
<li><p>Renames columns with source prefix for clarity</p></li>
</ul>
</section>
<section id="final-score-calculation">
<h3><strong>4. Final Score Calculation</strong><a class="headerlink" href="#final-score-calculation" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Combines all normalized scores using weighted algorithm</p>
<p><strong>Algorithm:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cal_score</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bonuses</span><span class="p">):</span>
    <span class="c1"># Copy the data to avoid modifying the original dataframe</span>
    <span class="n">temp_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Initialize columns</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Calculate &#39;score_T&#39; by adding weighted norm values for each category</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;norm_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>


    <span class="c1"># Calculate scores for ideology multipliers BEFORE the caucus score</span>
    <span class="c1"># Add bonuses</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_M_bonus_scaling_factor&#39;</span><span class="p">]))</span><span class="o">-</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span>


    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_N_bonus_scaling_factor&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;ideology_dist&#39;</span><span class="p">]</span>

    <span class="c1">#the bonuses M and N to 0 if they are negative</span>

    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
      <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_P_bonus_scaling_factor&#39;</span><span class="p">]</span>
      <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
      <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;P_flag&#39;</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_p&#39;</span><span class="p">]</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_p&#39;</span><span class="p">]</span>

    <span class="c1"># Calculate mean, std, and median of &#39;score_S&#39;</span>
    <span class="n">mean_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">std_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">median_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Normalize &#39;score_U&#39; using the cumulative distribution function (CDF)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">],</span> <span class="n">mean_U</span><span class="p">,</span> <span class="n">std_U</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Define the grade assignment function based on the calculated scores</span>
    <span class="k">def</span> <span class="nf">assign_grade</span><span class="p">(</span><span class="n">grade</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">mean_U</span> <span class="o">+</span> <span class="n">std_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;A&#39;</span>
        <span class="k">elif</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">median_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;B&#39;</span>
        <span class="k">elif</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">mean_U</span> <span class="o">-</span> <span class="n">std_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;C&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;F&#39;</span>

    <span class="c1"># Apply the grade assignment to the &#39;score_S&#39; column</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">assign_grade</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">temp_data</span>
</pre></div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="outputs">
<h2><strong>Outputs</strong><a class="headerlink" href="#outputs" title="Link to this heading">#</a></h2>
<section id="final-datasets">
<h3><strong>Final Datasets</strong><a class="headerlink" href="#final-datasets" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>House Scores Dataset</strong> (<code class="docutils literal notranslate"><span class="pre">house_scores_119.xlsx</span></code>)</p>
<ul class="simple">
<li><p>All House members with complete scoring breakdown</p></li>
<li><p>Individual source scores and normalized values</p></li>
<li><p>Final composite score and letter grade</p></li>
</ul>
</li>
<li><p><strong>Senate Scores Dataset</strong> (<code class="docutils literal notranslate"><span class="pre">senate_scores_119.xlsx</span></code>)</p>
<ul class="simple">
<li><p>All Senate members with complete scoring breakdown</p></li>
<li><p>Individual source scores and normalized values</p></li>
<li><p>Final composite score and letter grade</p></li>
</ul>
</li>
</ol>
</section>
<section id="key-columns-in-output">
<h3><strong>Key Columns in Output</strong><a class="headerlink" href="#key-columns-in-output" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Identification:</strong> Name, Chamber, bioguide_id, State, District, Party</p></li>
<li><p><strong>Raw Source Data:</strong> A through F source values</p></li>
<li><p><strong>Normalized Scores:</strong> norm_A through norm_F (0-100 scale)</p></li>
<li><p><strong>Composite Scores:</strong> score_T (base), score_P (caucus), score_M (PVI), score_N (ideology), score_U (final)</p></li>
<li><p><strong>Final Results:</strong> norm_U (normalized final), Grade (A/B/C/F)</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="technical-requirements">
<h2><strong>Technical Requirements</strong><a class="headerlink" href="#technical-requirements" title="Link to this heading">#</a></h2>
<section id="dependencies">
<h3><strong>Dependencies</strong><a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>pandas</strong> - Data manipulation and analysis</p></li>
<li><p><strong>numpy</strong> - Numerical operations</p></li>
<li><p><strong>scipy.stats</strong> - Statistical functions (normal distribution CDF)</p></li>
<li><p><strong>seaborn</strong> - Data visualization</p></li>
<li><p><strong>matplotlib.pyplot</strong> - Plotting</p></li>
</ul>
</section>
<section id="data-processing-notes">
<h3><strong>Data Processing Notes</strong><a class="headerlink" href="#data-processing-notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Missing Value Handling:</strong> Fills missing values with 0 for counts, column mean for percentages</p></li>
<li><p><strong>Duplicate Removal:</strong> Removes duplicate bioguide_id entries</p></li>
<li><p><strong>Data Type Conversion:</strong> Converts numeric columns to appropriate types for export</p></li>
<li><p><strong>Chamber Separation:</strong> Processes House and Senate separately due to different data structures</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="data-quality">
<h2><strong>Data Quality</strong><a class="headerlink" href="#data-quality" title="Link to this heading">#</a></h2>
<section id="validation-checks">
<h3><strong>Validation Checks</strong><a class="headerlink" href="#validation-checks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Attendance Filtering:</strong> Removes members below 20% attendance threshold</p></li>
<li><p><strong>Duplicate Handling:</strong> Removes duplicate bioguide_id entries</p></li>
<li><p><strong>Missing Data:</strong> Appropriate filling strategies for each data type</p></li>
<li><p><strong>Score Validation:</strong> Ensures all scores are within expected ranges</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section class="tex2jax_ignore mathjax_ignore" id="notebook-walkthrough-bridge-grades-calculation">
<h1><strong>Notebook Walkthrough: Bridge Grades Calculation</strong><a class="headerlink" href="#notebook-walkthrough-bridge-grades-calculation" title="Link to this heading">#</a></h1>
<section id="configuration-file-existence-checks">
<h2><strong>Configuration &amp; File Existence Checks</strong><a class="headerlink" href="#configuration-file-existence-checks" title="Link to this heading">#</a></h2>
<p>In this section we verify that all input files exist before proceeding, and validate that our <code class="docutils literal notranslate"><span class="pre">weights</span></code> dictionary matches the set of loaded source labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Global parameters</span>
<span class="n">att_pct</span>   <span class="o">=</span> <span class="mf">0.2</span>    <span class="c1"># minimum attendance proportion</span>
<span class="n">weights</span>   <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>     <span class="c1"># Source A: num_bills_with_cross_party_cosponsors</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>     <span class="c1"># Source B: num_cross_party_cosponsored_bills</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source C: communications that support members of the opposite party</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source D: proportion of communications that support members of the opposite party</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source E: communications classified as personal attacks</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source F: proportion of communications classified as personal attacks</span>
<span class="p">}</span>

<span class="n">bonuses</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pvi_value_cap&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="c1"># number of PVI points to cap at</span>
    <span class="s1">&#39;max_P_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="c1"># scaling factor for P bonus</span>
    <span class="s1">&#39;max_N_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="c1"># scaling factor for N bonus</span>
    <span class="s1">&#39;max_M_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.38</span> <span class="c1"># scaling factor for M bonus</span>
<span class="p">}</span>

<span class="c1"># Define all required file paths</span>
<span class="n">BASE_DIR</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Bridge Grades Snapshot August/Data&#39;</span>
<span class="c1"># BASE_DIR = &#39;../Data&#39;</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;meta&#39;</span><span class="p">:</span>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source C-D-E-F/Input files/119th_Congress_20250809.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span>           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source A-B/Output files/bridge_grade_source_a_cross_party_supported_bills.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span>           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source A-B/Output files/bridge_grade_source_b_cross_party_cosponsors.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;CDEF&#39;</span><span class="p">:</span>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source C-D-E-F/Output files/bridge_grades_source_cdef_app_communication.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;M_House&#39;</span><span class="p">:</span>     <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source M/Output files/bridge_grade_source_m_house_pvi.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;M_Senate&#39;</span><span class="p">:</span>    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source M/Output files/bridge_grade_source_m_senate_pvi.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;N_House&#39;</span><span class="p">:</span>     <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source N/Output files/bridge_grade_source_n_house_ideology.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;N_Senate&#39;</span><span class="p">:</span>    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source N/Output files/bridge_grade_source_n_senate_ideology.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;P&#39;</span><span class="p">:</span>           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source P/problem_solvers.csv&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Load raw APP profiles (attendance data)</span>
<span class="n">source_APP_profiles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/profiles.csv&quot;</span><span class="p">,</span>
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_max&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Check each file exists</span>
<span class="n">missing_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>
<span class="k">if</span> <span class="n">missing_files</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing input files for sources: </span><span class="si">{</span><span class="n">missing_files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All input files found.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="load-dataframes-validate-weights">
<h2><strong>Load DataFrames &amp; Validate Weights</strong><a class="headerlink" href="#load-dataframes-validate-weights" title="Link to this heading">#</a></h2>
<p>We load each CSV into a DataFrame and then ensure the set of weight keys matches the loaded source labels exactly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load master metadata</span>
<span class="n">meta_data</span>        <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;meta&#39;</span><span class="p">])</span>

<span class="c1"># Load each source DataFrame</span>
<span class="n">source_A</span>         <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>
<span class="n">source_B</span>         <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">source_APP</span>       <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;CDEF&#39;</span><span class="p">])</span>
<span class="n">source_M_House</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;M_House&#39;</span><span class="p">])</span>
<span class="n">source_M_Senate</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;M_Senate&#39;</span><span class="p">])</span>
<span class="n">source_N_House</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;N_House&#39;</span><span class="p">])</span>
<span class="n">source_N_Senate</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;N_Senate&#39;</span><span class="p">])</span>
<span class="n">source_P</span>         <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">])</span>

<span class="c1"># 2.3 Verify weight keys vs. sources to be scored (A–O)</span>
<span class="n">loaded_sources</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">expected_sources</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">}</span>
<span class="k">if</span> <span class="n">loaded_sources</span> <span class="o">!=</span> <span class="n">expected_sources</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Weights keys </span><span class="si">{</span><span class="n">loaded_sources</span><span class="si">}</span><span class="s2"> do not match expected </span><span class="si">{</span><span class="n">expected_sources</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weights validated against source labels.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Weights validated against source labels.
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-base-member-tables">
<h2><strong>Build Base Member Tables</strong><a class="headerlink" href="#build-base-member-tables" title="Link to this heading">#</a></h2>
<p>In this section we initialize our working DataFrames for the House and Senate by subsetting the master <code class="docutils literal notranslate"><span class="pre">meta_data</span></code>. These tables will be the foundation for merging each source’s metrics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preview master metadata</span>
<span class="n">meta_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-45572ffe-859c-4a13-af43-924c28d5a02c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-07-14T14:25:50Z</td>
      <td>https://www.congress.gov/img/member/677448630b...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-06-13T13:48:04Z</td>
      <td>https://www.congress.gov/img/member/684c235633...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-06-07T10:30:29Z</td>
      <td>https://www.congress.gov/img/member/677d8231fd...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2021</td>
      <td>NaN</td>
      <td>2025-06-03T13:18:42Z</td>
      <td>https://www.congress.gov/img/member/l000570_20...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-28T10:30:24Z</td>
      <td>https://www.congress.gov/img/member/h001089_20...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-05-24T10:30:30Z</td>
      <td>https://www.congress.gov/img/member/fd3cb364b8...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-05-17T10:30:27Z</td>
      <td>https://www.congress.gov/img/member/67c8694e61...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>2024</td>
      <td>NaN</td>
      <td>2025-05-09T13:45:32Z</td>
      <td>https://www.congress.gov/img/member/681dfed94f...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-08T13:36:39Z</td>
      <td>https://www.congress.gov/img/member/681bc0e6b7...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>M001244</td>
      <td>Ashley Moody</td>
      <td>Ashley</td>
      <td>NaN</td>
      <td>Moody</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Florida</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-05-07T10:42:23Z</td>
      <td>No Image Available</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-45572ffe-859c-4a13-af43-924c28d5a02c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-45572ffe-859c-4a13-af43-924c28d5a02c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-45572ffe-859c-4a13-af43-924c28d5a02c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-54e97b71-34c7-4ba1-ad70-b55a44033186">
      <button class="colab-df-quickchart" onclick="quickchart('df-54e97b71-34c7-4ba1-ad70-b55a44033186')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-54e97b71-34c7-4ba1-ad70-b55a44033186 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subset to House members</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Chamber==&#39;House&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">house_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>431
</pre></div>
</div>
<div class="output text_html">
  <div id="df-37eb983b-34c2-4be7-9d3e-39295ca052fd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-07-14T14:25:50Z</td>
      <td>https://www.congress.gov/img/member/677448630b...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-06-13T13:48:04Z</td>
      <td>https://www.congress.gov/img/member/684c235633...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>2024</td>
      <td>NaN</td>
      <td>2025-05-09T13:45:32Z</td>
      <td>https://www.congress.gov/img/member/681dfed94f...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-08T13:36:39Z</td>
      <td>https://www.congress.gov/img/member/681bc0e6b7...</td>
    </tr>
    <tr>
      <th>10</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-04-30T18:14:58Z</td>
      <td>https://www.congress.gov/img/member/681231f624...</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-37eb983b-34c2-4be7-9d3e-39295ca052fd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-37eb983b-34c2-4be7-9d3e-39295ca052fd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-37eb983b-34c2-4be7-9d3e-39295ca052fd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-27685958-0d4c-4998-8624-e5a361520681">
      <button class="colab-df-quickchart" onclick="quickchart('df-27685958-0d4c-4998-8624-e5a361520681')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-27685958-0d4c-4998-8624-e5a361520681 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subset to Senate members</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Chamber==&#39;Senate&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">senate_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
<div class="output text_html">
  <div id="df-4e10dbb5-42ce-45e7-8109-1d1d22e9c63d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-06-07T10:30:29Z</td>
      <td>https://www.congress.gov/img/member/677d8231fd...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2021</td>
      <td>NaN</td>
      <td>2025-06-03T13:18:42Z</td>
      <td>https://www.congress.gov/img/member/l000570_20...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-28T10:30:24Z</td>
      <td>https://www.congress.gov/img/member/h001089_20...</td>
    </tr>
    <tr>
      <th>5</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-05-24T10:30:30Z</td>
      <td>https://www.congress.gov/img/member/fd3cb364b8...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-05-17T10:30:27Z</td>
      <td>https://www.congress.gov/img/member/67c8694e61...</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4e10dbb5-42ce-45e7-8109-1d1d22e9c63d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4e10dbb5-42ce-45e7-8109-1d1d22e9c63d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4e10dbb5-42ce-45e7-8109-1d1d22e9c63d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-332e42db-9973-485c-b77e-9e37218a749a">
      <button class="colab-df-quickchart" onclick="quickchart('df-332e42db-9973-485c-b77e-9e37218a749a')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-332e42db-9973-485c-b77e-9e37218a749a button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="id1">
<h2><strong>Attendance Filtering</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h2>
<p>Legislators below the minimum attendance threshold (<code class="docutils literal notranslate"><span class="pre">att_pct</span></code>) are excluded from scoring. We calculate each member’s attendance percentage and remove those below <code class="docutils literal notranslate"><span class="pre">att_pct</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract attendance data</span>
<span class="n">source_att</span> <span class="o">=</span> <span class="n">source_APP_profiles</span><span class="p">[[</span>
    <span class="s1">&#39;full_name&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_max&#39;</span>
<span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_att</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d33df312-b30a-470e-ac1e-fefb8fea9667" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>full_name</th>
      <th>bioguide_id</th>
      <th>attendance_total</th>
      <th>attendance_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Maria Cantwell</td>
      <td>C000127</td>
      <td>414.0</td>
      <td>414</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Amy Klobuchar</td>
      <td>K000367</td>
      <td>410.0</td>
      <td>414</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Bernard Sanders</td>
      <td>S000033</td>
      <td>371.0</td>
      <td>414</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Sheldon Whitehouse</td>
      <td>W000802</td>
      <td>393.0</td>
      <td>414</td>
    </tr>
    <tr>
      <th>4</th>
      <td>John Barrasso</td>
      <td>B001261</td>
      <td>411.0</td>
      <td>414</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d33df312-b30a-470e-ac1e-fefb8fea9667')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d33df312-b30a-470e-ac1e-fefb8fea9667 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d33df312-b30a-470e-ac1e-fefb8fea9667');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-a08faaff-0193-4764-9c9c-637a73980098">
      <button class="colab-df-quickchart" onclick="quickchart('df-a08faaff-0193-4764-9c9c-637a73980098')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-a08faaff-0193-4764-9c9c-637a73980098 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_att</span><span class="p">[</span><span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-665d25f3-6ce2-40de-b77e-de42388e526f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>full_name</th>
      <th>bioguide_id</th>
      <th>attendance_total</th>
      <th>attendance_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>210</th>
      <td>Aumua Amata Radewagen</td>
      <td>R000600</td>
      <td>NaN</td>
      <td>168</td>
    </tr>
    <tr>
      <th>500</th>
      <td>Kimberlyn King-Hinds</td>
      <td>K000404</td>
      <td>NaN</td>
      <td>168</td>
    </tr>
    <tr>
      <th>520</th>
      <td>Pablo José Hernández Rivera</td>
      <td>H001103</td>
      <td>NaN</td>
      <td>168</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-665d25f3-6ce2-40de-b77e-de42388e526f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-665d25f3-6ce2-40de-b77e-de42388e526f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-665d25f3-6ce2-40de-b77e-de42388e526f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-ddad4c12-4cca-4347-a5c2-6f5cb65e7192">
      <button class="colab-df-quickchart" onclick="quickchart('df-ddad4c12-4cca-4347-a5c2-6f5cb65e7192')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-ddad4c12-4cca-4347-a5c2-6f5cb65e7192 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note, missing legislators are non-voting members from territories.</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing totals with zero</span>
<span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute attendance percentage</span>
<span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_max&#39;</span><span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify members below threshold</span>
<span class="n">low_att</span> <span class="o">=</span> <span class="n">source_att</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;attendance_pct &lt; @att_pct&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">)</span>
<span class="n">low_att</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-bdb57d23-09f5-4b3f-af4c-4180e56eb2d7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>full_name</th>
      <th>bioguide_id</th>
      <th>attendance_total</th>
      <th>attendance_max</th>
      <th>attendance_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>95</th>
      <td>Eleanor Norton</td>
      <td>N000147</td>
      <td>4.0</td>
      <td>168</td>
      <td>0.023810</td>
    </tr>
    <tr>
      <th>207</th>
      <td>Stacey Plaskett</td>
      <td>P000610</td>
      <td>7.0</td>
      <td>168</td>
      <td>0.041667</td>
    </tr>
    <tr>
      <th>210</th>
      <td>Aumua Amata Radewagen</td>
      <td>R000600</td>
      <td>0.0</td>
      <td>168</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>405</th>
      <td>James (Jim) Moylan</td>
      <td>M001219</td>
      <td>6.0</td>
      <td>168</td>
      <td>0.035714</td>
    </tr>
    <tr>
      <th>500</th>
      <td>Kimberlyn King-Hinds</td>
      <td>K000404</td>
      <td>0.0</td>
      <td>168</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>520</th>
      <td>Pablo José Hernández Rivera</td>
      <td>H001103</td>
      <td>0.0</td>
      <td>168</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bdb57d23-09f5-4b3f-af4c-4180e56eb2d7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bdb57d23-09f5-4b3f-af4c-4180e56eb2d7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bdb57d23-09f5-4b3f-af4c-4180e56eb2d7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-71c2fc00-ac74-4d72-a737-757567aade3c">
      <button class="colab-df-quickchart" onclick="quickchart('df-71c2fc00-ac74-4d72-a737-757567aade3c')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-71c2fc00-ac74-4d72-a737-757567aade3c button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_f750467b-5a16-4dc4-9de4-436bb45d2c9b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('low_att')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_f750467b-5a16-4dc4-9de4-436bb45d2c9b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('low_att');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: all of the legislators with low attendance are non-voting members from territories, so this makes sense!</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove low‐attendance members from both tables</span>
<span class="n">to_remove</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">low_att</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">])</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="o">~</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">to_remove</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="o">~</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">to_remove</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">house_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># total number of members in the house</span>
<span class="nb">print</span><span class="p">(</span><span class="n">senate_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># total number of members in the senate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>431
100
</pre></div>
</div>
</div>
</div>
<section id="source-a-authors-of-bills-with-cross-party-sponsors">
<h3><strong>Source A: Authors of Bills with Cross-Party Sponsors</strong><a class="headerlink" href="#source-a-authors-of-bills-with-cross-party-sponsors" title="Link to this heading">#</a></h3>
<p>Rewards Members of the 119th U.S. Congress for sponsoring legislation that attracted at least one cosponsor from the opposite party. We take each legislator’s total count of such bills, fill true “no-activity” values with zeros, and convert counts into a 0–100 percentile score.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> OpenStates bill sponsorship CSV for the 119th Congress</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">https://open.pluralpolicy.com/data/session-csv/</a></p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> “Source A – B: Legislator and Sponsorship Data”</p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
A missing count indicates the legislator had <strong>no</strong> cross-party bills. Zero appropriately reflects “no activity,” not unknown data.</p>
</div></blockquote>
<hr class="docutils" />
<section id="load-prepare-source-a">
<h4><strong>Load &amp; Prepare Source A</strong><a class="headerlink" href="#load-prepare-source-a" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only the primary bioguide ID and cross-party bill count</span>
<span class="n">source_A</span> <span class="o">=</span> <span class="n">source_A</span><span class="p">[[</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">{</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">}</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">source_A</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> \
    <span class="s2">&quot;Unexpected columns in source_A&quot;</span>
<span class="n">source_A</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0f5a9438-137e-49d0-ba9a-39262361a735" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_bioguide_id</th>
      <th>num_bills_with_cross_party_cosponsors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>K000367</td>
      <td>51</td>
    </tr>
    <tr>
      <th>1</th>
      <td>C001075</td>
      <td>49</td>
    </tr>
    <tr>
      <th>2</th>
      <td>C001056</td>
      <td>48</td>
    </tr>
    <tr>
      <th>3</th>
      <td>G000386</td>
      <td>43</td>
    </tr>
    <tr>
      <th>4</th>
      <td>F000466</td>
      <td>42</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0f5a9438-137e-49d0-ba9a-39262361a735')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0f5a9438-137e-49d0-ba9a-39262361a735 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0f5a9438-137e-49d0-ba9a-39262361a735');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-9e29bfdb-6fec-418f-8bae-f20675f748d2">
      <button class="colab-df-quickchart" onclick="quickchart('df-9e29bfdb-6fec-418f-8bae-f20675f748d2')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-9e29bfdb-6fec-418f-8bae-f20675f748d2 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="merge-normalize-for-house">
<h4><strong>Merge &amp; Normalize for House</strong><a class="headerlink" href="#merge-normalize-for-house" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final by bioguide_id</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_A</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">:</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">}),</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check raw data to see if true</span>
<span class="n">house_final</span><span class="p">[</span><span class="n">house_final</span><span class="p">[</span>
    <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-df3f6a20-df0d-40b9-865b-8d02a0f18960" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>num_bills_with_cross_party_cosponsors</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>J000299</td>
      <td>Mike Johnson</td>
      <td>Mike</td>
      <td>NaN</td>
      <td>Johnson</td>
      <td>NaN</td>
      <td>House</td>
      <td>Louisiana</td>
      <td>4.0</td>
      <td>Republican</td>
      <td>2017</td>
      <td>NaN</td>
      <td>2025-04-28T13:05:21Z</td>
      <td>https://www.congress.gov/img/member/67ffcb2af2...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>257</th>
      <td>F000110</td>
      <td>Cleo Fields</td>
      <td>Cleo</td>
      <td>NaN</td>
      <td>Fields</td>
      <td>NaN</td>
      <td>House</td>
      <td>Louisiana</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-04-28T13:04:20Z</td>
      <td>https://www.congress.gov/img/member/677426250b...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>258</th>
      <td>H000874</td>
      <td>Steny H. Hoyer</td>
      <td>Steny</td>
      <td>H.</td>
      <td>Hoyer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Maryland</td>
      <td>5.0</td>
      <td>Democratic</td>
      <td>1981</td>
      <td>NaN</td>
      <td>2025-04-28T13:04:20Z</td>
      <td>https://www.congress.gov/img/member/116_rp_md_...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>301</th>
      <td>G000586</td>
      <td>Jesús G. "Chuy" García</td>
      <td>Jesús</td>
      <td>G.</td>
      <td>García</td>
      <td>Chuy</td>
      <td>House</td>
      <td>Illinois</td>
      <td>4.0</td>
      <td>Democratic</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-04-28T13:04:18Z</td>
      <td>https://www.congress.gov/img/member/g000586_20...</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>424</th>
      <td>P000197</td>
      <td>Nancy Pelosi</td>
      <td>Nancy</td>
      <td>NaN</td>
      <td>Pelosi</td>
      <td>NaN</td>
      <td>House</td>
      <td>California</td>
      <td>11.0</td>
      <td>Democratic</td>
      <td>1987</td>
      <td>NaN</td>
      <td>2025-04-28T13:04:14Z</td>
      <td>https://www.congress.gov/img/member/p000197_20...</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-df3f6a20-df0d-40b9-865b-8d02a0f18960')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-df3f6a20-df0d-40b9-865b-8d02a0f18960 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-df3f6a20-df0d-40b9-865b-8d02a0f18960');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-c2b98c7a-12e7-4998-aa1c-7c19c16b689f">
      <button class="colab-df-quickchart" onclick="quickchart('df-c2b98c7a-12e7-4998-aa1c-7c19c16b689f')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-c2b98c7a-12e7-4998-aa1c-7c19c16b689f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Mike Johson (speaker, republican)</p></li>
<li><p>Hakeem Jeffries (democratic minority leader)</p></li>
<li><p>Nancy Pelosi (speaker emerita)
likely are not doing a lot of bill sponsorship in general, so this makes sense</p></li>
<li><p>Steney Hoyer, might be close to retirement, so this makes sense</p></li>
<li><p>Chuy Garcia and Greg Casar very progressive, but still double check</p></li>
<li><p>Cleo Fields worth double checking</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing counts (no cross-party bills) with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span>
    <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span>
<span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize A House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span>


<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_A</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_A</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">mean_A</span><span class="p">,</span> <span class="n">std_A</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Clean up</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f103d1ba-3b7b-47ab-a2a7-06f9c6f0c946" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-07-14T14:25:50Z</td>
      <td>https://www.congress.gov/img/member/677448630b...</td>
      <td>1.0</td>
      <td>20.874310</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-06-13T13:48:04Z</td>
      <td>https://www.congress.gov/img/member/684c235633...</td>
      <td>1.0</td>
      <td>20.874310</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>2024</td>
      <td>NaN</td>
      <td>2025-05-09T13:45:32Z</td>
      <td>https://www.congress.gov/img/member/681dfed94f...</td>
      <td>1.0</td>
      <td>20.874310</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-08T13:36:39Z</td>
      <td>https://www.congress.gov/img/member/681bc0e6b7...</td>
      <td>15.0</td>
      <td>96.832815</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-04-30T18:14:58Z</td>
      <td>https://www.congress.gov/img/member/681231f624...</td>
      <td>2.0</td>
      <td>26.754660</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f103d1ba-3b7b-47ab-a2a7-06f9c6f0c946')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f103d1ba-3b7b-47ab-a2a7-06f9c6f0c946 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f103d1ba-3b7b-47ab-a2a7-06f9c6f0c946');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-15780293-aa82-4f6e-857d-dcf84584714f">
      <button class="colab-df-quickchart" onclick="quickchart('df-15780293-aa82-4f6e-857d-dcf84584714f')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-15780293-aa82-4f6e-857d-dcf84584714f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="merge-normalize-for-senate">
<h4><strong>Merge &amp; Normalize for Senate</strong><a class="headerlink" href="#merge-normalize-for-senate" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate_final by bioguide_id</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_A</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">:</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">}),</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check raw data to see if true</span>
<span class="n">senate_final</span><span class="p">[</span><span class="n">senate_final</span><span class="p">[</span>
    <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-23bdca7d-57ff-4adf-8c2c-7b649f79906f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>num_bills_with_cross_party_cosponsors</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-23bdca7d-57ff-4adf-8c2c-7b649f79906f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-23bdca7d-57ff-4adf-8c2c-7b649f79906f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-23bdca7d-57ff-4adf-8c2c-7b649f79906f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values in Senate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing counts with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span>
    <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span>
<span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize A - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_A</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_A</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_A&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">mean_A</span><span class="p">,</span> <span class="n">std_A</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Drop duplicates and cleanup</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c61a2f46-fadd-4868-aeeb-6db56ae26037" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-06-07T10:30:29Z</td>
      <td>https://www.congress.gov/img/member/677d8231fd...</td>
      <td>6</td>
      <td>24.239891</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2021</td>
      <td>NaN</td>
      <td>2025-06-03T13:18:42Z</td>
      <td>https://www.congress.gov/img/member/l000570_20...</td>
      <td>8</td>
      <td>30.450752</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-28T10:30:24Z</td>
      <td>https://www.congress.gov/img/member/h001089_20...</td>
      <td>13</td>
      <td>48.258655</td>
    </tr>
    <tr>
      <th>4</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-05-24T10:30:30Z</td>
      <td>https://www.congress.gov/img/member/fd3cb364b8...</td>
      <td>15</td>
      <td>55.703808</td>
    </tr>
    <tr>
      <th>5</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-05-17T10:30:27Z</td>
      <td>https://www.congress.gov/img/member/67c8694e61...</td>
      <td>3</td>
      <td>16.371664</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c61a2f46-fadd-4868-aeeb-6db56ae26037')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c61a2f46-fadd-4868-aeeb-6db56ae26037 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c61a2f46-fadd-4868-aeeb-6db56ae26037');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-efd6b7fe-c62d-46cc-ab97-9dc54228686a">
      <button class="colab-df-quickchart" onclick="quickchart('df-efd6b7fe-c62d-46cc-ab97-9dc54228686a')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-efd6b7fe-c62d-46cc-ab97-9dc54228686a button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="source-b-ranked-people-who-cosponsor-bills">
<h3><strong>Source B: Ranked People Who Cosponsor Bills</strong><a class="headerlink" href="#source-b-ranked-people-who-cosponsor-bills" title="Link to this heading">#</a></h3>
<p>This section processes <strong>Source B</strong>, which rewards Members of the 119th U.S. Congress for <strong>cosponsoring</strong> bills authored by another party. We take each legislator’s total count of such cross-party cosponsorships, fill true zero-activity values with zeros, and convert counts into a  0–100 percentile score.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> OpenStates bill sponsorship CSV for the 119th Congress</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">https://open.pluralpolicy.com/data/session-csv/</a></p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> “Source A – B: Legislator and Sponsorship Data”</p></li>
<li><p><strong>Note:</strong> Missing values (no cross-party cosponsorships) are filled with 0</p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
A missing count indicates the legislator did <strong>not</strong> cosponsor any cross-party bills. Zero correctly represents “no activity.”</p>
</div></blockquote>
<hr class="docutils" />
<section id="load-prepare-source-b">
<h4><strong>Load &amp; Prepare Source B</strong><a class="headerlink" href="#load-prepare-source-b" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only bioguide_id and cosponsor count, then copy</span>
<span class="k">assert</span> <span class="p">{</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">}</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">source_B</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> \
    <span class="s2">&quot;Unexpected columns in source_B&quot;</span>
<span class="n">source_B</span> <span class="o">=</span> <span class="n">source_B</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_B</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-aec9bd1d-68c9-4847-97bb-11acd12464f2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>num_cross_party_cosponsored_bills</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>F000466</td>
      <td>433</td>
    </tr>
    <tr>
      <th>1</th>
      <td>D000230</td>
      <td>240</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P000613</td>
      <td>167</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-aec9bd1d-68c9-4847-97bb-11acd12464f2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-aec9bd1d-68c9-4847-97bb-11acd12464f2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-aec9bd1d-68c9-4847-97bb-11acd12464f2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-6dc513e7-4350-4ae7-9926-6ac1cd7ec5b9">
      <button class="colab-df-quickchart" onclick="quickchart('df-6dc513e7-4350-4ae7-9926-6ac1cd7ec5b9')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-6dc513e7-4350-4ae7-9926-6ac1cd7ec5b9 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="id2">
<h4><strong>Merge &amp; Normalize for House</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final by bioguide_id</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_B</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final</span><span class="p">[</span><span class="n">house_final</span><span class="p">[</span>
    <span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-1e6d35fa-a906-4204-89a4-e9718842d13f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>num_cross_party_cosponsored_bills</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1e6d35fa-a906-4204-89a4-e9718842d13f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1e6d35fa-a906-4204-89a4-e9718842d13f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1e6d35fa-a906-4204-89a4-e9718842d13f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for the house</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing counts with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize B - House</span>

<span class="c1"># # Compute CDF percentile</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_B</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_B</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">mean_B</span><span class="p">,</span> <span class="n">std_B</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Clean up raw column</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-8c25c7c7-e1fc-48a9-b6ad-35e9262cdce2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-07-14T14:25:50Z</td>
      <td>https://www.congress.gov/img/member/677448630b...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>6</td>
      <td>27.624352</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-06-13T13:48:04Z</td>
      <td>https://www.congress.gov/img/member/684c235633...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>19</td>
      <td>41.338114</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>2024</td>
      <td>NaN</td>
      <td>2025-05-09T13:45:32Z</td>
      <td>https://www.congress.gov/img/member/681dfed94f...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>17</td>
      <td>39.105279</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-08T13:36:39Z</td>
      <td>https://www.congress.gov/img/member/681bc0e6b7...</td>
      <td>15.0</td>
      <td>96.832815</td>
      <td>73</td>
      <td>90.981076</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-04-30T18:14:58Z</td>
      <td>https://www.congress.gov/img/member/681231f624...</td>
      <td>2.0</td>
      <td>26.754660</td>
      <td>14</td>
      <td>35.824398</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8c25c7c7-e1fc-48a9-b6ad-35e9262cdce2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8c25c7c7-e1fc-48a9-b6ad-35e9262cdce2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8c25c7c7-e1fc-48a9-b6ad-35e9262cdce2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-4712eb3b-6748-48d8-af59-e06c64af1345">
      <button class="colab-df-quickchart" onclick="quickchart('df-4712eb3b-6748-48d8-af59-e06c64af1345')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-4712eb3b-6748-48d8-af59-e06c64af1345 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="id3">
<h4><strong>Merge &amp; Normalize for Senate</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate_final by bioguide_id</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_B</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final</span><span class="p">[</span><span class="n">senate_final</span><span class="p">[</span>
    <span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7eb369f3-f217-4f6a-84af-d21c1eba4615" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>num_cross_party_cosponsored_bills</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7eb369f3-f217-4f6a-84af-d21c1eba4615')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7eb369f3-f217-4f6a-84af-d21c1eba4615 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7eb369f3-f217-4f6a-84af-d21c1eba4615');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for the Senate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing counts with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize B - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span>


<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_B</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_B</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_B&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">mean_B</span><span class="p">,</span> <span class="n">std_B</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Drop duplicate legislators and cleanup</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-cfaad9d7-b9f7-401a-9468-d59fbe97ffb8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-06-07T10:30:29Z</td>
      <td>https://www.congress.gov/img/member/677d8231fd...</td>
      <td>6</td>
      <td>24.239891</td>
      <td>24</td>
      <td>29.006544</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2021</td>
      <td>NaN</td>
      <td>2025-06-03T13:18:42Z</td>
      <td>https://www.congress.gov/img/member/l000570_20...</td>
      <td>8</td>
      <td>30.450752</td>
      <td>57</td>
      <td>75.553948</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-28T10:30:24Z</td>
      <td>https://www.congress.gov/img/member/h001089_20...</td>
      <td>13</td>
      <td>48.258655</td>
      <td>21</td>
      <td>25.257922</td>
    </tr>
    <tr>
      <th>4</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-05-24T10:30:30Z</td>
      <td>https://www.congress.gov/img/member/fd3cb364b8...</td>
      <td>15</td>
      <td>55.703808</td>
      <td>63</td>
      <td>82.080297</td>
    </tr>
    <tr>
      <th>5</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-05-17T10:30:27Z</td>
      <td>https://www.congress.gov/img/member/67c8694e61...</td>
      <td>3</td>
      <td>16.371664</td>
      <td>13</td>
      <td>16.645559</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-cfaad9d7-b9f7-401a-9468-d59fbe97ffb8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-cfaad9d7-b9f7-401a-9468-d59fbe97ffb8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-cfaad9d7-b9f7-401a-9468-d59fbe97ffb8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-8f84768d-2943-4330-b556-f4953ba02017">
      <button class="colab-df-quickchart" onclick="quickchart('df-8f84768d-2943-4330-b556-f4953ba02017')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-8f84768d-2943-4330-b556-f4953ba02017 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="source-c-communication-bipartisanship-sum">
<h3><strong>Source C: Communication – Bipartisanship (Sum)</strong><a class="headerlink" href="#source-c-communication-bipartisanship-sum" title="Link to this heading">#</a></h3>
<p>Rewards Members of the 119th U.S. Congress for communications that support members of the opposite party. We count each legislator’s total <strong>outcome_bipartisanship</strong> flags, fill true zero‐activity with zeros, and convert counts into a 0–100 percentile score.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> American Political Pulse communications CSV (2025 download)</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> (Download “US officials – 2025”)</p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source C–D–E–F: App_Communications_Calculations</em></p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
A missing <code class="docutils literal notranslate"><span class="pre">outcome_bipartisanship</span></code> value means the legislator made <strong>no</strong> bipartisan supportive communications. Zero accurately indicates “none.”</p>
</div></blockquote>
<hr class="docutils" />
<section id="load-prepare-source-c">
<h4><strong>Load &amp; Prepare Source C</strong><a class="headerlink" href="#load-prepare-source-c" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure expected column exists</span>
<span class="k">assert</span> <span class="s1">&#39;outcome_bipartisanship&#39;</span> <span class="ow">in</span> <span class="n">source_APP</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;Missing &#39;outcome_bipartisanship&#39; in source_APP&quot;</span>

<span class="c1"># Subset and copy</span>
<span class="n">source_C</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_C</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-6c8195e5-5f7e-4940-85c2-6c450cd9a834" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>outcome_bipartisanship</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A000055</td>
      <td>10.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A000148</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A000369</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A000370</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A000371</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6c8195e5-5f7e-4940-85c2-6c450cd9a834')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6c8195e5-5f7e-4940-85c2-6c450cd9a834 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6c8195e5-5f7e-4940-85c2-6c450cd9a834');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-4a18529a-1215-4330-bcc3-dab4373126c8">
      <button class="colab-df-quickchart" onclick="quickchart('df-4a18529a-1215-4330-bcc3-dab4373126c8')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-4a18529a-1215-4330-bcc3-dab4373126c8 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_C</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final</span><span class="p">[</span><span class="n">house_final</span><span class="p">[</span>
    <span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c6cf3cf4-bd49-4b03-bc3b-89d6dd8a3e33" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>outcome_bipartisanship</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c6cf3cf4-bd49-4b03-bc3b-89d6dd8a3e33')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c6cf3cf4-bd49-4b03-bc3b-89d6dd8a3e33 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c6cf3cf4-bd49-4b03-bc3b-89d6dd8a3e33');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for house</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize C - House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_C</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_C</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">mean_C</span><span class="p">,</span> <span class="n">std_C</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Drop raw column and remove any duplicates</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-6e9ddb94-2305-486f-a442-0fb4c140c15d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-07-14T14:25:50Z</td>
      <td>https://www.congress.gov/img/member/677448630b...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>6</td>
      <td>27.624352</td>
      <td>2.0</td>
      <td>15.141404</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-06-13T13:48:04Z</td>
      <td>https://www.congress.gov/img/member/684c235633...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>19</td>
      <td>41.338114</td>
      <td>28.0</td>
      <td>39.575556</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>2024</td>
      <td>NaN</td>
      <td>2025-05-09T13:45:32Z</td>
      <td>https://www.congress.gov/img/member/681dfed94f...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>17</td>
      <td>39.105279</td>
      <td>8.0</td>
      <td>19.666071</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-08T13:36:39Z</td>
      <td>https://www.congress.gov/img/member/681bc0e6b7...</td>
      <td>15.0</td>
      <td>96.832815</td>
      <td>73</td>
      <td>90.981076</td>
      <td>60.0</td>
      <td>75.126253</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-04-30T18:14:58Z</td>
      <td>https://www.congress.gov/img/member/681231f624...</td>
      <td>2.0</td>
      <td>26.754660</td>
      <td>14</td>
      <td>35.824398</td>
      <td>36.0</td>
      <td>48.857402</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6e9ddb94-2305-486f-a442-0fb4c140c15d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6e9ddb94-2305-486f-a442-0fb4c140c15d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6e9ddb94-2305-486f-a442-0fb4c140c15d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-1f52c39a-dee7-407d-92f6-82660fa7a439">
      <button class="colab-df-quickchart" onclick="quickchart('df-1f52c39a-dee7-407d-92f6-82660fa7a439')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-1f52c39a-dee7-407d-92f6-82660fa7a439 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="id4">
<h4><strong>Merge &amp; Normalize for Senate</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_C</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final</span><span class="p">[</span><span class="n">senate_final</span><span class="p">[</span>
    <span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-b31e3d5c-e000-482c-93c6-1994ff5aff78" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>outcome_bipartisanship</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b31e3d5c-e000-482c-93c6-1994ff5aff78')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b31e3d5c-e000-482c-93c6-1994ff5aff78 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b31e3d5c-e000-482c-93c6-1994ff5aff78');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for Senate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize C - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_C</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_C</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_C&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">mean_C</span><span class="p">,</span> <span class="n">std_C</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Clean up</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-498e756b-7dad-4a35-a6a7-646edeb7b7f8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>start_year</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-06-07T10:30:29Z</td>
      <td>https://www.congress.gov/img/member/677d8231fd...</td>
      <td>6</td>
      <td>24.239891</td>
      <td>24</td>
      <td>29.006544</td>
      <td>2.0</td>
      <td>11.809128</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2021</td>
      <td>NaN</td>
      <td>2025-06-03T13:18:42Z</td>
      <td>https://www.congress.gov/img/member/l000570_20...</td>
      <td>8</td>
      <td>30.450752</td>
      <td>57</td>
      <td>75.553948</td>
      <td>76.0</td>
      <td>38.604383</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2019</td>
      <td>NaN</td>
      <td>2025-05-28T10:30:24Z</td>
      <td>https://www.congress.gov/img/member/h001089_20...</td>
      <td>13</td>
      <td>48.258655</td>
      <td>21</td>
      <td>25.257922</td>
      <td>9.0</td>
      <td>13.568212</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>2023</td>
      <td>NaN</td>
      <td>2025-05-24T10:30:30Z</td>
      <td>https://www.congress.gov/img/member/fd3cb364b8...</td>
      <td>15</td>
      <td>55.703808</td>
      <td>63</td>
      <td>82.080297</td>
      <td>198.0</td>
      <td>88.214775</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>2025</td>
      <td>NaN</td>
      <td>2025-05-17T10:30:27Z</td>
      <td>https://www.congress.gov/img/member/67c8694e61...</td>
      <td>3</td>
      <td>16.371664</td>
      <td>13</td>
      <td>16.645559</td>
      <td>39.0</td>
      <td>23.052655</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-498e756b-7dad-4a35-a6a7-646edeb7b7f8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-498e756b-7dad-4a35-a6a7-646edeb7b7f8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-498e756b-7dad-4a35-a6a7-646edeb7b7f8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-4eed8ddf-81bf-4fc8-92f3-240566d676b2">
      <button class="colab-df-quickchart" onclick="quickchart('df-4eed8ddf-81bf-4fc8-92f3-240566d676b2')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-4eed8ddf-81bf-4fc8-92f3-240566d676b2 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="source-d-communication-bipartisanship-mean">
<h3><strong>Source D: Communication – Bipartisanship (Mean)</strong><a class="headerlink" href="#source-d-communication-bipartisanship-mean" title="Link to this heading">#</a></h3>
<p>Rewards Members of the 119th U.S. Congress for the <strong>proportion</strong> of their communications that are supportive of the opposite party. We take each legislator’s percentage (<code class="docutils literal notranslate"><span class="pre">outcome_bipartisanship_pct</span></code>), fill true zero‐activity values with zeros, and convert percentages into a percentile score using median &amp; MAD.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> American Political Pulse communications CSV (2025 download)</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> (Download “US officials – 2025”)</p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source C–D–E–F: App_Communications_Calculations</em></p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
A missing percentage means the legislator made no bipartisan communications—zero accurately reflects “none.”</p>
</div></blockquote>
<hr class="docutils" />
<section id="load-prepare-source-d">
<h4><strong>Load &amp; Prepare Source D</strong><a class="headerlink" href="#load-prepare-source-d" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Validate expected column</span>
<span class="k">assert</span> <span class="s1">&#39;outcome_bipartisanship_pct&#39;</span> <span class="ow">in</span> <span class="n">source_APP</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> \
    <span class="s2">&quot;Missing &#39;outcome_bipartisanship_pct&#39; in source_APP&quot;</span>

<span class="c1"># Subset and copy</span>
<span class="n">source_D</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_D</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a0ed2693-9909-47cf-9e5b-88f8a21cc2de" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>outcome_bipartisanship_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A000055</td>
      <td>3.906250</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A000148</td>
      <td>10.963455</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A000369</td>
      <td>6.944444</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A000370</td>
      <td>4.210526</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A000371</td>
      <td>2.439024</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a0ed2693-9909-47cf-9e5b-88f8a21cc2de')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a0ed2693-9909-47cf-9e5b-88f8a21cc2de button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a0ed2693-9909-47cf-9e5b-88f8a21cc2de');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-4f8f5b14-ab53-4bbf-86ed-1b5e20ce5e3f">
      <button class="colab-df-quickchart" onclick="quickchart('df-4f8f5b14-ab53-4bbf-86ed-1b5e20ce5e3f')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-4f8f5b14-ab53-4bbf-86ed-1b5e20ce5e3f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_D</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final</span><span class="p">[</span><span class="n">house_final</span><span class="p">[</span>
    <span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-bd2c7ae3-152f-4a80-91be-1509d0a54056" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>outcome_bipartisanship_pct</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 21 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bd2c7ae3-152f-4a80-91be-1509d0a54056')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bd2c7ae3-152f-4a80-91be-1509d0a54056 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bd2c7ae3-152f-4a80-91be-1509d0a54056');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Note: No missing values for House</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing percentages with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize D - House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_D</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_D</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">mean_D</span><span class="p">,</span> <span class="n">std_D</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Cleanup</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-6e4fc0c9-d669-48c3-9b2d-f5b70243b87e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>...</td>
      <td>2025-07-14T14:25:50Z</td>
      <td>https://www.congress.gov/img/member/677448630b...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>6</td>
      <td>27.624352</td>
      <td>2.0</td>
      <td>15.141404</td>
      <td>4.878049</td>
      <td>43.384639</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>2025-06-13T13:48:04Z</td>
      <td>https://www.congress.gov/img/member/684c235633...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>19</td>
      <td>41.338114</td>
      <td>28.0</td>
      <td>39.575556</td>
      <td>1.842105</td>
      <td>15.378290</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>2025-05-09T13:45:32Z</td>
      <td>https://www.congress.gov/img/member/681dfed94f...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>17</td>
      <td>39.105279</td>
      <td>8.0</td>
      <td>19.666071</td>
      <td>5.095541</td>
      <td>45.801824</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>2025-05-08T13:36:39Z</td>
      <td>https://www.congress.gov/img/member/681bc0e6b7...</td>
      <td>15.0</td>
      <td>96.832815</td>
      <td>73</td>
      <td>90.981076</td>
      <td>60.0</td>
      <td>75.126253</td>
      <td>7.633588</td>
      <td>72.850883</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>2025-04-30T18:14:58Z</td>
      <td>https://www.congress.gov/img/member/681231f624...</td>
      <td>2.0</td>
      <td>26.754660</td>
      <td>14</td>
      <td>35.824398</td>
      <td>36.0</td>
      <td>48.857402</td>
      <td>4.411765</td>
      <td>38.295997</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6e4fc0c9-d669-48c3-9b2d-f5b70243b87e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6e4fc0c9-d669-48c3-9b2d-f5b70243b87e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6e4fc0c9-d669-48c3-9b2d-f5b70243b87e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-b27886d2-309d-4179-953a-55aebe7ad84b">
      <button class="colab-df-quickchart" onclick="quickchart('df-b27886d2-309d-4179-953a-55aebe7ad84b')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-b27886d2-309d-4179-953a-55aebe7ad84b button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="id5">
<h4><strong>Merge &amp; Normalize for Senate</strong><a class="headerlink" href="#id5" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_D</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final</span><span class="p">[</span><span class="n">senate_final</span><span class="p">[</span>
    <span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9d0a3b88-49a0-441b-b19f-c26ef20f8c3e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>end_year</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>outcome_bipartisanship_pct</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 21 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9d0a3b88-49a0-441b-b19f-c26ef20f8c3e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9d0a3b88-49a0-441b-b19f-c26ef20f8c3e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9d0a3b88-49a0-441b-b19f-c26ef20f8c3e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for Senate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing percentages with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize D - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_D</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_D</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_D&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">mean_D</span><span class="p">,</span> <span class="n">std_D</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Cleanup</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-c812c6e3-a3a0-4f75-a7d4-fec61cffc593" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>update_date</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>2025-06-07T10:30:29Z</td>
      <td>https://www.congress.gov/img/member/677d8231fd...</td>
      <td>6</td>
      <td>24.239891</td>
      <td>24</td>
      <td>29.006544</td>
      <td>2.0</td>
      <td>11.809128</td>
      <td>4.000000</td>
      <td>19.172695</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>2025-06-03T13:18:42Z</td>
      <td>https://www.congress.gov/img/member/l000570_20...</td>
      <td>8</td>
      <td>30.450752</td>
      <td>57</td>
      <td>75.553948</td>
      <td>76.0</td>
      <td>38.604383</td>
      <td>6.959707</td>
      <td>47.529597</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>2025-05-28T10:30:24Z</td>
      <td>https://www.congress.gov/img/member/h001089_20...</td>
      <td>13</td>
      <td>48.258655</td>
      <td>21</td>
      <td>25.257922</td>
      <td>9.0</td>
      <td>13.568212</td>
      <td>2.719033</td>
      <td>11.086503</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>2025-05-24T10:30:30Z</td>
      <td>https://www.congress.gov/img/member/fd3cb364b8...</td>
      <td>15</td>
      <td>55.703808</td>
      <td>63</td>
      <td>82.080297</td>
      <td>198.0</td>
      <td>88.214775</td>
      <td>6.954689</td>
      <td>47.474948</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>2025-05-17T10:30:27Z</td>
      <td>https://www.congress.gov/img/member/67c8694e61...</td>
      <td>3</td>
      <td>16.371664</td>
      <td>13</td>
      <td>16.645559</td>
      <td>39.0</td>
      <td>23.052655</td>
      <td>6.280193</td>
      <td>40.213106</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c812c6e3-a3a0-4f75-a7d4-fec61cffc593')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c812c6e3-a3a0-4f75-a7d4-fec61cffc593 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c812c6e3-a3a0-4f75-a7d4-fec61cffc593');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-8a852406-ed06-430d-abe7-80f755896420">
      <button class="colab-df-quickchart" onclick="quickchart('df-8a852406-ed06-430d-abe7-80f755896420')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-8a852406-ed06-430d-abe7-80f755896420 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="source-e-attack-personal-sum">
<h3><strong>Source E: Attack_Personal (Sum)</strong><a class="headerlink" href="#source-e-attack-personal-sum" title="Link to this heading">#</a></h3>
<p>Penalizes Members of the 119th U.S. Congress for communications classified as personal attacks. We count each legislator’s total <strong>attack_personal</strong> flags, fill true zero‐activity values with zeros, and convert into an <strong>inverse</strong> normalized score—higher attack counts yield lower scores.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> American Political Pulse communications CSV (2025 download)</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> (Download “US officials – 2025”)</p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source C–D–E–F: App_Communications_Calculations</em></p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
A missing <code class="docutils literal notranslate"><span class="pre">attack_personal</span></code> means the legislator made <strong>no</strong> personal attacks. Zero accurately represents “none.”</p>
</div></blockquote>
<blockquote>
<div><p><strong>Normalized Score</strong><br />
We apply <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">–</span> <span class="pre">CDF</span></code> so that more attacks → lower percentile score (0–100).</p>
</div></blockquote>
<hr class="docutils" />
<section id="load-prepare-source-e">
<h4><strong>Load &amp; Prepare Source E</strong><a class="headerlink" href="#load-prepare-source-e" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Validate and subset</span>
<span class="k">assert</span> <span class="s1">&#39;attack_personal&#39;</span> <span class="ow">in</span> <span class="n">source_APP</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;Missing &#39;attack_personal&#39; in source_APP&quot;</span>
<span class="n">source_E</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_E</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-966e8e16-fc41-4beb-b84f-59c1a697f01c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>attack_personal</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A000055</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A000148</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A000369</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A000370</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A000371</td>
      <td>4.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-966e8e16-fc41-4beb-b84f-59c1a697f01c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-966e8e16-fc41-4beb-b84f-59c1a697f01c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-966e8e16-fc41-4beb-b84f-59c1a697f01c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-c0ae41aa-3fc9-4197-aed0-ece45c6188d7">
      <button class="colab-df-quickchart" onclick="quickchart('df-c0ae41aa-3fc9-4197-aed0-ece45c6188d7')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-c0ae41aa-3fc9-4197-aed0-ece45c6188d7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="id6">
<h4><strong>Merge &amp; Normalize for House</strong><a class="headerlink" href="#id6" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_E</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final</span><span class="p">[</span><span class="n">house_final</span><span class="p">[</span>
    <span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d7dc9eb9-5802-4192-84dd-676d4171c250" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>attack_personal</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 23 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d7dc9eb9-5802-4192-84dd-676d4171c250')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d7dc9eb9-5802-4192-84dd-676d4171c250 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d7dc9eb9-5802-4192-84dd-676d4171c250');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for House</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing with zero (no personal attacks)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize E - House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;E: attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_E</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_E</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span> <span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">mean_E</span><span class="p">,</span> <span class="n">std_E</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Cleanup</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a31a6e97-1c00-49e6-9370-56b15d5abb25" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>6</td>
      <td>27.624352</td>
      <td>2.0</td>
      <td>15.141404</td>
      <td>4.878049</td>
      <td>43.384639</td>
      <td>0.0</td>
      <td>-26.829767</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>19</td>
      <td>41.338114</td>
      <td>28.0</td>
      <td>39.575556</td>
      <td>1.842105</td>
      <td>15.378290</td>
      <td>117.0</td>
      <td>-97.480720</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>1.0</td>
      <td>20.874310</td>
      <td>17</td>
      <td>39.105279</td>
      <td>8.0</td>
      <td>19.666071</td>
      <td>5.095541</td>
      <td>45.801824</td>
      <td>3.0</td>
      <td>-29.246708</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>15.0</td>
      <td>96.832815</td>
      <td>73</td>
      <td>90.981076</td>
      <td>60.0</td>
      <td>75.126253</td>
      <td>7.633588</td>
      <td>72.850883</td>
      <td>64.0</td>
      <td>-81.068324</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>2.0</td>
      <td>26.754660</td>
      <td>14</td>
      <td>35.824398</td>
      <td>36.0</td>
      <td>48.857402</td>
      <td>4.411765</td>
      <td>38.295997</td>
      <td>12.0</td>
      <td>-36.997215</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a31a6e97-1c00-49e6-9370-56b15d5abb25')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a31a6e97-1c00-49e6-9370-56b15d5abb25 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a31a6e97-1c00-49e6-9370-56b15d5abb25');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-d459d5e9-cdc6-41f4-826b-0ebbafe3da11">
      <button class="colab-df-quickchart" onclick="quickchart('df-d459d5e9-cdc6-41f4-826b-0ebbafe3da11')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-d459d5e9-cdc6-41f4-826b-0ebbafe3da11 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="id7">
<h4><strong>Merge &amp; Normalize for Senate</strong><a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_E</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final</span><span class="p">[</span><span class="n">senate_final</span><span class="p">[</span>
    <span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-853c6357-bffd-4a18-b9b4-c9966bf279b4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>image_url</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>attack_personal</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 23 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-853c6357-bffd-4a18-b9b4-c9966bf279b4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-853c6357-bffd-4a18-b9b4-c9966bf279b4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-853c6357-bffd-4a18-b9b4-c9966bf279b4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for Senate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize E - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;E: attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span>

<span class="n">mean_E</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_E</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_E&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">mean_E</span><span class="p">,</span> <span class="n">std_E</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Cleanup</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9d0cab6e-b2ca-44fe-bf91-a8e3bb2c95a5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>A: num_bills_with_cross_party_cosponsors</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>6</td>
      <td>24.239891</td>
      <td>24</td>
      <td>29.006544</td>
      <td>2.0</td>
      <td>11.809128</td>
      <td>4.000000</td>
      <td>19.172695</td>
      <td>0.0</td>
      <td>-24.963767</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>8</td>
      <td>30.450752</td>
      <td>57</td>
      <td>75.553948</td>
      <td>76.0</td>
      <td>38.604383</td>
      <td>6.959707</td>
      <td>47.529597</td>
      <td>53.0</td>
      <td>-40.802397</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>13</td>
      <td>48.258655</td>
      <td>21</td>
      <td>25.257922</td>
      <td>9.0</td>
      <td>13.568212</td>
      <td>2.719033</td>
      <td>11.086503</td>
      <td>10.0</td>
      <td>-27.708748</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>15</td>
      <td>55.703808</td>
      <td>63</td>
      <td>82.080297</td>
      <td>198.0</td>
      <td>88.214775</td>
      <td>6.954689</td>
      <td>47.474948</td>
      <td>201.0</td>
      <td>-83.489447</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>3</td>
      <td>16.371664</td>
      <td>13</td>
      <td>16.645559</td>
      <td>39.0</td>
      <td>23.052655</td>
      <td>6.280193</td>
      <td>40.213106</td>
      <td>5.0</td>
      <td>-26.319176</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9d0cab6e-b2ca-44fe-bf91-a8e3bb2c95a5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9d0cab6e-b2ca-44fe-bf91-a8e3bb2c95a5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9d0cab6e-b2ca-44fe-bf91-a8e3bb2c95a5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-8ef9fd89-c584-4794-8326-34fe8740ad74">
      <button class="colab-df-quickchart" onclick="quickchart('df-8ef9fd89-c584-4794-8326-34fe8740ad74')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-8ef9fd89-c584-4794-8326-34fe8740ad74 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="source-f-attack-personal-pct">
<h3><strong>Source F: Attack_Personal (Pct)</strong><a class="headerlink" href="#source-f-attack-personal-pct" title="Link to this heading">#</a></h3>
<p>Penalizes Members of the 119th U.S. Congress based on the <strong>percentage</strong> of their communications that are personal attacks. Higher attack rates → lower scores. We fill true zero‐activity with zeros, then apply a normalization.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> American Political Pulse communications CSV (2025 download)</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> (Download “US officials – 2025”)</p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source C–D–E–F: App_Communications_Calculations</em></p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
A missing <code class="docutils literal notranslate"><span class="pre">attack_personal_pct</span></code> means the legislator made <strong>no</strong> personal-attack communications. Zero correctly represents “none.”</p>
</div></blockquote>
<blockquote>
<div><p><strong>Normalization</strong><br />
Using <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">–</span> <span class="pre">CDF</span></code> ensures higher attack rates produce lower percentile scores.</p>
</div></blockquote>
<section id="load-validate-source-f">
<h4><strong>Load &amp; Validate Source F</strong><a class="headerlink" href="#load-validate-source-f" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ensure expected column present</span>
<span class="k">assert</span> <span class="s1">&#39;attack_personal_pct&#39;</span> <span class="ow">in</span> <span class="n">source_APP</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> \
    <span class="s2">&quot;Missing &#39;attack_personal_pct&#39; in source_APP&quot;</span>

<span class="c1"># Subset and copy</span>
<span class="n">source_F</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_F</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-a20dd5f8-c4bd-491d-a016-c264d6549552" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>attack_personal_pct</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A000055</td>
      <td>1.171875</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A000148</td>
      <td>8.416390</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A000369</td>
      <td>0.347222</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A000370</td>
      <td>1.052632</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A000371</td>
      <td>3.252033</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-a20dd5f8-c4bd-491d-a016-c264d6549552')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-a20dd5f8-c4bd-491d-a016-c264d6549552 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-a20dd5f8-c4bd-491d-a016-c264d6549552');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-3e1f7d60-8d72-42b6-ba6f-490df5c5500d">
      <button class="colab-df-quickchart" onclick="quickchart('df-3e1f7d60-8d72-42b6-ba6f-490df5c5500d')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-3e1f7d60-8d72-42b6-ba6f-490df5c5500d button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_F</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final</span><span class="p">[</span><span class="n">house_final</span><span class="p">[</span>
    <span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-894ff6dd-1783-4454-bfb5-f4028692006f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>attack_personal_pct</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 25 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-894ff6dd-1783-4454-bfb5-f4028692006f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-894ff6dd-1783-4454-bfb5-f4028692006f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-894ff6dd-1783-4454-bfb5-f4028692006f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for house</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing with zero (no personal attacks)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize F - House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_F</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_F</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;norm_F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">mean_F</span><span class="p">,</span> <span class="n">std_F</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Cleanup</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">if</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="n">house_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-7821eb3e-49f2-45ad-952b-c5350627e0a4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>...</td>
      <td>6</td>
      <td>27.624352</td>
      <td>2.0</td>
      <td>15.141404</td>
      <td>4.878049</td>
      <td>43.384639</td>
      <td>0.0</td>
      <td>-26.829767</td>
      <td>0.000000</td>
      <td>-18.702124</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>19</td>
      <td>41.338114</td>
      <td>28.0</td>
      <td>39.575556</td>
      <td>1.842105</td>
      <td>15.378290</td>
      <td>117.0</td>
      <td>-97.480720</td>
      <td>7.697368</td>
      <td>-90.663706</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>17</td>
      <td>39.105279</td>
      <td>8.0</td>
      <td>19.666071</td>
      <td>5.095541</td>
      <td>45.801824</td>
      <td>3.0</td>
      <td>-29.246708</td>
      <td>1.910828</td>
      <td>-37.305928</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>73</td>
      <td>90.981076</td>
      <td>60.0</td>
      <td>75.126253</td>
      <td>7.633588</td>
      <td>72.850883</td>
      <td>64.0</td>
      <td>-81.068324</td>
      <td>8.142494</td>
      <td>-92.473988</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>14</td>
      <td>35.824398</td>
      <td>36.0</td>
      <td>48.857402</td>
      <td>4.411765</td>
      <td>38.295997</td>
      <td>12.0</td>
      <td>-36.997215</td>
      <td>1.470588</td>
      <td>-32.531276</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7821eb3e-49f2-45ad-952b-c5350627e0a4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7821eb3e-49f2-45ad-952b-c5350627e0a4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7821eb3e-49f2-45ad-952b-c5350627e0a4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-77443a89-a1ce-42c0-bbe7-01131d53eec5">
      <button class="colab-df-quickchart" onclick="quickchart('df-77443a89-a1ce-42c0-bbe7-01131d53eec5')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-77443a89-a1ce-42c0-bbe7-01131d53eec5 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="id8">
<h4><strong>Merge &amp; Normalize for Senate</strong><a class="headerlink" href="#id8" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_F</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final</span><span class="p">[</span><span class="n">senate_final</span><span class="p">[</span>
    <span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-09c72d37-3e03-49f3-92b1-37892cf02bfa" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>norm_A</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>attack_personal_pct</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
<p>0 rows × 25 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-09c72d37-3e03-49f3-92b1-37892cf02bfa')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-09c72d37-3e03-49f3-92b1-37892cf02bfa button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-09c72d37-3e03-49f3-92b1-37892cf02bfa');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Note: No missing values for Senate</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Normalize F - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span>

<span class="c1"># Recalculate mean and std</span>
<span class="n">mean_F</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_F</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;norm_F&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">mean_F</span><span class="p">,</span> <span class="n">std_F</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Cleanup</span>
<span class="k">if</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">duplicated</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
    <span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-de19c6c5-ffdd-408c-a309-c52fb7adebba" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>B: num_cross_party_cosponsored_bills</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>24</td>
      <td>29.006544</td>
      <td>2.0</td>
      <td>11.809128</td>
      <td>4.000000</td>
      <td>19.172695</td>
      <td>0.0</td>
      <td>-24.963767</td>
      <td>0.000000</td>
      <td>-16.609602</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>57</td>
      <td>75.553948</td>
      <td>76.0</td>
      <td>38.604383</td>
      <td>6.959707</td>
      <td>47.529597</td>
      <td>53.0</td>
      <td>-40.802397</td>
      <td>4.853480</td>
      <td>-54.253098</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>21</td>
      <td>25.257922</td>
      <td>9.0</td>
      <td>13.568212</td>
      <td>2.719033</td>
      <td>11.086503</td>
      <td>10.0</td>
      <td>-27.708748</td>
      <td>3.021148</td>
      <td>-38.395311</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>63</td>
      <td>82.080297</td>
      <td>198.0</td>
      <td>88.214775</td>
      <td>6.954689</td>
      <td>47.474948</td>
      <td>201.0</td>
      <td>-83.489447</td>
      <td>7.060063</td>
      <td>-72.074555</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>13</td>
      <td>16.645559</td>
      <td>39.0</td>
      <td>23.052655</td>
      <td>6.280193</td>
      <td>40.213106</td>
      <td>5.0</td>
      <td>-26.319176</td>
      <td>0.805153</td>
      <td>-21.539411</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-de19c6c5-ffdd-408c-a309-c52fb7adebba')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-de19c6c5-ffdd-408c-a309-c52fb7adebba button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-de19c6c5-ffdd-408c-a309-c52fb7adebba');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-0902060b-8230-4318-8814-6c9172b54323">
      <button class="colab-df-quickchart" onclick="quickchart('df-0902060b-8230-4318-8814-6c9172b54323')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-0902060b-8230-4318-8814-6c9172b54323 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="source-m-cook-political-partisan-voting-index-pvi">
<h3><strong>Source M: Cook Political Partisan Voting Index (PVI)</strong><a class="headerlink" href="#source-m-cook-political-partisan-voting-index-pvi" title="Link to this heading">#</a></h3>
<p>This section processes <strong>Source M</strong>, which captures each district’s partisan lean (Cook PVI) for the 119th Congress. A <strong>higher</strong> PVI number means a stronger lean toward one party; a <strong>lower</strong> PVI indicates a more competitive (centrist) district. We cap the PVI value at 15. If the representative’s party does not match the party of the PVI lean, PVI number is set at 0.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> Cook Political PVI via subscription at <a class="reference external" href="http://cookpolitical.com">cookpolitical.com</a></p></li>
<li><p><strong>Date downloaded:</strong> April, 2025 (this data is updated periodically, not daily)</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source M House &amp; Senate Cook Political PVI</em></p></li>
</ul>
<hr class="docutils" />
<section id="merge-cap-for-house">
<h4><strong>Merge &amp; Cap for House</strong><a class="headerlink" href="#merge-cap-for-house" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify the PVI column</span>
<span class="n">pvi_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">source_M_House</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s2">&quot;PVI_Number&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">pvi_cols</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No PVI number column found in source_M_House: </span><span class="si">{</span><span class="n">source_M_House</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">pvi_col</span> <span class="o">=</span> <span class="n">pvi_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Subset and rename</span>
<span class="n">source_M_h</span> <span class="o">=</span> <span class="n">source_M_House</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">pvi_col</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_M_h</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">pvi_col</span><span class="p">:</span> <span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">source_M_h</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e0ac4a70-3b9a-4222-b7a8-401aa9dbda0b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Cook PVI Raw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>27</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e0ac4a70-3b9a-4222-b7a8-401aa9dbda0b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e0ac4a70-3b9a-4222-b7a8-401aa9dbda0b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e0ac4a70-3b9a-4222-b7a8-401aa9dbda0b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-1b18ff27-3bd0-4af6-b17a-7728f370bbfe">
      <button class="colab-df-quickchart" onclick="quickchart('df-1b18ff27-3bd0-4af6-b17a-7728f370bbfe')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-1b18ff27-3bd0-4af6-b17a-7728f370bbfe button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Caping Value of PVI to pvi_value_cap in bonuses dictionary</span>
<span class="n">pvi_value_cap</span> <span class="o">=</span> <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;pvi_value_cap&#39;</span><span class="p">]</span>

<span class="n">source_M_h</span><span class="p">[</span><span class="n">source_M_h</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pvi_value_cap</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-97948513-093a-4cdd-86b9-4b245ab447d6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Cook PVI Raw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>18</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>17</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>27</td>
    </tr>
    <tr>
      <th>5</th>
      <td>F000477</td>
      <td>23</td>
    </tr>
    <tr>
      <th>6</th>
      <td>T000488</td>
      <td>22</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>424</th>
      <td>P000197</td>
      <td>36</td>
    </tr>
    <tr>
      <th>425</th>
      <td>T000460</td>
      <td>17</td>
    </tr>
    <tr>
      <th>426</th>
      <td>A000055</td>
      <td>33</td>
    </tr>
    <tr>
      <th>429</th>
      <td>M001212</td>
      <td>27</td>
    </tr>
    <tr>
      <th>430</th>
      <td>R000575</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
<p>153 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-97948513-093a-4cdd-86b9-4b245ab447d6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-97948513-093a-4cdd-86b9-4b245ab447d6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-97948513-093a-4cdd-86b9-4b245ab447d6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-bd143aa9-9df6-4470-b25b-fd1e6e9eb96d">
      <button class="colab-df-quickchart" onclick="quickchart('df-bd143aa9-9df6-4470-b25b-fd1e6e9eb96d')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-bd143aa9-9df6-4470-b25b-fd1e6e9eb96d button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_M_h</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_M_h</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pvi_value_cap</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">pvi_value_cap</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># Check</span>
<span class="n">source_M_h</span><span class="p">[</span><span class="n">source_M_h</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pvi_value_cap</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-bbbc9000-9c0f-463c-a3bd-00062f26972f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Cook PVI Raw</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bbbc9000-9c0f-463c-a3bd-00062f26972f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bbbc9000-9c0f-463c-a3bd-00062f26972f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bbbc9000-9c0f-463c-a3bd-00062f26972f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_M_h</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-2779a77d-9f78-4d92-b884-b7976cc3e5be" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>Cook PVI Raw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>...</td>
      <td>27.624352</td>
      <td>2.0</td>
      <td>15.141404</td>
      <td>4.878049</td>
      <td>43.384639</td>
      <td>0.0</td>
      <td>-26.829767</td>
      <td>0.000000</td>
      <td>-18.702124</td>
      <td>15</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>41.338114</td>
      <td>28.0</td>
      <td>39.575556</td>
      <td>1.842105</td>
      <td>15.378290</td>
      <td>117.0</td>
      <td>-97.480720</td>
      <td>7.697368</td>
      <td>-90.663706</td>
      <td>15</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>39.105279</td>
      <td>8.0</td>
      <td>19.666071</td>
      <td>5.095541</td>
      <td>45.801824</td>
      <td>3.0</td>
      <td>-29.246708</td>
      <td>1.910828</td>
      <td>-37.305928</td>
      <td>15</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>90.981076</td>
      <td>60.0</td>
      <td>75.126253</td>
      <td>7.633588</td>
      <td>72.850883</td>
      <td>64.0</td>
      <td>-81.068324</td>
      <td>8.142494</td>
      <td>-92.473988</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>35.824398</td>
      <td>36.0</td>
      <td>48.857402</td>
      <td>4.411765</td>
      <td>38.295997</td>
      <td>12.0</td>
      <td>-36.997215</td>
      <td>1.470588</td>
      <td>-32.531276</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2779a77d-9f78-4d92-b884-b7976cc3e5be')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2779a77d-9f78-4d92-b884-b7976cc3e5be button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2779a77d-9f78-4d92-b884-b7976cc3e5be');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-f26158c5-cb18-4045-b6d3-e95e53b068c5">
      <button class="colab-df-quickchart" onclick="quickchart('df-f26158c5-cb18-4045-b6d3-e95e53b068c5')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-f26158c5-cb18-4045-b6d3-e95e53b068c5 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section id="merge-cap-for-senate">
<h4><strong>Merge &amp; Cap for Senate</strong><a class="headerlink" href="#merge-cap-for-senate" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Identify PVI column in source_M_Senate</span>
<span class="n">pvi_cols_s</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">source_M_Senate</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s2">&quot;PVI_Number&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">pvi_cols_s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No PVI number column found in source_M_Senate: </span><span class="si">{</span><span class="n">source_M_Senate</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">pvi_col_s</span> <span class="o">=</span> <span class="n">pvi_cols_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Subset and rename</span>
<span class="n">source_M_s</span> <span class="o">=</span> <span class="n">source_M_Senate</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">pvi_col_s</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_M_s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">pvi_col_s</span><span class="p">:</span> <span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">source_M_s</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-3b3b30ed-b747-45fb-9034-64f95f346786" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Cook PVI Raw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H001089</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W000800</td>
      <td>17</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001242</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-3b3b30ed-b747-45fb-9034-64f95f346786')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-3b3b30ed-b747-45fb-9034-64f95f346786 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-3b3b30ed-b747-45fb-9034-64f95f346786');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-fe4c09b5-b011-4591-b4fc-978c1617ded5">
      <button class="colab-df-quickchart" onclick="quickchart('df-fe4c09b5-b011-4591-b4fc-978c1617ded5')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-fe4c09b5-b011-4591-b4fc-978c1617ded5 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Caping Value of PVI to pvi_value_cap in bonuses dictionary</span>
<span class="n">pvi_value_cap</span> <span class="o">=</span> <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;pvi_value_cap&#39;</span><span class="p">]</span>

<span class="n">source_M_s</span><span class="p">[</span><span class="n">source_M_s</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pvi_value_cap</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-dbb6144b-80d2-4d05-b50a-4f5fd73e3744" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Cook PVI Raw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>W000800</td>
      <td>17</td>
    </tr>
    <tr>
      <th>40</th>
      <td>R000584</td>
      <td>18</td>
    </tr>
    <tr>
      <th>46</th>
      <td>M001190</td>
      <td>17</td>
    </tr>
    <tr>
      <th>51</th>
      <td>L000571</td>
      <td>23</td>
    </tr>
    <tr>
      <th>58</th>
      <td>L000575</td>
      <td>17</td>
    </tr>
    <tr>
      <th>62</th>
      <td>J000312</td>
      <td>21</td>
    </tr>
    <tr>
      <th>65</th>
      <td>H001061</td>
      <td>18</td>
    </tr>
    <tr>
      <th>82</th>
      <td>C000880</td>
      <td>18</td>
    </tr>
    <tr>
      <th>84</th>
      <td>C001096</td>
      <td>18</td>
    </tr>
    <tr>
      <th>90</th>
      <td>C001047</td>
      <td>21</td>
    </tr>
    <tr>
      <th>96</th>
      <td>B001261</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-dbb6144b-80d2-4d05-b50a-4f5fd73e3744')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-dbb6144b-80d2-4d05-b50a-4f5fd73e3744 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-dbb6144b-80d2-4d05-b50a-4f5fd73e3744');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-d38de668-495a-4f57-8ce4-e93be31f6e06">
      <button class="colab-df-quickchart" onclick="quickchart('df-d38de668-495a-4f57-8ce4-e93be31f6e06')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-d38de668-495a-4f57-8ce4-e93be31f6e06 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_M_s</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_M_s</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pvi_value_cap</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">pvi_value_cap</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># Check</span>
<span class="n">source_M_s</span><span class="p">[</span><span class="n">source_M_s</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">pvi_value_cap</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-088bd2ea-36c3-4188-a123-1be4cefec426" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Cook PVI Raw</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-088bd2ea-36c3-4188-a123-1be4cefec426')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-088bd2ea-36c3-4188-a123-1be4cefec426 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-088bd2ea-36c3-4188-a123-1be4cefec426');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_M_s</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-4b6859bf-476a-4296-a51b-5a36ec28a453" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>norm_B</th>
      <th>C: outcome_bipartisanship</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>Cook PVI Raw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>29.006544</td>
      <td>2.0</td>
      <td>11.809128</td>
      <td>4.000000</td>
      <td>19.172695</td>
      <td>0.0</td>
      <td>-24.963767</td>
      <td>0.000000</td>
      <td>-16.609602</td>
      <td>10</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>75.553948</td>
      <td>76.0</td>
      <td>38.604383</td>
      <td>6.959707</td>
      <td>47.529597</td>
      <td>53.0</td>
      <td>-40.802397</td>
      <td>4.853480</td>
      <td>-54.253098</td>
      <td>4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>25.257922</td>
      <td>9.0</td>
      <td>13.568212</td>
      <td>2.719033</td>
      <td>11.086503</td>
      <td>10.0</td>
      <td>-27.708748</td>
      <td>3.021148</td>
      <td>-38.395311</td>
      <td>9</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>82.080297</td>
      <td>198.0</td>
      <td>88.214775</td>
      <td>6.954689</td>
      <td>47.474948</td>
      <td>201.0</td>
      <td>-83.489447</td>
      <td>7.060063</td>
      <td>-72.074555</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>16.645559</td>
      <td>39.0</td>
      <td>23.052655</td>
      <td>6.280193</td>
      <td>40.213106</td>
      <td>5.0</td>
      <td>-26.319176</td>
      <td>0.805153</td>
      <td>-21.539411</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4b6859bf-476a-4296-a51b-5a36ec28a453')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4b6859bf-476a-4296-a51b-5a36ec28a453 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4b6859bf-476a-4296-a51b-5a36ec28a453');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-516600db-c8e2-459e-8172-f4e45bfd611b">
      <button class="colab-df-quickchart" onclick="quickchart('df-516600db-c8e2-459e-8172-f4e45bfd611b')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-516600db-c8e2-459e-8172-f4e45bfd611b button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="source-n-voteview-member-ideology-score">
<h3><strong>Source N: Voteview Member Ideology Score</strong><a class="headerlink" href="#source-n-voteview-member-ideology-score" title="Link to this heading">#</a></h3>
<p>This section merges pre-computed ideology percentiles into the Bridge Pledge tables. The percentiles measure how far each legislator lies from the partisan center, rewarding those closer to the middle.</p>
<ul class="simple">
<li><p><strong>Data source:</strong> Voteview “Member Ideology” CSV exports (House and Senate, 119th Congress)</p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source N: VoteView Member Ideology Scores.ipynb</em></p></li>
<li><p><strong>Preprocessed outputs:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_n_house_ideology.csv</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_n_senate_ideology.csv</span></code></p></li>
</ul>
</li>
<li><p><strong>Columns:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Nominate_dim1</span></code> (NOMINATE D1 value)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ideology_dist</span></code> (absolute NOMINATE D1 distance)</p></li>
</ul>
</li>
</ul>
<p>We simply merge the final <code class="docutils literal notranslate"><span class="pre">ideology_dist</span></code> as <strong><code class="docutils literal notranslate"><span class="pre">N:</span> <span class="pre">ideology_score</span></code></strong> into our pledge tables for both chambers.</p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Confirm available columns in the preprocessed N files</span>
<span class="nb">print</span><span class="p">(</span><span class="n">source_N_House</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">source_N_Senate</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Name&#39;, &#39;bioguide_id&#39;, &#39;nominate_dim1&#39;, &#39;ideology_dist&#39;], dtype=&#39;object&#39;)
Index([&#39;Name&#39;, &#39;bioguide_id&#39;, &#39;nominate_dim1&#39;, &#39;ideology_dist&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house final</span>
<span class="c1"># Merge only the percentile column</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_N_House</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;ideology_dist&#39;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_N_Senate</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;ideology_dist&#39;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d279bca6-c268-44ff-9064-cfa470c6a83a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>Cook PVI Raw</th>
      <th>nominate_dim1</th>
      <th>ideology_dist</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>...</td>
      <td>15.141404</td>
      <td>4.878049</td>
      <td>43.384639</td>
      <td>0.0</td>
      <td>-26.829767</td>
      <td>0.000000</td>
      <td>-18.702124</td>
      <td>15</td>
      <td>0.468</td>
      <td>0.468</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>39.575556</td>
      <td>1.842105</td>
      <td>15.378290</td>
      <td>117.0</td>
      <td>-97.480720</td>
      <td>7.697368</td>
      <td>-90.663706</td>
      <td>15</td>
      <td>-0.496</td>
      <td>0.496</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>19.666071</td>
      <td>5.095541</td>
      <td>45.801824</td>
      <td>3.0</td>
      <td>-29.246708</td>
      <td>1.910828</td>
      <td>-37.305928</td>
      <td>15</td>
      <td>-0.603</td>
      <td>0.603</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>75.126253</td>
      <td>7.633588</td>
      <td>72.850883</td>
      <td>64.0</td>
      <td>-81.068324</td>
      <td>8.142494</td>
      <td>-92.473988</td>
      <td>6</td>
      <td>-0.259</td>
      <td>0.259</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>48.857402</td>
      <td>4.411765</td>
      <td>38.295997</td>
      <td>12.0</td>
      <td>-36.997215</td>
      <td>1.470588</td>
      <td>-32.531276</td>
      <td>15</td>
      <td>-0.520</td>
      <td>0.520</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d279bca6-c268-44ff-9064-cfa470c6a83a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d279bca6-c268-44ff-9064-cfa470c6a83a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d279bca6-c268-44ff-9064-cfa470c6a83a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-43e7467f-018c-46cd-9508-541ca814e1f3">
      <button class="colab-df-quickchart" onclick="quickchart('df-43e7467f-018c-46cd-9508-541ca814e1f3')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-43e7467f-018c-46cd-9508-541ca814e1f3 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-20b60f33-cdf3-4602-b502-09777aed52f1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>norm_C</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>Cook PVI Raw</th>
      <th>nominate_dim1</th>
      <th>ideology_dist</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S001232</td>
      <td>Tim Sheehy</td>
      <td>Tim</td>
      <td>NaN</td>
      <td>Sheehy</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Montana</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>11.809128</td>
      <td>4.000000</td>
      <td>19.172695</td>
      <td>0.0</td>
      <td>-24.963767</td>
      <td>0.000000</td>
      <td>-16.609602</td>
      <td>10</td>
      <td>0.666</td>
      <td>0.666</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L000570</td>
      <td>Ben Ray Luján</td>
      <td>Ben</td>
      <td>Ray</td>
      <td>Luján</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>New Mexico</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>38.604383</td>
      <td>6.959707</td>
      <td>47.529597</td>
      <td>53.0</td>
      <td>-40.802397</td>
      <td>4.853480</td>
      <td>-54.253098</td>
      <td>4</td>
      <td>-0.378</td>
      <td>0.378</td>
    </tr>
    <tr>
      <th>2</th>
      <td>H001089</td>
      <td>Josh Hawley</td>
      <td>Josh</td>
      <td>NaN</td>
      <td>Hawley</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Missouri</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>13.568212</td>
      <td>2.719033</td>
      <td>11.086503</td>
      <td>10.0</td>
      <td>-27.708748</td>
      <td>3.021148</td>
      <td>-38.395311</td>
      <td>9</td>
      <td>0.832</td>
      <td>0.832</td>
    </tr>
    <tr>
      <th>3</th>
      <td>W000800</td>
      <td>Peter Welch</td>
      <td>Peter</td>
      <td>NaN</td>
      <td>Welch</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>Democratic</td>
      <td>...</td>
      <td>88.214775</td>
      <td>6.954689</td>
      <td>47.474948</td>
      <td>201.0</td>
      <td>-83.489447</td>
      <td>7.060063</td>
      <td>-72.074555</td>
      <td>15</td>
      <td>-0.407</td>
      <td>0.407</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001242</td>
      <td>Bernie Moreno</td>
      <td>Bernie</td>
      <td>NaN</td>
      <td>Moreno</td>
      <td>NaN</td>
      <td>Senate</td>
      <td>Ohio</td>
      <td>NaN</td>
      <td>Republican</td>
      <td>...</td>
      <td>23.052655</td>
      <td>6.280193</td>
      <td>40.213106</td>
      <td>5.0</td>
      <td>-26.319176</td>
      <td>0.805153</td>
      <td>-21.539411</td>
      <td>5</td>
      <td>0.767</td>
      <td>0.767</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-20b60f33-cdf3-4602-b502-09777aed52f1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-20b60f33-cdf3-4602-b502-09777aed52f1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-20b60f33-cdf3-4602-b502-09777aed52f1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-919bcb23-2236-4db2-ba5e-a37754ae29ab">
      <button class="colab-df-quickchart" onclick="quickchart('df-919bcb23-2236-4db2-ba5e-a37754ae29ab')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-919bcb23-2236-4db2-ba5e-a37754ae29ab button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
</section>
</section>
<section id="section-prepare-apply-problem-solvers-caucus-bump">
<h2><strong>Section: Prepare &amp; Apply “Problem Solvers Caucus” Bump</strong><a class="headerlink" href="#section-prepare-apply-problem-solvers-caucus-bump" title="Link to this heading">#</a></h2>
<p>Below we first <strong>export</strong> the hard-coded caucus list to a CSV so it can be maintained externally, then <strong>load</strong> it and apply the bump to both House and Senate tables.</p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### 1. Export Problem Solvers Caucus IDs to CSV</span>

<span class="c1"># Create the hard-coded list of PSC members</span>
<span class="n">problem_solvers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Name&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;Brian Fitzpatrick&#39;</span><span class="p">,</span> <span class="s1">&#39;Tom Suozzi&#39;</span><span class="p">,</span> <span class="s1">&#39;Josh Gottheimer&#39;</span><span class="p">,</span> <span class="s1">&#39;Ed Case&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Nicole Malliotakis&#39;</span><span class="p">,</span> <span class="s1">&#39;Andrew Garbarino&#39;</span><span class="p">,</span> <span class="s1">&#39;Don Bacon&#39;</span><span class="p">,</span> <span class="s1">&#39;Salud Carbajal&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Rob Bresnahan&#39;</span><span class="p">,</span> <span class="s1">&#39;Juan Ciscomani&#39;</span><span class="p">,</span> <span class="s1">&#39;Ben Cline&#39;</span><span class="p">,</span> <span class="s1">&#39;Jim Costa&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Angie Craig&#39;</span><span class="p">,</span> <span class="s1">&#39;Henry Cuellar&#39;</span><span class="p">,</span> <span class="s1">&#39;Don Davis&#39;</span><span class="p">,</span> <span class="s1">&#39;Debbie Dingell&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Chuck Edwards&#39;</span><span class="p">,</span> <span class="s1">&#39;Gabe Evans&#39;</span><span class="p">,</span> <span class="s1">&#39;Marie Gluesenkamp Perez&#39;</span><span class="p">,</span> <span class="s1">&#39;Jared Golden&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Josh Harder&#39;</span><span class="p">,</span> <span class="s1">&#39;Chrissy Houlahan&#39;</span><span class="p">,</span> <span class="s1">&#39;Steven Horsford&#39;</span><span class="p">,</span> <span class="s1">&#39;Greg Landsman&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Susie Lee&#39;</span><span class="p">,</span> <span class="s1">&#39;Donald Norcross&#39;</span><span class="p">,</span> <span class="s1">&#39;Jimmy Panetta&#39;</span><span class="p">,</span> <span class="s1">&#39;Chris Pappas&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Scott Peters&#39;</span><span class="p">,</span> <span class="s1">&#39;Brittany Pettersen&#39;</span><span class="p">,</span> <span class="s1">&#39;Brad Schneider&#39;</span><span class="p">,</span> <span class="s1">&#39;Hillary Scholten&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Darren Soto&#39;</span><span class="p">,</span> <span class="s1">&#39;Haley Stevens&#39;</span><span class="p">,</span> <span class="s1">&#39;Emilia Sykes&#39;</span><span class="p">,</span> <span class="s1">&#39;Dusty Johnson&#39;</span><span class="p">,</span>
        <span class="s1">&#39;David Joyce&#39;</span><span class="p">,</span> <span class="s1">&#39;Thomas Kean Jr.&#39;</span><span class="p">,</span> <span class="s1">&#39;Young Kim&#39;</span><span class="p">,</span> <span class="s1">&#39;Nick LaLota&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Mike Lawler&#39;</span><span class="p">,</span> <span class="s1">&#39;Daniel Meuser&#39;</span><span class="p">,</span> <span class="s1">&#39;Blake Moore&#39;</span><span class="p">,</span> <span class="s1">&#39;James Moylan&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Maria Elvira Salazar&#39;</span><span class="p">,</span> <span class="s1">&#39;Bryan Steil&#39;</span><span class="p">,</span> <span class="s1">&#39;David Valadao&#39;</span><span class="p">,</span><span class="s1">&#39;Jennifer A. Kiggans&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Jeff Hurd&#39;</span>
    <span class="p">],</span>
    <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s1">&#39;F000466&#39;</span><span class="p">,</span> <span class="s1">&#39;S001201&#39;</span><span class="p">,</span> <span class="s1">&#39;G000583&#39;</span><span class="p">,</span> <span class="s1">&#39;C001055&#39;</span><span class="p">,</span>
        <span class="s1">&#39;M000317&#39;</span><span class="p">,</span> <span class="s1">&#39;G000597&#39;</span><span class="p">,</span> <span class="s1">&#39;B001298&#39;</span><span class="p">,</span> <span class="s1">&#39;C001112&#39;</span><span class="p">,</span>
        <span class="s1">&#39;B001327&#39;</span><span class="p">,</span> <span class="s1">&#39;C001133&#39;</span><span class="p">,</span> <span class="s1">&#39;C001118&#39;</span><span class="p">,</span> <span class="s1">&#39;C001059&#39;</span><span class="p">,</span>
        <span class="s1">&#39;C001119&#39;</span><span class="p">,</span> <span class="s1">&#39;C001063&#39;</span><span class="p">,</span> <span class="s1">&#39;D000230&#39;</span><span class="p">,</span> <span class="s1">&#39;D000624&#39;</span><span class="p">,</span>
        <span class="s1">&#39;E000246&#39;</span><span class="p">,</span> <span class="s1">&#39;E000300&#39;</span><span class="p">,</span> <span class="s1">&#39;G000600&#39;</span><span class="p">,</span> <span class="s1">&#39;G000592&#39;</span><span class="p">,</span>
        <span class="s1">&#39;H001090&#39;</span><span class="p">,</span> <span class="s1">&#39;H001085&#39;</span><span class="p">,</span> <span class="s1">&#39;H001066&#39;</span><span class="p">,</span> <span class="s1">&#39;L000601&#39;</span><span class="p">,</span>
        <span class="s1">&#39;L000590&#39;</span><span class="p">,</span> <span class="s1">&#39;N000188&#39;</span><span class="p">,</span> <span class="s1">&#39;P000613&#39;</span><span class="p">,</span> <span class="s1">&#39;P000614&#39;</span><span class="p">,</span>
        <span class="s1">&#39;P000608&#39;</span><span class="p">,</span> <span class="s1">&#39;P000620&#39;</span><span class="p">,</span> <span class="s1">&#39;S001190&#39;</span><span class="p">,</span> <span class="s1">&#39;S001221&#39;</span><span class="p">,</span>
        <span class="s1">&#39;S001200&#39;</span><span class="p">,</span> <span class="s1">&#39;S001215&#39;</span><span class="p">,</span> <span class="s1">&#39;S001223&#39;</span><span class="p">,</span> <span class="s1">&#39;J000301&#39;</span><span class="p">,</span>
        <span class="s1">&#39;J000295&#39;</span><span class="p">,</span> <span class="s1">&#39;K000398&#39;</span><span class="p">,</span> <span class="s1">&#39;K000397&#39;</span><span class="p">,</span> <span class="s1">&#39;L000598&#39;</span><span class="p">,</span>
        <span class="s1">&#39;L000599&#39;</span><span class="p">,</span> <span class="s1">&#39;M001204&#39;</span><span class="p">,</span> <span class="s1">&#39;M001213&#39;</span><span class="p">,</span> <span class="s1">&#39;M001219&#39;</span><span class="p">,</span>
        <span class="s1">&#39;S000168&#39;</span><span class="p">,</span> <span class="s1">&#39;S001213&#39;</span><span class="p">,</span> <span class="s1">&#39;V000129&#39;</span><span class="p">,</span> <span class="s1">&#39;K000399&#39;</span><span class="p">,</span>
        <span class="s1">&#39;H001100&#39;</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1"># Convert to DataFrame and export</span>
<span class="n">ps_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">problem_solvers</span><span class="p">)</span>
<span class="n">ps_df</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span>
    <span class="s1">&#39;/content/drive/MyDrive/Bridge Grades Snapshot August/Data/Source P/problem_solvers.csv&#39;</span><span class="p">,</span>
    <span class="n">index</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="source-p-problem-solvers-caucus-bump">
<h3><strong>Source P: Problem Solvers Caucus “Bump”</strong><a class="headerlink" href="#source-p-problem-solvers-caucus-bump" title="Link to this heading">#</a></h3>
<p>This section applies a fixed points boost to members of the Problem Solvers Caucus (PSC). We load the externally maintained list of PSC bioguide IDs, flag each legislator, and add the configured bonus (<code class="docutils literal notranslate"><span class="pre">ps_score</span></code>) to their pledge score.</p>
<ul class="simple">
<li><p><strong>Data source:</strong> <code class="docutils literal notranslate"><span class="pre">problem_solvers.csv</span></code> (one column: <code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code>), maintained in our data repo. Source: <a class="reference external" href="https://problemsolverscaucus.house.gov/caucus-members">https://problemsolverscaucus.house.gov/caucus-members</a></p></li>
<li><p><strong>Date Updated:</strong> August 8, 2025</p></li>
<li><p><strong>Outputs added:</strong></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">P_flag</span></code> (0 or 1)</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the external CSV of caucus members</span>
<span class="n">psc_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="s1">&#39;/content/drive/MyDrive/Bridge Grades Snapshot August/Data/Source P/problem_solvers.csv&#39;</span>
    <span class="p">)[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">apply_psc_bump</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">id_col</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add PSC bump:</span>
<span class="sd">      - P_flag: 1 if member is in PSC, else 0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;P_flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">id_col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">psc_ids</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for any PSC IDs not present in the House roster</span>
<span class="n">missing_in_house</span> <span class="o">=</span> <span class="n">psc_ids</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">])</span>
<span class="k">if</span> <span class="n">missing_in_house</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: PSC IDs not in House table: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">missing_in_house</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Apply PSC bump to House</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">apply_psc_bump</span><span class="p">(</span><span class="n">house_final</span><span class="p">)</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning: PSC IDs not in House table: [&#39;M001219&#39;]
</pre></div>
</div>
<div class="output text_html">
  <div id="df-1dda67ee-8185-42fe-abf6-2c907e137f31" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>Cook PVI Raw</th>
      <th>nominate_dim1</th>
      <th>ideology_dist</th>
      <th>P_flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>...</td>
      <td>4.878049</td>
      <td>43.384639</td>
      <td>0.0</td>
      <td>-26.829767</td>
      <td>0.000000</td>
      <td>-18.702124</td>
      <td>15</td>
      <td>0.468</td>
      <td>0.468</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>1.842105</td>
      <td>15.378290</td>
      <td>117.0</td>
      <td>-97.480720</td>
      <td>7.697368</td>
      <td>-90.663706</td>
      <td>15</td>
      <td>-0.496</td>
      <td>0.496</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>5.095541</td>
      <td>45.801824</td>
      <td>3.0</td>
      <td>-29.246708</td>
      <td>1.910828</td>
      <td>-37.305928</td>
      <td>15</td>
      <td>-0.603</td>
      <td>0.603</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>7.633588</td>
      <td>72.850883</td>
      <td>64.0</td>
      <td>-81.068324</td>
      <td>8.142494</td>
      <td>-92.473988</td>
      <td>6</td>
      <td>-0.259</td>
      <td>0.259</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>4.411765</td>
      <td>38.295997</td>
      <td>12.0</td>
      <td>-36.997215</td>
      <td>1.470588</td>
      <td>-32.531276</td>
      <td>15</td>
      <td>-0.520</td>
      <td>0.520</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 30 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1dda67ee-8185-42fe-abf6-2c907e137f31')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1dda67ee-8185-42fe-abf6-2c907e137f31 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1dda67ee-8185-42fe-abf6-2c907e137f31');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-6f186629-52c1-4eb0-b324-e9e929f65298">
      <button class="colab-df-quickchart" onclick="quickchart('df-6f186629-52c1-4eb0-b324-e9e929f65298')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-6f186629-52c1-4eb0-b324-e9e929f65298 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### Note: Bioguide &#39;M001219&#39; is James C. Moylan. They are a non-voting member of Guam.</span>
<span class="c1">### Note: Only House members are included in the PSC, so this is not applicable to the Senate.</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s2">&quot;P_flag&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final check of the number of members in the house and senate</span>
<span class="nb">print</span><span class="p">(</span><span class="n">house_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">senate_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>431
100
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="score-calculation-final-grades">
<h2><strong>Score Calculation &amp; Final Grades</strong><a class="headerlink" href="#score-calculation-final-grades" title="Link to this heading">#</a></h2>
<p>In this final phase, we turn each legislator’s normalized source scores into a composite Bridge Grade.  We:</p>
<ol class="arabic simple">
<li><p><strong>Combine</strong> weighted normalized scores from each Source (<code class="docutils literal notranslate"><span class="pre">A</span></code>–<code class="docutils literal notranslate"><span class="pre">F</span></code>).</p></li>
<li><p><strong>Apply</strong> multipliers (<code class="docutils literal notranslate"><span class="pre">M</span></code>, <code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">P</span></code>) on top of the normalized, weighted score.</p></li>
<li><p><strong>Assign</strong> a letter grade (<code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">F</span></code>) based on statistical thresholds (mean ± std and the median).</p></li>
<li><p><strong>Normalize</strong> the combined score to a 0–100 percentile.</p></li>
</ol>
<p>Below are three subsections: building the scoring function, generating &amp; exporting final tables, and visualizing the grade distributions.</p>
<hr class="docutils" />
<section id="build-the-scoring-function">
<h3><strong>Build the Scoring Function</strong><a class="headerlink" href="#build-the-scoring-function" title="Link to this heading">#</a></h3>
<p>We create <code class="docutils literal notranslate"><span class="pre">cal_score()</span></code>, which:</p>
<ul class="simple">
<li><p><strong>Aggregates</strong> <code class="docutils literal notranslate"><span class="pre">norm_{X}</span></code> columns only if they exist in the DataFrame.</p></li>
<li><p><strong>Weights</strong> Assigns the weights.</p></li>
<li><p><strong>Adds</strong>ideology multipliers (<code class="docutils literal notranslate"><span class="pre">M</span></code>, <code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">P</span></code>) safely, with the following formulas:</p>
<ul>
<li><p>bonus_m = [(<code class="docutils literal notranslate"><span class="pre">score_T</span></code>*(1+M)*max_P_bonus_scaling_factor)-<code class="docutils literal notranslate"><span class="pre">score_T</span></code>]</p></li>
<li><p>bonus_n = <code class="docutils literal notranslate"><span class="pre">score_T</span></code>* max_N_bonus_scaling_factor *ideology_dist</p></li>
<li><p>bonus_p = max_P_bonus_scaling_factor* <code class="docutils literal notranslate"><span class="pre">score_T_max</span></code> *P_flag
where <code class="docutils literal notranslate"><span class="pre">score_T_max</span></code> is the max <code class="docutils literal notranslate"><span class="pre">score_T</span></code> across all legislators</p></li>
</ul>
</li>
<li><p>score_U = <code class="docutils literal notranslate"><span class="pre">score_T</span></code> + bonus_m + bonus_n + bonus_p</p></li>
<li><p><strong>Normalizes</strong> the total (<code class="docutils literal notranslate"><span class="pre">score_T</span></code>) via the Normal CDF.</p></li>
<li><p><strong>Assigns</strong> letter grades using:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> if <code class="docutils literal notranslate"><span class="pre">score_U</span> <span class="pre">&gt;</span> <span class="pre">mean</span> <span class="pre">+</span> <span class="pre">std</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> if <code class="docutils literal notranslate"><span class="pre">median</span> <span class="pre">&lt;</span> <span class="pre">score_U</span> <span class="pre">≤</span> <span class="pre">mean</span> <span class="pre">+</span> <span class="pre">std</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code> if <code class="docutils literal notranslate"><span class="pre">mean</span> <span class="pre">-</span> <span class="pre">std</span> <span class="pre">&lt;</span> <span class="pre">score_U</span> <span class="pre">≤</span> <span class="pre">median</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">F</span></code> otherwise</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-0f89a9fc-2c30-4942-a8c8-8fc059119b58" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>bioguide_id</th>
      <th>Name</th>
      <th>first_name</th>
      <th>middle_name</th>
      <th>last_name</th>
      <th>nickname</th>
      <th>Chamber</th>
      <th>State</th>
      <th>District</th>
      <th>Party</th>
      <th>...</th>
      <th>D: outcome_bipartisanship_pct</th>
      <th>norm_D</th>
      <th>E: attack_personal</th>
      <th>norm_E</th>
      <th>F: attack_personal_pct</th>
      <th>norm_F</th>
      <th>Cook PVI Raw</th>
      <th>nominate_dim1</th>
      <th>ideology_dist</th>
      <th>P_flag</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>M001233</td>
      <td>Mark B. Messmer</td>
      <td>Mark</td>
      <td>B.</td>
      <td>Messmer</td>
      <td>NaN</td>
      <td>House</td>
      <td>Indiana</td>
      <td>8.0</td>
      <td>Republican</td>
      <td>...</td>
      <td>4.878049</td>
      <td>43.384639</td>
      <td>0.0</td>
      <td>-26.829767</td>
      <td>0.000000</td>
      <td>-18.702124</td>
      <td>15</td>
      <td>0.468</td>
      <td>0.468</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>R000617</td>
      <td>Delia C. Ramirez</td>
      <td>Delia</td>
      <td>C.</td>
      <td>Ramirez</td>
      <td>NaN</td>
      <td>House</td>
      <td>Illinois</td>
      <td>3.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>1.842105</td>
      <td>15.378290</td>
      <td>117.0</td>
      <td>-97.480720</td>
      <td>7.697368</td>
      <td>-90.663706</td>
      <td>15</td>
      <td>-0.496</td>
      <td>0.496</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>M001229</td>
      <td>LaMonica McIver</td>
      <td>LaMonica</td>
      <td>NaN</td>
      <td>McIver</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>10.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>5.095541</td>
      <td>45.801824</td>
      <td>3.0</td>
      <td>-29.246708</td>
      <td>1.910828</td>
      <td>-37.305928</td>
      <td>15</td>
      <td>-0.603</td>
      <td>0.603</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>H001085</td>
      <td>Chrissy Houlahan</td>
      <td>Chrissy</td>
      <td>NaN</td>
      <td>Houlahan</td>
      <td>NaN</td>
      <td>House</td>
      <td>Pennsylvania</td>
      <td>6.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>7.633588</td>
      <td>72.850883</td>
      <td>64.0</td>
      <td>-81.068324</td>
      <td>8.142494</td>
      <td>-92.473988</td>
      <td>6</td>
      <td>-0.259</td>
      <td>0.259</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M001226</td>
      <td>Robert Menendez</td>
      <td>Robert</td>
      <td>NaN</td>
      <td>Menendez</td>
      <td>NaN</td>
      <td>House</td>
      <td>New Jersey</td>
      <td>8.0</td>
      <td>Democratic</td>
      <td>...</td>
      <td>4.411765</td>
      <td>38.295997</td>
      <td>12.0</td>
      <td>-36.997215</td>
      <td>1.470588</td>
      <td>-32.531276</td>
      <td>15</td>
      <td>-0.520</td>
      <td>0.520</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 30 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0f89a9fc-2c30-4942-a8c8-8fc059119b58')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0f89a9fc-2c30-4942-a8c8-8fc059119b58 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0f89a9fc-2c30-4942-a8c8-8fc059119b58');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-5ce75e2e-ded8-4733-82ef-670fcde393cf">
      <button class="colab-df-quickchart" onclick="quickchart('df-5ce75e2e-ded8-4733-82ef-670fcde393cf')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-5ce75e2e-ded8-4733-82ef-670fcde393cf button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cal_score</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bonuses</span><span class="p">):</span>
    <span class="c1"># Copy the data to avoid modifying the original dataframe</span>
    <span class="n">temp_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Initialize columns</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Calculate &#39;score_T&#39; by adding weighted norm values for each category</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;norm_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>


    <span class="c1"># Calculate scores for ideology multipliers BEFORE the caucus score</span>
    <span class="c1"># Add bonuses</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_M_bonus_scaling_factor&#39;</span><span class="p">]))</span><span class="o">-</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span>


    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_N_bonus_scaling_factor&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;ideology_dist&#39;</span><span class="p">]</span>

    <span class="c1">#the bonuses M and N to 0 if they are negative</span>

    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>


    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
      <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_P_bonus_scaling_factor&#39;</span><span class="p">]</span>
      <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
      <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;P_flag&#39;</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_p&#39;</span><span class="p">]</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_p&#39;</span><span class="p">]</span>

    <span class="c1"># Calculate mean, std, and median of &#39;score_S&#39;</span>
    <span class="n">mean_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">std_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">median_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Normalize &#39;score_U&#39; using the cumulative distribution function (CDF)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">],</span> <span class="n">mean_U</span><span class="p">,</span> <span class="n">std_U</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Define the grade assignment function based on the calculated scores</span>
    <span class="k">def</span> <span class="nf">assign_grade</span><span class="p">(</span><span class="n">grade</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">mean_U</span> <span class="o">+</span> <span class="n">std_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;A&#39;</span>
        <span class="k">elif</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">median_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;B&#39;</span>
        <span class="k">elif</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">mean_U</span> <span class="o">-</span> <span class="n">std_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;C&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;F&#39;</span>

    <span class="c1"># Apply the grade assignment to the &#39;score_S&#39; column</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">assign_grade</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">temp_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final_test</span> <span class="o">=</span> <span class="n">cal_score</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span>  <span class="n">weights</span><span class="p">,</span> <span class="n">bonuses</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0      0
1      0
2      0
3      7
4      0
      ..
426    0
427    0
428    0
429    0
430    0
Name: bonus_p, Length: 431, dtype: int64
650.6490811028898
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>Grade</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>C</th>
      <td>153</td>
    </tr>
    <tr>
      <th>B</th>
      <td>139</td>
    </tr>
    <tr>
      <th>A</th>
      <td>77</td>
    </tr>
    <tr>
      <th>F</th>
      <td>62</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final_test</span> <span class="o">=</span> <span class="n">cal_score</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span>  <span class="n">weights</span><span class="p">,</span> <span class="n">bonuses</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     0
1     0
2     0
3     0
4     0
     ..
95    0
96    0
97    0
98    0
99    0
Name: bonus_p, Length: 100, dtype: int64
623.5370609849944
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final_test</span><span class="p">[</span><span class="s2">&quot;Grade&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>Grade</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>B</th>
      <td>36</td>
    </tr>
    <tr>
      <th>C</th>
      <td>27</td>
    </tr>
    <tr>
      <th>F</th>
      <td>23</td>
    </tr>
    <tr>
      <th>A</th>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div><br><label><b>dtype:</b> int64</label></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">]</span>
<span class="n">hue_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Democratic&#39;</span><span class="p">,</span> <span class="s1">&#39;Republican&#39;</span><span class="p">,</span> <span class="s1">&#39;Independent&#39;</span><span class="p">]</span>

<span class="n">purple_palette</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#4B0082&quot;</span><span class="p">,</span> <span class="s2">&quot;#5D3FD3&quot;</span><span class="p">,</span> <span class="s2">&quot;#7B68EE&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">plot_with_counts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Grade&#39;</span><span class="p">,</span>
        <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="n">purple_palette</span><span class="p">,</span>
        <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
        <span class="n">hue_order</span><span class="o">=</span><span class="n">hue_order</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># Calcular el valor máximo para ajustar el límite superior</span>
    <span class="n">max_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_height</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span>  <span class="c1"># 15% extra arriba</span>

    <span class="c1"># Etiquetas</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span>
            <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># House</span>
<span class="n">plot_with_counts</span><span class="p">(</span><span class="n">house_final_test</span><span class="p">,</span> <span class="s2">&quot;House Bridge Grade Distribution&quot;</span><span class="p">)</span>

<span class="c1"># Senate</span>
<span class="n">plot_with_counts</span><span class="p">(</span><span class="n">senate_final_test</span><span class="p">,</span> <span class="s2">&quot;Senate Bridge Grade Distribution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dbfe7f24a307245041d60d1cd1f971dc7bf279928c606d9d6e981cfcf0d08659.png" src="_images/dbfe7f24a307245041d60d1cd1f971dc7bf279928c606d9d6e981cfcf0d08659.png" />
<img alt="_images/2bb97e1318571e691403afd65f7cc3d347dd0ae4d65f09968e9a09eefa7b7e1d.png" src="_images/2bb97e1318571e691403afd65f7cc3d347dd0ae4d65f09968e9a09eefa7b7e1d.png" />
</div>
</div>
<section id="clean-up-for-final-output">
<h4><strong>Clean up for final output</strong><a class="headerlink" href="#clean-up-for-final-output" title="Link to this heading">#</a></h4>
<section id="party">
<h5><strong>Party</strong><a class="headerlink" href="#party" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># meta_data[&quot;Party&quot;] is R, if the party is Republican, D if Democrat, I if Independent</span>
<span class="n">house_final_test</span><span class="p">[</span><span class="s2">&quot;Party_Abbr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final_test</span><span class="p">[</span><span class="s2">&quot;Party&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="s2">&quot;Republican&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Democratic&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Independent&quot;</span><span class="p">:</span> <span class="s2">&quot;I&quot;</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># meta_data[&quot;Party&quot;] is R, if the party is Republican, D if Democrat, I if Independent</span>
<span class="n">senate_final_test</span><span class="p">[</span><span class="s2">&quot;Party_Abbr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final_test</span><span class="p">[</span><span class="s2">&quot;Party&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="s2">&quot;Republican&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Democratic&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Independent&quot;</span><span class="p">:</span> <span class="s2">&quot;I&quot;</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="district-and-state-district">
<h5><strong>district and state_district</strong><a class="headerlink" href="#district-and-state-district" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># State name → USPS abbreviations</span>

<span class="n">state_abbr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Alabama&#39;</span><span class="p">:</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;Alaska&#39;</span><span class="p">:</span> <span class="s1">&#39;AK&#39;</span><span class="p">,</span> <span class="s1">&#39;Arizona&#39;</span><span class="p">:</span> <span class="s1">&#39;AZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Arkansas&#39;</span><span class="p">:</span> <span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Colorado&#39;</span><span class="p">:</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;Connecticut&#39;</span><span class="p">:</span> <span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="s1">&#39;Delaware&#39;</span><span class="p">:</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="s1">&#39;Florida&#39;</span><span class="p">:</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgia&#39;</span><span class="p">:</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Hawaii&#39;</span><span class="p">:</span> <span class="s1">&#39;HI&#39;</span><span class="p">,</span> <span class="s1">&#39;Idaho&#39;</span><span class="p">:</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Illinois&#39;</span><span class="p">:</span> <span class="s1">&#39;IL&#39;</span><span class="p">,</span> <span class="s1">&#39;Indiana&#39;</span><span class="p">:</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Iowa&#39;</span><span class="p">:</span> <span class="s1">&#39;IA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kansas&#39;</span><span class="p">:</span> <span class="s1">&#39;KS&#39;</span><span class="p">,</span> <span class="s1">&#39;Kentucky&#39;</span><span class="p">:</span> <span class="s1">&#39;KY&#39;</span><span class="p">,</span> <span class="s1">&#39;Louisiana&#39;</span><span class="p">:</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="s1">&#39;Maine&#39;</span><span class="p">:</span> <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;Maryland&#39;</span><span class="p">:</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Massachusetts&#39;</span><span class="p">:</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;Michigan&#39;</span><span class="p">:</span> <span class="s1">&#39;MI&#39;</span><span class="p">,</span> <span class="s1">&#39;Minnesota&#39;</span><span class="p">:</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span> <span class="s1">&#39;Mississippi&#39;</span><span class="p">:</span> <span class="s1">&#39;MS&#39;</span><span class="p">,</span> <span class="s1">&#39;Missouri&#39;</span><span class="p">:</span> <span class="s1">&#39;MO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Montana&#39;</span><span class="p">:</span> <span class="s1">&#39;MT&#39;</span><span class="p">,</span> <span class="s1">&#39;Nebraska&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">:</span> <span class="s1">&#39;NV&#39;</span><span class="p">,</span> <span class="s1">&#39;New Hampshire&#39;</span><span class="p">:</span> <span class="s1">&#39;NH&#39;</span><span class="p">,</span> <span class="s1">&#39;New Jersey&#39;</span><span class="p">:</span> <span class="s1">&#39;NJ&#39;</span><span class="p">,</span>
    <span class="s1">&#39;New Mexico&#39;</span><span class="p">:</span> <span class="s1">&#39;NM&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="s1">&#39;NY&#39;</span><span class="p">,</span> <span class="s1">&#39;North Carolina&#39;</span><span class="p">:</span> <span class="s1">&#39;NC&#39;</span><span class="p">,</span> <span class="s1">&#39;North Dakota&#39;</span><span class="p">:</span> <span class="s1">&#39;ND&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">:</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Oklahoma&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">:</span> <span class="s1">&#39;OR&#39;</span><span class="p">,</span> <span class="s1">&#39;Pennsylvania&#39;</span><span class="p">:</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="s1">&#39;Rhode Island&#39;</span><span class="p">:</span> <span class="s1">&#39;RI&#39;</span><span class="p">,</span> <span class="s1">&#39;South Carolina&#39;</span><span class="p">:</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;South Dakota&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;Tennessee&#39;</span><span class="p">:</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="s1">&#39;TX&#39;</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">:</span> <span class="s1">&#39;UT&#39;</span><span class="p">,</span> <span class="s1">&#39;Vermont&#39;</span><span class="p">:</span> <span class="s1">&#39;VT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Virginia&#39;</span><span class="p">:</span> <span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;Washington&#39;</span><span class="p">:</span> <span class="s1">&#39;WA&#39;</span><span class="p">,</span> <span class="s1">&#39;West Virginia&#39;</span><span class="p">:</span> <span class="s1">&#39;WV&#39;</span><span class="p">,</span> <span class="s1">&#39;Wisconsin&#39;</span><span class="p">:</span> <span class="s1">&#39;WI&#39;</span><span class="p">,</span> <span class="s1">&#39;Wyoming&#39;</span><span class="p">:</span> <span class="s1">&#39;WY&#39;</span><span class="p">,</span> <span class="s1">&#39;District of Columbia&#39;</span><span class="p">:</span><span class="s1">&#39;DC&#39;</span>

<span class="p">}</span>

<span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">state_abbr</span><span class="p">)</span>
<span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">state_abbr</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Build &quot;State_District&quot; key with zero-padded two digits</span>
<span class="k">def</span> <span class="nf">make_sd</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">state_col</span><span class="p">,</span> <span class="n">dist_col</span><span class="p">):</span>

    <span class="c1"># Convert district strings to numeric, default 1 for non‐numeric (at‐large)</span>
    <span class="n">dist_num</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">dist_col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Zero‐pad to two digits</span>
    <span class="n">dist_str</span> <span class="o">=</span> <span class="n">dist_num</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">state_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">dist_str</span>

<span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;District_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_sd</span><span class="p">(</span><span class="n">house_final_test</span><span class="p">,</span>  <span class="s1">&#39;State_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;District&#39;</span><span class="p">)</span>
<span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;District_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of at-large state abbreviations</span>
<span class="n">at_large_states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AK&#39;</span><span class="p">,</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="s1">&#39;ND&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;VT&#39;</span><span class="p">,</span> <span class="s1">&#39;WY&#39;</span><span class="p">]</span>

<span class="c1"># Update District_Abbr only for at-large states</span>
<span class="n">house_final_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">at_large_states</span><span class="p">),</span> <span class="s1">&#39;District_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-AL&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="reorganize-columns">
<h5><strong>Reorganize columns</strong><a class="headerlink" href="#reorganize-columns" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">house_final_test</span><span class="o">=</span><span class="n">house_final_test</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;middle_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span>
       <span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;Chamber&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;District&#39;</span><span class="p">,</span><span class="s1">&#39;District_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="s1">&#39;Party_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;start_year&#39;</span><span class="p">,</span>
       <span class="s1">&#39;end_year&#39;</span><span class="p">,</span> <span class="s1">&#39;update_date&#39;</span><span class="p">,</span> <span class="s1">&#39;image_url&#39;</span><span class="p">,</span>
       <span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_A&#39;</span><span class="p">,</span>
       <span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_B&#39;</span><span class="p">,</span>
       <span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_C&#39;</span><span class="p">,</span> <span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_D&#39;</span><span class="p">,</span> <span class="s1">&#39;E: attack_personal&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_E&#39;</span><span class="p">,</span> <span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_F&#39;</span><span class="p">,</span> <span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">,</span> <span class="s1">&#39;nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;ideology_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;P_flag&#39;</span><span class="p">,</span>
       <span class="s1">&#39;score_T&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_m&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_n&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_p&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_U&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">senate_final_test</span><span class="o">=</span><span class="n">senate_final_test</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;middle_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span>
       <span class="s1">&#39;nickname&#39;</span><span class="p">,</span> <span class="s1">&#39;Chamber&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;District&#39;</span><span class="p">,</span><span class="s1">&#39;District_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="s1">&#39;Party_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;start_year&#39;</span><span class="p">,</span>
       <span class="s1">&#39;end_year&#39;</span><span class="p">,</span> <span class="s1">&#39;update_date&#39;</span><span class="p">,</span> <span class="s1">&#39;image_url&#39;</span><span class="p">,</span>
       <span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_A&#39;</span><span class="p">,</span>
       <span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_B&#39;</span><span class="p">,</span>
       <span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_C&#39;</span><span class="p">,</span> <span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_D&#39;</span><span class="p">,</span> <span class="s1">&#39;E: attack_personal&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_E&#39;</span><span class="p">,</span> <span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">,</span>
       <span class="s1">&#39;norm_F&#39;</span><span class="p">,</span> <span class="s1">&#39;Cook PVI Raw&#39;</span><span class="p">,</span> <span class="s1">&#39;nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;ideology_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;P_flag&#39;</span><span class="p">,</span>
       <span class="s1">&#39;score_T&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_m&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_n&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_p&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_U&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Grade&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Export to Excel</span>
<span class="n">house_final_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;house_scores_119_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">.xlsx&#39;</span><span class="p">,</span>  <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;119 Grades&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">senate_final_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;senate_scores_119_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1">.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;119 Grades&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Source%20N.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Source N: VoteView Member Ideology Scores Processing</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="Suggested_Weights.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Suggested Weights for Bridge Grades System</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#"><strong>Bridge Grades Calculation: Final Bridge Grade Calculation Engine</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources"><strong>Data Sources</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files"><strong>Input Files</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files"><strong>Output Files</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-functions"><strong>Main Functions</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-and-setup"><strong>1. Configuration and Setup</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attendance-filtering"><strong>2. Attendance Filtering</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-integration"><strong>3. Data Source Integration</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-score-calculation"><strong>4. Final Score Calculation</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs"><strong>Outputs</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-datasets"><strong>Final Datasets</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#key-columns-in-output"><strong>Key Columns in Output</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements"><strong>Technical Requirements</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies"><strong>Dependencies</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-processing-notes"><strong>Data Processing Notes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality"><strong>Data Quality</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-checks"><strong>Validation Checks</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-walkthrough-bridge-grades-calculation"><strong>Notebook Walkthrough: Bridge Grades Calculation</strong></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-file-existence-checks"><strong>Configuration &amp; File Existence Checks</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataframes-validate-weights"><strong>Load DataFrames &amp; Validate Weights</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-base-member-tables"><strong>Build Base Member Tables</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>Attendance Filtering</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-a-authors-of-bills-with-cross-party-sponsors"><strong>Source A: Authors of Bills with Cross-Party Sponsors</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-a"><strong>Load &amp; Prepare Source A</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-normalize-for-house"><strong>Merge &amp; Normalize for House</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-normalize-for-senate"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-b-ranked-people-who-cosponsor-bills"><strong>Source B: Ranked People Who Cosponsor Bills</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-b"><strong>Load &amp; Prepare Source B</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Merge &amp; Normalize for House</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-c-communication-bipartisanship-sum"><strong>Source C: Communication – Bipartisanship (Sum)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-c"><strong>Load &amp; Prepare Source C</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-d-communication-bipartisanship-mean"><strong>Source D: Communication – Bipartisanship (Mean)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-d"><strong>Load &amp; Prepare Source D</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-e-attack-personal-sum"><strong>Source E: Attack_Personal (Sum)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-prepare-source-e"><strong>Load &amp; Prepare Source E</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>Merge &amp; Normalize for House</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-f-attack-personal-pct"><strong>Source F: Attack_Personal (Pct)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#load-validate-source-f"><strong>Load &amp; Validate Source F</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Merge &amp; Normalize for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-m-cook-political-partisan-voting-index-pvi"><strong>Source M: Cook Political Partisan Voting Index (PVI)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-cap-for-house"><strong>Merge &amp; Cap for House</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-cap-for-senate"><strong>Merge &amp; Cap for Senate</strong></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-n-voteview-member-ideology-score"><strong>Source N: Voteview Member Ideology Score</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#section-prepare-apply-problem-solvers-caucus-bump"><strong>Section: Prepare &amp; Apply “Problem Solvers Caucus” Bump</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-p-problem-solvers-caucus-bump"><strong>Source P: Problem Solvers Caucus “Bump”</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#score-calculation-final-grades"><strong>Score Calculation &amp; Final Grades</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-scoring-function"><strong>Build the Scoring Function</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-up-for-final-output"><strong>Clean up for final output</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#party"><strong>Party</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#district-and-state-district"><strong>district and state_district</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#reorganize-columns"><strong>Reorganize columns</strong></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bridge Grades Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>