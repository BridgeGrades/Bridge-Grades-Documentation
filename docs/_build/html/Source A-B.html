
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Source A-B: Legislator and Sponsorship Data Processing &#8212; Bridge Grades Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Source A-B';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Source C-D-E-F: App Communications Calculations Data Processing" href="Source%20C-D-E-F.html" />
    <link rel="prev" title="Plural Policy Legislator Data Processing" href="Current_Legislators/get_legislator_info_plural.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-light" alt="Bridge Grades Documentation - Home"/>
    <script>document.write(`<img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-dark" alt="Bridge Grades Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Project%20Explanation.html"><strong>About Bridge Grades Project</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Sources%20of%20Information.html"><strong>Bridge Grades Data Sources</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Current_Legislators/get_current_members.html"><strong>Current Legislators Data Collection: Congress.gov API</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Current_Legislators/get_legislator_info_plural.html"><strong>Plural Policy Legislator Data Processing</strong></a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Source A-B: Legislator and Sponsorship Data Processing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20C-D-E-F.html"><strong>Source C-D-E-F: App Communications Calculations Data Processing</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Source%20M.html"><strong>Source M: Cook Political Partisan Voting Index (PVI) Processing</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Source%20N.html"><strong>Source N: VoteView Member Ideology Scores Processing</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Bridge_Grades_Calculation.html"><strong>Bridge Grades Calculation: Final Bridge Grade Calculation Engine</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Suggested_Weights.html"><strong>Suggested Weights for Bridge Grades System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Next%20Steps.html"><strong>Next Steps</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FSource A-B.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Source A-B.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Source A-B: Legislator and Sponsorship Data Processing</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources"><strong>Data Sources</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files"><strong>Input Files</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-details"><strong>Data Source Details</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs"><strong>Outputs</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-a-authors-of-bills-with-cross-party-sponsors"><strong>Source A: Authors of Bills with Cross Party Sponsors</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-b-ranked-people-who-cosponsor-bills"><strong>Source B: Ranked People who Cosponsor Bills</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements"><strong>Technical Requirements</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies"><strong>Dependencies</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-notes"><strong>Performance Notes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-walkthrough-preprocessing-for-bridge-grades-legislator-and-sponsorship-data"><strong>Notebook Walkthrough: Preprocessing for Bridge Grades: Legislator and Sponsorship Data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-and-prepare-legislator-records"><strong>Filter and Prepare Legislator Records</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-bioguides-to-sponsorships"><strong>Merge bioguides to sponsorships</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#insert-party-and-chamber"><strong>Insert Party and chamber</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-independents"><strong>Check independents</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-cross-party-sponsorship-ranking-source-a"><strong>Construct Cross-Party Sponsorship Ranking (Source A)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#separate-primary-sponsors-and-cosponsors"><strong>Separate primary sponsors and cosponsors</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-cosponsors-with-their-primary-sponsor-and-flag-cross-party-cases"><strong>Merge cosponsors with their primary sponsor and flag cross-party cases</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#count-and-rank-bills-with-cross-party-cosponsors"><strong>Count and rank bills with cross-party cosponsors</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#save-ranked-result-to-csv-files"><strong>Save ranked_result to csv files</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-cross-party-cosponsorship-ranking-source-b"><strong>Construct Cross-Party Cosponsorship Ranking (Source B)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-remove-rows-without-party-affiliation"><strong>Step 1: Remove rows without party affiliation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-join-cosponsors-with-party-of-the-primary-sponsor"><strong>Step 2: Join cosponsors with party of the primary sponsor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-count-and-rank-cross-party-cosponsorships"><strong>Step 3: Count and rank cross-party cosponsorships</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#save-ranked-result-b-to-csv-files"><strong>Save ranked_result_b to csv files</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-summary-of-cross-party-activity-and-data-quality"><strong>Visual Summary of Cross-Party Activity and Data Quality</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="source-a-b-legislator-and-sponsorship-data-processing">
<h1><strong>Source A-B: Legislator and Sponsorship Data Processing</strong><a class="headerlink" href="#source-a-b-legislator-and-sponsorship-data-processing" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Overview</p>
<p>This notebook processes bill sponsorship data from the 119th U.S. Congress to generate two foundational datasets for the Bridge Grades methodology:</p>
<ul class="simple">
<li><p><strong>Source A:</strong> <em>Authors of Bills with Cross Party Sponsors</em> - Ranks legislators by how many of their sponsored bills received bipartisan cosponsorship</p></li>
<li><p><strong>Source B:</strong> <em>Ranked People who Cosponsor Bills</em> - Ranks legislators by how often they cosponsored bills from the opposite party</p></li>
</ul>
<p>These datasets serve as key inputs for computing individual Bridge Grades by analyzing patterns of bipartisan legislative collaboration.</p>
</div>
<section id="data-sources">
<h2><strong>Data Sources</strong><a class="headerlink" href="#data-sources" title="Link to this heading">#</a></h2>
<section id="input-files">
<h3><strong>Input Files</strong><a class="headerlink" href="#input-files" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">US_119_bill_sponsorships.csv</span></code></strong> - Bill sponsorship records from the 119th Congress (Plural Policy)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plural_legislators_retired_with_bioguide.csv</span></code></strong> - Historical legislator biographical data</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">plural_legislators_with_bioguide.csv</span></code></strong> - Current legislator biographical data</p></li>
</ul>
</section>
<section id="data-source-details">
<h3><strong>Data Source Details</strong><a class="headerlink" href="#data-source-details" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Source:</strong> <a class="reference external" href="https://americaspoliticalpulse.com/data/">Plural Policy</a></p></li>
<li><p><strong>Congress:</strong> 119th U.S. Congress</p></li>
<li><p><strong>Download Date:</strong> August 8, 2025</p></li>
<li><p><strong>Coverage:</strong> Bill sponsorship records and biographical details of current and historical legislators</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="outputs">
<h2><strong>Outputs</strong><a class="headerlink" href="#outputs" title="Link to this heading">#</a></h2>
<section id="source-a-authors-of-bills-with-cross-party-sponsors">
<h3><strong>Source A: Authors of Bills with Cross Party Sponsors</strong><a class="headerlink" href="#source-a-authors-of-bills-with-cross-party-sponsors" title="Link to this heading">#</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">bridge_grade_source_a_cross_party_supported_bills.csv</span></code></p>
<p><strong>Columns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">primary_name</span></code>: Name of the primary sponsor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">primary_bioguide_id</span></code>: Unique legislator identifier</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_bills_with_cross_party_cosponsors</span></code>: Count of sponsored bills with bipartisan support</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rank</span></code>: Ranking based on bipartisan support count</p></li>
</ul>
<p><strong>Interpretation:</strong> Higher rankings indicate legislators whose bills attract more cross-party support, suggesting bipartisan appeal.</p>
</section>
<section id="source-b-ranked-people-who-cosponsor-bills">
<h3><strong>Source B: Ranked People who Cosponsor Bills</strong><a class="headerlink" href="#source-b-ranked-people-who-cosponsor-bills" title="Link to this heading">#</a></h3>
<p><strong>File:</strong> <code class="docutils literal notranslate"><span class="pre">bridge_grade_source_b_cross_party_cosponsors.csv</span></code></p>
<p><strong>Columns:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: Name of the cosponsor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code>: Unique legislator identifier</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_cross_party_cosponsored_bills</span></code>: Count of bills cosponsored from opposite party</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rank</span></code>: Ranking based on cross-party cosponsorship count</p></li>
</ul>
<p><strong>Interpretation:</strong> Higher rankings indicate legislators who more actively support legislation from the opposite party, showing bipartisan engagement.</p>
</section>
</section>
<hr class="docutils" />
<section id="technical-requirements">
<h2><strong>Technical Requirements</strong><a class="headerlink" href="#technical-requirements" title="Link to this heading">#</a></h2>
<section id="dependencies">
<h3><strong>Dependencies</strong><a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>: Data manipulation and analysis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rapidfuzz</span></code>: Fuzzy string matching</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tqdm</span></code>: Progress tracking</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plotly.express</span></code>: Data visualization</p></li>
</ul>
</section>
<section id="performance-notes">
<h3><strong>Performance Notes</strong><a class="headerlink" href="#performance-notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Fuzzy matching is computationally intensive but necessary for data quality</p></li>
<li><p>Conservative matching threshold balances accuracy with coverage</p></li>
<li><p>All original records are preserved for transparency</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="notebook-walkthrough-preprocessing-for-bridge-grades-legislator-and-sponsorship-data">
<h2><strong>Notebook Walkthrough: Preprocessing for Bridge Grades: Legislator and Sponsorship Data</strong><a class="headerlink" href="#notebook-walkthrough-preprocessing-for-bridge-grades-legislator-and-sponsorship-data" title="Link to this heading">#</a></h2>
<p>This notebook prepares the input data used to generate two foundational resources in the Bridge Grades methodology:</p>
<ul class="simple">
<li><p><strong>Source A:</strong> <em>Authors of Bills with Cross Party Sponsors</em></p></li>
<li><p><strong>Source B:</strong> <em>Ranked People who Cosponsor Bills</em></p></li>
</ul>
<p>These resources serve as the basis for computing individual Bridge Grades by analyzing patterns of bipartisan legislative collaboration in the U.S. Congress.</p>
<p>The datasets processed here correspond to the <strong>119th U.S. Congress</strong> and were downloaded from the public data portal at <a class="reference external" href="https://americaspoliticalpulse.com/data/">Plural Policy</a>.</p>
<ul class="simple">
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Data includes:</strong> Bill sponsorship records and biographical details of both current and historical legislators.</p></li>
<li><p><strong>Download instructions:</strong></p></li>
</ul>
<ol class="arabic simple">
<li><p>Scroll down to United States on the List (<em>United States 119th Congress</em>). Or download directly <a class="reference external" href="https://data.openstates.org/csv/latest/US_119_csv_2bmRrtyLymbbJfXI2C8Hqz.zip">Here</a>.</p></li>
<li><p>Go to US –&gt; 119 –&gt; US_119_bill_sponsorships.csv</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Install and import required libraries</span>

<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>rapidfuzz<span class="w"> </span>--quiet

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">rapidfuzz</span> <span class="kn">import</span> <span class="n">process</span><span class="p">,</span> <span class="n">fuzz</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment to run from colab in google drive</span>
<span class="c1"># # Load bill sponsorship records (includes both sponsors and cosponsors)</span>
<span class="c1"># sponsorships = pd.read_csv(&#39;/content/drive/MyDrive/Bridge Grades Snapshot August/Data/Source A-B/Input files/US_119_bill_sponsorships.csv&#39;, encoding=&quot;latin1&quot;)</span>

<span class="c1"># # Read in legislators data from plural</span>
<span class="c1"># plural_legislators_current = pd.read_csv(&quot;/content/drive/MyDrive/Bridge Grades Snapshot August/Data/Source A-B/Input files/plural_legislators_with_bioguide.csv&quot;)</span>
<span class="c1"># plural_legislators_retired = pd.read_csv(&quot;/content/drive/MyDrive/Bridge Grades Snapshot August/Data/Source A-B/Input files/plural_legislators_retired_with_bioguide.csv&quot;)</span>

<span class="c1"># #combine retired and current legislators into a single dataframe</span>
<span class="c1"># plural_legislators = pd.concat([plural_legislators_current, plural_legislators_retired])</span>

<span class="c1"># # Drop legislators without a bioguide_id in the plural_legislators file</span>
<span class="c1"># plural_legislators = plural_legislators[plural_legislators[&quot;bioguide_id&quot;].notna()]</span>
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run from local machine</span>
<span class="c1"># Load bill sponsorship records (includes both sponsors and cosponsors)</span>
<span class="n">sponsorships</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../Data/Source A-B/Input files/US_119_bill_sponsorships.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;latin1&quot;</span><span class="p">)</span>

<span class="c1"># Read in legislators data from plural</span>
<span class="n">plural_legislators_current</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Data/Source A-B/Input files/plural_legislators_with_bioguide.csv&quot;</span><span class="p">)</span>
<span class="n">plural_legislators_retired</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;../Data/Source A-B/Input files/plural_legislators_retired_with_bioguide.csv&quot;</span><span class="p">)</span>

<span class="c1">#combine retired and current legislators into a single dataframe</span>
<span class="n">plural_legislators</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">plural_legislators_current</span><span class="p">,</span> <span class="n">plural_legislators_retired</span><span class="p">])</span>

<span class="c1"># Drop legislators without a bioguide_id in the plural_legislators file</span>
<span class="n">plural_legislators</span> <span class="o">=</span> <span class="n">plural_legislators</span><span class="p">[</span><span class="n">plural_legislators</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span>
</pre></div>
</div>
</section>
<section id="filter-and-prepare-legislator-records">
<h2><strong>Filter and Prepare Legislator Records</strong><a class="headerlink" href="#filter-and-prepare-legislator-records" title="Link to this heading">#</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do some variable renaming to facilitate the merge</span>
<span class="n">plural_legislators</span> <span class="o">=</span> <span class="n">plural_legislators</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;person_id&quot;</span><span class="p">})</span> <span class="c1">#rename id to person_id (the column name in sponsorships file)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plural_legislators</span><span class="p">[</span><span class="s2">&quot;party&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Check for missing values in the party column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>party
Republican     360
Democratic     352
Independent      4
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plural_legislators</span><span class="p">[</span><span class="s2">&quot;role_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">dropna</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># Check for missing values in the role_type column</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>role_type
lower    641
upper     75
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a new column in plural_legislators called Chamber that is sen if the role_type is upper and House if the role_type is lower</span>
<span class="n">plural_legislators</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">plural_legislators</span><span class="p">[</span><span class="s2">&quot;role_type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s2">&quot;sen&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;upper&quot;</span> <span class="k">else</span> <span class="s2">&quot;rep&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the values of the type column</span>
<span class="n">plural_legislators</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>type
rep    641
sen     75
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Give a state and district column to the plural_legislators file</span>
<span class="n">us_state_abbrev</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Alabama&#39;</span><span class="p">:</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;Alaska&#39;</span><span class="p">:</span> <span class="s1">&#39;AK&#39;</span><span class="p">,</span> <span class="s1">&#39;Arizona&#39;</span><span class="p">:</span> <span class="s1">&#39;AZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Arkansas&#39;</span><span class="p">:</span> <span class="s1">&#39;AR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39;Colorado&#39;</span><span class="p">:</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;Connecticut&#39;</span><span class="p">:</span> <span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="s1">&#39;Delaware&#39;</span><span class="p">:</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Florida&#39;</span><span class="p">:</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgia&#39;</span><span class="p">:</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span> <span class="s1">&#39;Hawaii&#39;</span><span class="p">:</span> <span class="s1">&#39;HI&#39;</span><span class="p">,</span> <span class="s1">&#39;Idaho&#39;</span><span class="p">:</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Illinois&#39;</span><span class="p">:</span> <span class="s1">&#39;IL&#39;</span><span class="p">,</span> <span class="s1">&#39;Indiana&#39;</span><span class="p">:</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Iowa&#39;</span><span class="p">:</span> <span class="s1">&#39;IA&#39;</span><span class="p">,</span> <span class="s1">&#39;Kansas&#39;</span><span class="p">:</span> <span class="s1">&#39;KS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kentucky&#39;</span><span class="p">:</span> <span class="s1">&#39;KY&#39;</span><span class="p">,</span> <span class="s1">&#39;Louisiana&#39;</span><span class="p">:</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="s1">&#39;Maine&#39;</span><span class="p">:</span> <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;Maryland&#39;</span><span class="p">:</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Massachusetts&#39;</span><span class="p">:</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;Michigan&#39;</span><span class="p">:</span> <span class="s1">&#39;MI&#39;</span><span class="p">,</span> <span class="s1">&#39;Minnesota&#39;</span><span class="p">:</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span> <span class="s1">&#39;Mississippi&#39;</span><span class="p">:</span> <span class="s1">&#39;MS&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Missouri&#39;</span><span class="p">:</span> <span class="s1">&#39;MO&#39;</span><span class="p">,</span> <span class="s1">&#39;Montana&#39;</span><span class="p">:</span> <span class="s1">&#39;MT&#39;</span><span class="p">,</span> <span class="s1">&#39;Nebraska&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">:</span> <span class="s1">&#39;NV&#39;</span><span class="p">,</span>
    <span class="s1">&#39;New Hampshire&#39;</span><span class="p">:</span> <span class="s1">&#39;NH&#39;</span><span class="p">,</span> <span class="s1">&#39;New Jersey&#39;</span><span class="p">:</span> <span class="s1">&#39;NJ&#39;</span><span class="p">,</span> <span class="s1">&#39;New Mexico&#39;</span><span class="p">:</span> <span class="s1">&#39;NM&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="s1">&#39;NY&#39;</span><span class="p">,</span>
    <span class="s1">&#39;North Carolina&#39;</span><span class="p">:</span> <span class="s1">&#39;NC&#39;</span><span class="p">,</span> <span class="s1">&#39;North Dakota&#39;</span><span class="p">:</span> <span class="s1">&#39;ND&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">:</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span> <span class="s1">&#39;Oklahoma&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Oregon&#39;</span><span class="p">:</span> <span class="s1">&#39;OR&#39;</span><span class="p">,</span> <span class="s1">&#39;Pennsylvania&#39;</span><span class="p">:</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="s1">&#39;Rhode Island&#39;</span><span class="p">:</span> <span class="s1">&#39;RI&#39;</span><span class="p">,</span> <span class="s1">&#39;South Carolina&#39;</span><span class="p">:</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;South Dakota&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;Tennessee&#39;</span><span class="p">:</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="s1">&#39;TX&#39;</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">:</span> <span class="s1">&#39;UT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Vermont&#39;</span><span class="p">:</span> <span class="s1">&#39;VT&#39;</span><span class="p">,</span> <span class="s1">&#39;Virginia&#39;</span><span class="p">:</span> <span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;Washington&#39;</span><span class="p">:</span> <span class="s1">&#39;WA&#39;</span><span class="p">,</span> <span class="s1">&#39;West Virginia&#39;</span><span class="p">:</span> <span class="s1">&#39;WV&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Wisconsin&#39;</span><span class="p">:</span> <span class="s1">&#39;WI&#39;</span><span class="p">,</span> <span class="s1">&#39;Wyoming&#39;</span><span class="p">:</span> <span class="s1">&#39;WY&#39;</span>
<span class="p">}</span>
<span class="n">plural_legislators</span> <span class="o">=</span> <span class="n">plural_legislators</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;district&quot;</span><span class="p">:</span> <span class="s2">&quot;compounded_district&quot;</span><span class="p">})</span>
<span class="c1"># Create district and state columns in the plural_legislators file</span>
<span class="k">def</span> <span class="nf">extract_state_and_district</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
    <span class="n">district_val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;compounded_district&quot;</span><span class="p">]</span>
    <span class="n">type_val</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">type_val</span> <span class="o">==</span> <span class="s2">&quot;rep&quot;</span> <span class="ow">and</span> <span class="s2">&quot;-&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">district_val</span><span class="p">):</span>
        <span class="n">state</span><span class="p">,</span> <span class="n">district_number</span> <span class="o">=</span> <span class="n">district_val</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">state</span><span class="p">,</span> <span class="n">district_number</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">type_val</span> <span class="o">==</span> <span class="s2">&quot;sen&quot;</span><span class="p">:</span>
        <span class="c1"># Map full name to abbreviation</span>
        <span class="n">state_abbrev</span> <span class="o">=</span> <span class="n">us_state_abbrev</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">district_val</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">state_abbrev</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply the function to the DataFrame</span>
<span class="n">plural_legislators</span><span class="p">[[</span><span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="s2">&quot;district&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">plural_legislators</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">extract_state_and_district</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="merge-bioguides-to-sponsorships">
<h3><strong>Merge bioguides to sponsorships</strong><a class="headerlink" href="#merge-bioguides-to-sponsorships" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge the sponsorships with the plural legislators to get the bioguide_id into the sponsorships file</span>
<span class="n">sponsorships_with_bioguide</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">sponsorships</span><span class="p">,</span>
    <span class="n">plural_legislators</span><span class="p">[[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">,</span> <span class="s2">&quot;person_id&quot;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;person_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How many records are missing a bioguide_id?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matched: &quot;</span><span class="p">,</span> <span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="c1"># How many records are missing a person_id?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not matched: &quot;</span><span class="p">,</span> <span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matched:  85302
Not matched:  3874
</pre></div>
</div>
</div>
</div>
<p>Now let’s save the non-matched sponsorships and save the unique legislators that were not matched</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">non_matched_sponsorships</span> <span class="o">=</span> <span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="n">unmatched_names</span> <span class="o">=</span> <span class="n">non_matched_sponsorships</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">unmatched_names</span> <span class="o">=</span> <span class="n">unmatched_names</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">unmatched_names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Christopher S. Murphy&#39;,
 &#39;John K. Fetterman&#39;,
 &#39;Ben R. LujÃ¡n&#39;,
 &#39;John F. Reed&#39;,
 &#39;Randy K. Weber&#39;,
 &#39;Mark B. Messmer&#39;,
 &#39;William R. Timmons&#39;,
 &#39;John J. McGuire&#39;,
 &#39;Robert F. Onder&#39;,
 &#39;Addison P. McDowell&#39;,
 &#39;Donald S. Beyer&#39;,
 &#39;Marlin A. Stutzman&#39;,
 &#39;Jennifer A. Kiggans&#39;,
 &#39;Nicholas J. Begich&#39;,
 &#39;Craig A. Goldman&#39;,
 &#39;Riley M. Moore&#39;,
 &#39;Thomas H. Kean&#39;,
 &#39;Eugene Simon Vindman&#39;,
 &#39;Gilbert Ray Cisneros&#39;,
 &#39;Robert P. Bresnahan&#39;,
 &#39;Herbert C. Conaway&#39;,
 &#39;Janelle S. Bynum&#39;,
 &#39;John W. Mannion&#39;,
 &#39;Abraham J. Hamadeh&#39;,
 &#39;Sam T. Liccardo&#39;,
 &#39;David J. Taylor&#39;,
 &#39;Luz M. Rivas&#39;,
 &#39;Pablo Jose HernÃ¡ndez&#39;,
 &#39;Kimberlyn King-Hinds&#39;,
 &#39;Jacklyn Rosen&#39;,
 &#39;Ben R. Lujan&#39;,
 &#39;David McCormick&#39;,
 &#39;J. D. Vance&#39;]
</pre></div>
</div>
</div>
</div>
<p>Here we will use fuzzy matching to get the best matches and then manually check the matches and insert the bioguide_ids manually for more accuracy.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name_df</span> <span class="o">=</span> <span class="n">plural_legislators</span> <span class="c1"># We will see if we can find the bioguide_id from the name column in the plural_legislators file</span>

<span class="c1"># Column in your DataFrame to match against</span>
<span class="n">name_column</span> <span class="o">=</span> <span class="s2">&quot;name&quot;</span>

<span class="c1"># Dictionary to store best matches</span>
<span class="n">best_matches</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">unmatched_names</span><span class="p">:</span>
    <span class="n">match</span><span class="p">,</span> <span class="n">score</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">process</span><span class="o">.</span><span class="n">extractOne</span><span class="p">(</span>
        <span class="n">name</span><span class="p">,</span>
        <span class="n">name_df</span><span class="p">[</span><span class="n">name_column</span><span class="p">],</span>
        <span class="n">scorer</span><span class="o">=</span><span class="n">fuzz</span><span class="o">.</span><span class="n">token_sort_ratio</span>  <span class="c1"># You can experiment with others like fuzz.ratio</span>
    <span class="p">)</span>
    <span class="n">best_matches</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">match</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>

<span class="c1"># Convert to DataFrame for easier viewing</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">match_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span>
    <span class="p">{</span><span class="s2">&quot;unmatched_name&quot;</span><span class="p">:</span> <span class="n">k</span><span class="p">,</span> <span class="s2">&quot;matched_name&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;score&quot;</span><span class="p">:</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">best_matches</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="p">])</span>

<span class="c1"># Optional: Filter for high confidence matches</span>
<span class="n">high_confidence_matches</span> <span class="o">=</span> <span class="n">match_df</span><span class="p">[</span><span class="n">match_df</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">67</span><span class="p">]</span> <span class="c1"># Set the threshold to 67 to get the best matches</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge to get bioguide_ids from name_df</span>
<span class="n">high_confidence_with_bioguide</span> <span class="o">=</span> <span class="n">high_confidence_matches</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">name_df</span><span class="p">[[</span><span class="n">name_column</span><span class="p">,</span> <span class="s2">&quot;bioguide_id&quot;</span><span class="p">]],</span>
    <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;matched_name&quot;</span><span class="p">,</span>
    <span class="n">right_on</span><span class="o">=</span><span class="n">name_column</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
<span class="p">)</span>

<span class="c1"># Optional: drop the duplicate name column</span>
<span class="n">high_confidence_with_bioguide</span> <span class="o">=</span> <span class="n">high_confidence_with_bioguide</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">name_column</span><span class="p">])</span>

<span class="c1"># View the result</span>
<span class="nb">print</span><span class="p">(</span><span class="n">high_confidence_with_bioguide</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>           unmatched_name          matched_name      score bioguide_id
0   Christopher S. Murphy          Chris Murphy  72.727273     M001169
1       John K. Fetterman        John Fetterman  90.322581     F000479
2           Ben R. LujÃ¡n         Ben Ray Luján  76.923077     L000570
3          Randy K. Weber           Randy Weber  88.000000     W000814
4         Mark B. Messmer          Mark Messmer  88.888889     M001233
5      William R. Timmons       William Timmons  90.909091     T000480
6         John J. McGuire          John McGuire  88.888889     M001239
7     Addison P. McDowell      Addison McDowell  91.428571     M001240
8         Donald S. Beyer             Don Beyer  75.000000     B001292
9      Marlin A. Stutzman       Marlin Stutzman  90.909091     S001188
10    Jennifer A. Kiggans           Jen Kiggans  73.333333     K000399
11     Nicholas J. Begich           Nick Begich  68.965517     B001323
12       Craig A. Goldman         Craig Goldman  89.655172     G000601
13         Riley M. Moore           Riley Moore  88.000000     M001235
14         Thomas H. Kean              Tom Kean  72.727273     K000398
15   Eugene Simon Vindman        Eugene Vindman  82.352941     V000138
16   Gilbert Ray Cisneros          Gil Cisneros  75.000000     C001123
17    Robert P. Bresnahan         Rob Bresnahan  81.250000     B001327
18     Herbert C. Conaway          Herb Conaway  80.000000     C001136
19       Janelle S. Bynum         Janelle Bynum  89.655172     B001326
20        John W. Mannion          John Mannion  88.888889     M001231
21     Abraham J. Hamadeh           Abe Hamadeh  68.965517     H001098
22        Sam T. Liccardo          Sam Liccardo  88.888889     L000607
23        David J. Taylor           Dave Taylor  76.923077     T000490
24           Luz M. Rivas             Luz Rivas  85.714286     R000620
25  Pablo Jose HernÃ¡ndez  Pablo José Hernández  87.804878     H001103
26   Kimberlyn King-Hinds        Kim King-Hinds  82.352941     K000404
27          Jacklyn Rosen           Jacky Rosen  91.666667     R000608
28           Ben R. Lujan         Ben Ray Luján  80.000000     L000570
29        David McCormick        Dave McCormick  89.655172     M001243
30            J. D. Vance              JD Vance  73.684211     V000137
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It is very important that you check the resuls above manually and make sure everyone on this list is matched correctly!</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">manual_bioguide_map</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span>
    <span class="n">high_confidence_with_bioguide</span><span class="p">[</span><span class="s2">&quot;unmatched_name&quot;</span><span class="p">],</span>
    <span class="n">high_confidence_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span>
<span class="p">))</span>

<span class="n">manual_bioguide_map</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Christopher S. Murphy&#39;: &#39;M001169&#39;,
 &#39;John K. Fetterman&#39;: &#39;F000479&#39;,
 &#39;Ben R. LujÃ¡n&#39;: &#39;L000570&#39;,
 &#39;Randy K. Weber&#39;: &#39;W000814&#39;,
 &#39;Mark B. Messmer&#39;: &#39;M001233&#39;,
 &#39;William R. Timmons&#39;: &#39;T000480&#39;,
 &#39;John J. McGuire&#39;: &#39;M001239&#39;,
 &#39;Addison P. McDowell&#39;: &#39;M001240&#39;,
 &#39;Donald S. Beyer&#39;: &#39;B001292&#39;,
 &#39;Marlin A. Stutzman&#39;: &#39;S001188&#39;,
 &#39;Jennifer A. Kiggans&#39;: &#39;K000399&#39;,
 &#39;Nicholas J. Begich&#39;: &#39;B001323&#39;,
 &#39;Craig A. Goldman&#39;: &#39;G000601&#39;,
 &#39;Riley M. Moore&#39;: &#39;M001235&#39;,
 &#39;Thomas H. Kean&#39;: &#39;K000398&#39;,
 &#39;Eugene Simon Vindman&#39;: &#39;V000138&#39;,
 &#39;Gilbert Ray Cisneros&#39;: &#39;C001123&#39;,
 &#39;Robert P. Bresnahan&#39;: &#39;B001327&#39;,
 &#39;Herbert C. Conaway&#39;: &#39;C001136&#39;,
 &#39;Janelle S. Bynum&#39;: &#39;B001326&#39;,
 &#39;John W. Mannion&#39;: &#39;M001231&#39;,
 &#39;Abraham J. Hamadeh&#39;: &#39;H001098&#39;,
 &#39;Sam T. Liccardo&#39;: &#39;L000607&#39;,
 &#39;David J. Taylor&#39;: &#39;T000490&#39;,
 &#39;Luz M. Rivas&#39;: &#39;R000620&#39;,
 &#39;Pablo Jose HernÃ¡ndez&#39;: &#39;H001103&#39;,
 &#39;Kimberlyn King-Hinds&#39;: &#39;K000404&#39;,
 &#39;Jacklyn Rosen&#39;: &#39;R000608&#39;,
 &#39;Ben R. Lujan&#39;: &#39;L000570&#39;,
 &#39;David McCormick&#39;: &#39;M001243&#39;,
 &#39;J. D. Vance&#39;: &#39;V000137&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing bioguide_id in sponsorships_with_bioguide</span>
<span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sponsorships_with_bioguide</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">manual_bioguide_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]),</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How many records are missing a bioguide_id?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matched: &quot;</span><span class="p">,</span> <span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not matched: &quot;</span><span class="p">,</span> <span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matched:  88932
Not matched:  244
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s check for the legislators that were not matched, with a score lower than 67</span>
<span class="n">low_confidence_matches</span> <span class="o">=</span> <span class="n">match_df</span><span class="p">[</span><span class="n">match_df</span><span class="p">[</span><span class="s2">&quot;score&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">67</span><span class="p">]</span>
<span class="n">low_confidence_matches</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unmatched_name</th>
      <th>matched_name</th>
      <th>score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3</th>
      <td>John F. Reed</td>
      <td>John Rose</td>
      <td>66.666667</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Robert F. Onder</td>
      <td>Robert Aderholt</td>
      <td>66.666667</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We will now search manually for these legislators in the plural_legislators file and insert the bioguide_ids manually.</p>
<p>Here you can check the list of retired members from OpenStates, and check wikipedia for possible other names.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">manual_bioguide_ids</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;John F. Reed&quot;</span><span class="p">:</span> <span class="s2">&quot;R000122&quot;</span><span class="p">,</span> <span class="c1"># Is listed as Jack Reed but it&#39;s the same person</span>
    <span class="s2">&quot;Robert F. Onder&quot;</span><span class="p">:</span> <span class="s2">&quot;O000177&quot;</span><span class="p">,</span> <span class="c1"># Is listed as Bob Onder but it&#39;s the same person</span>
    <span class="c1"># ... fill in the rest manually</span>
    <span class="c1">#&quot;J. D. Vance&quot;: &quot;V001234&quot;</span>
<span class="p">}</span>

<span class="c1"># Apply the mapping to fill missing bioguide_id</span>
<span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sponsorships_with_bioguide</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">row</span><span class="p">:</span> <span class="n">manual_bioguide_ids</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]),</span>
    <span class="n">axis</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How many records are missing a bioguide_id?</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Matched: &quot;</span><span class="p">,</span> <span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Not matched: &quot;</span><span class="p">,</span> <span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="n">sponsorships_with_bioguide</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Matched:  89176
Not matched:  0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Final dataset is a list of sponsorships with all of the bioguide_id, name, and chamber</span>
<span class="n">sponsorships_with_bioguide</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>entity_type</th>
      <th>organization_id</th>
      <th>person_id</th>
      <th>bill_id</th>
      <th>primary</th>
      <th>classification</th>
      <th>bioguide_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>272e17aa-0d95-48af-aeb0-2b105b35596f</td>
      <td>Cory Booker</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/d0bb2662-40b6-52d2-94e6-2bf9d588c954</td>
      <td>ocd-bill/2b2697ce-cd17-4fd1-ade6-61100214e5a8</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>B001288</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0596b61b-2452-4043-864d-41f62748526a</td>
      <td>Brian Schatz</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/bd24fe60-5756-5d23-bcbf-4734f366c257</td>
      <td>ocd-bill/53dce010-ef5e-4fff-b537-f5d78072da94</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>S001194</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3715e1c7-54a5-441f-b004-fe41d97724be</td>
      <td>Roger F. Wicker</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/8fe2b037-b8ff-5161-9bb4-196e9f1d9dca</td>
      <td>ocd-bill/53dce010-ef5e-4fff-b537-f5d78072da94</td>
      <td>True</td>
      <td>primary</td>
      <td>W000437</td>
    </tr>
    <tr>
      <th>3</th>
      <td>c943434a-5029-49c2-b38b-31b651b7c38c</td>
      <td>Tina Smith</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/f82067c3-a257-54ae-b6bd-ebe5178372e7</td>
      <td>ocd-bill/b3542be0-643b-47a0-af7d-359831b79dc7</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>S001203</td>
    </tr>
    <tr>
      <th>4</th>
      <td>c0c4a9c7-bf64-4ce3-93fb-63335272ef8a</td>
      <td>Jeff Merkley</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/96291b83-ea59-594a-97cf-630189e0b8ed</td>
      <td>ocd-bill/b3542be0-643b-47a0-af7d-359831b79dc7</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>M001176</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="insert-party-and-chamber">
<h3><strong>Insert Party and chamber</strong><a class="headerlink" href="#insert-party-and-chamber" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s use the bioguide_ids to get the party, type, state and districtis from the plural_legislators file via the bioguide_id</span>
<span class="n">merged_sponsorships</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">sponsorships_with_bioguide</span><span class="p">,</span>
    <span class="n">plural_legislators</span><span class="p">[[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">,</span> <span class="s2">&quot;party&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">,</span> <span class="s2">&quot;district&quot;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_sponsorships</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>entity_type</th>
      <th>organization_id</th>
      <th>person_id</th>
      <th>bill_id</th>
      <th>primary</th>
      <th>classification</th>
      <th>bioguide_id</th>
      <th>party</th>
      <th>type</th>
      <th>state</th>
      <th>district</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>272e17aa-0d95-48af-aeb0-2b105b35596f</td>
      <td>Cory Booker</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/d0bb2662-40b6-52d2-94e6-2bf9d588c954</td>
      <td>ocd-bill/2b2697ce-cd17-4fd1-ade6-61100214e5a8</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>B001288</td>
      <td>Democratic</td>
      <td>sen</td>
      <td>NJ</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0596b61b-2452-4043-864d-41f62748526a</td>
      <td>Brian Schatz</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/bd24fe60-5756-5d23-bcbf-4734f366c257</td>
      <td>ocd-bill/53dce010-ef5e-4fff-b537-f5d78072da94</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>S001194</td>
      <td>Democratic</td>
      <td>sen</td>
      <td>HI</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3715e1c7-54a5-441f-b004-fe41d97724be</td>
      <td>Roger F. Wicker</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/8fe2b037-b8ff-5161-9bb4-196e9f1d9dca</td>
      <td>ocd-bill/53dce010-ef5e-4fff-b537-f5d78072da94</td>
      <td>True</td>
      <td>primary</td>
      <td>W000437</td>
      <td>Republican</td>
      <td>rep</td>
      <td>MS</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>c943434a-5029-49c2-b38b-31b651b7c38c</td>
      <td>Tina Smith</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/f82067c3-a257-54ae-b6bd-ebe5178372e7</td>
      <td>ocd-bill/b3542be0-643b-47a0-af7d-359831b79dc7</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>S001203</td>
      <td>Democratic</td>
      <td>sen</td>
      <td>MN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>c0c4a9c7-bf64-4ce3-93fb-63335272ef8a</td>
      <td>Jeff Merkley</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/96291b83-ea59-594a-97cf-630189e0b8ed</td>
      <td>ocd-bill/b3542be0-643b-47a0-af7d-359831b79dc7</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>M001176</td>
      <td>Democratic</td>
      <td>sen</td>
      <td>OR</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>89171</th>
      <td>38397786-595a-4685-9516-6c53777073cb</td>
      <td>Ted Budd</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/67c3f0bb-7182-51b8-98d0-253144992bfe</td>
      <td>ocd-bill/57efa6a1-400d-4ec3-8cf8-5109b4708bd0</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>B001305</td>
      <td>Republican</td>
      <td>rep</td>
      <td>NC</td>
      <td>13</td>
    </tr>
    <tr>
      <th>89172</th>
      <td>4dc9b53c-a378-4c53-a223-ca8a5e126161</td>
      <td>James C. Justice</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/2f9a1274-1a6a-4a78-b253-01ec02f20eee</td>
      <td>ocd-bill/57efa6a1-400d-4ec3-8cf8-5109b4708bd0</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>J000312</td>
      <td>Republican</td>
      <td>sen</td>
      <td>WV</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>89173</th>
      <td>085171c5-5a35-4759-851e-cad314664552</td>
      <td>Pete Ricketts</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/e1b9405a-e695-5bc5-b3b0-6cdc1415f53c</td>
      <td>ocd-bill/57efa6a1-400d-4ec3-8cf8-5109b4708bd0</td>
      <td>False</td>
      <td>cosponsor</td>
      <td>R000618</td>
      <td>Republican</td>
      <td>sen</td>
      <td>NE</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>89174</th>
      <td>a4b34c09-6375-4197-af04-09d53c682006</td>
      <td>Ted Cruz</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/c4d35f64-f25b-5888-9fcb-f3cb97df500e</td>
      <td>ocd-bill/57efa6a1-400d-4ec3-8cf8-5109b4708bd0</td>
      <td>True</td>
      <td>primary</td>
      <td>C001098</td>
      <td>Republican</td>
      <td>sen</td>
      <td>TX</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>89175</th>
      <td>e40b1beb-0049-4128-9d6e-23334f3879bf</td>
      <td>Mike Lee</td>
      <td>person</td>
      <td>NaN</td>
      <td>ocd-person/461257ff-088f-5edd-b342-4652ce1c111f</td>
      <td>ocd-bill/6d5519d3-e11e-4e67-9265-ae194575c0ff</td>
      <td>True</td>
      <td>primary</td>
      <td>L000577</td>
      <td>Republican</td>
      <td>sen</td>
      <td>UT</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>89176 rows × 13 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for missing values on the bioguide_id, type, party, state, and district (if type == &quot;rep&quot;)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="s2">&quot;bioguide_id&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="s2">&quot;party&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="s2">&quot;district&quot;</span><span class="p">][</span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;rep&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
0
0
0
0
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">About merged_sponsorships</p>
<p>The <code class="docutils literal notranslate"><span class="pre">merged_sponsorships</span></code> DataFrame consolidates all sponsorship records from the original dataset (<code class="docutils literal notranslate"><span class="pre">US_119_bill_sponsorships.csv</span></code>) and augments them with legislator information when a match is found.</p>
<p>This dataset includes:</p>
<ul class="simple">
<li><p>The original sponsor and bill information (<code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">bill_id</span></code>, <code class="docutils literal notranslate"><span class="pre">classification</span></code>, etc.).</p></li>
<li><p>Legislator attributes (<code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code>, <code class="docutils literal notranslate"><span class="pre">party</span></code>, <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">state</span></code>, <code class="docutils literal notranslate"><span class="pre">district</span></code>) for matched sponsors.</p></li>
<li><p>All legislators in the sponsorship data should now have a bioguide_id.</p></li>
</ul>
<p>This ensures that <strong>no data is lost</strong>. It serves as the foundational dataset for constructing Source A (<em>Authors of Bills with Cross Party Sponsors</em>) and Source B (<em>Ranked People who Cosponsor Bills</em>) in the Bridge Grades methodology.</p>
</div>
</section>
<section id="check-independents">
<h3><strong>Check independents</strong><a class="headerlink" href="#check-independents" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_sponsorships</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id&#39;, &#39;name&#39;, &#39;entity_type&#39;, &#39;organization_id&#39;, &#39;person_id&#39;, &#39;bill_id&#39;,
       &#39;primary&#39;, &#39;classification&#39;, &#39;bioguide_id&#39;, &#39;party&#39;, &#39;type&#39;, &#39;state&#39;,
       &#39;district&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">]</span><span class="o">==</span> <span class="s1">&#39;Independent&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Bernard Sanders&#39;, &#39;Bernie Sanders&#39;, &#39;Angus S. King&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Check that legislators above aligned with the democratic party before running the code below. These legislators are factually democratic and should not be given rewards for sponsoring with the democratic party. Independents might change in the future, so please revise this part of the code</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_sponsorships</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">merged_sponsorships</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Independent&#39;</span><span class="p">,</span> <span class="s1">&#39;Democratic&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="construct-cross-party-sponsorship-ranking-source-a">
<h2><strong>Construct Cross-Party Sponsorship Ranking (Source A)</strong><a class="headerlink" href="#construct-cross-party-sponsorship-ranking-source-a" title="Link to this heading">#</a></h2>
<p>This section calculates how many bills each primary sponsor introduced that received support from at least one cosponsor of a different political party.</p>
<p>To ensure accurate and complete results:</p>
<ul class="simple">
<li><p>We filter out records without a declared party (required for identifying bipartisan collaboration).</p></li>
<li><p>We validate the structure of sponsorship data, including missing values and unmatched relationships.</p></li>
<li><p>We retain identifiers (<code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code>) for both sponsors and cosponsors, to preserve analytical flexibility.</p></li>
</ul>
<p>The final output ranks each legislator who served as a primary sponsor based on the number of bills they sponsored that attracted cross-party support.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter out rows with missing party information and report exclusion stats</span>
<span class="n">total_records</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged_sponsorships</span><span class="p">)</span>
<span class="n">missing_party</span> <span class="o">=</span> <span class="n">merged_sponsorships</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pct_missing_party</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_party</span> <span class="o">/</span> <span class="n">total_records</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">total_records</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows without party: </span><span class="si">{</span><span class="n">missing_party</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">total_records</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pct_missing_party</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="c1"># Drop rows without party affiliation (cannot evaluate bipartisanship)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">merged_sponsorships</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows without party: 0 of 89176 (0.00%)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>89176
</pre></div>
</div>
</div>
</div>
<section id="separate-primary-sponsors-and-cosponsors">
<h3><strong>Separate primary sponsors and cosponsors</strong><a class="headerlink" href="#separate-primary-sponsors-and-cosponsors" title="Link to this heading">#</a></h3>
<p>We isolate the primary sponsors and cosponsors into two separate DataFrames, ensuring that both include the sponsor name, party, and bioguide ID.</p>
<p>Primary sponsors are then renamed to distinguish them clearly when merged with cosponsor data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select primary sponsors</span>
<span class="n">primary_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;primary&#39;</span><span class="p">][[</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;party&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Select cosponsors (with bioguide_id retained)</span>
<span class="n">cosponsor_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cosponsor&#39;</span><span class="p">][[</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;party&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Rename primary sponsor columns to avoid conflict after merge</span>
<span class="n">primary_df</span> <span class="o">=</span> <span class="n">primary_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;primary_name&#39;</span><span class="p">,</span>
    <span class="s1">&#39;party&#39;</span><span class="p">:</span> <span class="s1">&#39;primary_party&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bioguide_id&#39;</span><span class="p">:</span> <span class="s1">&#39;primary_bioguide_id&#39;</span>
<span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="merge-cosponsors-with-their-primary-sponsor-and-flag-cross-party-cases">
<h3><strong>Merge cosponsors with their primary sponsor and flag cross-party cases</strong><a class="headerlink" href="#merge-cosponsors-with-their-primary-sponsor-and-flag-cross-party-cases" title="Link to this heading">#</a></h3>
<p>Each cosponsor is merged with their bill’s primary sponsor. We validate how many cosponsors are unmatched (bills without a primary sponsor), and we flag cases where the cosponsor and sponsor are from different parties.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge cosponsors with primary sponsors on bill_id</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">cosponsor_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">primary_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Report how many cosponsors are linked to bills without a recorded primary sponsor</span>
<span class="n">no_primary</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">total_cosponsors</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cosponsor_df</span><span class="p">)</span>
<span class="n">pct_no_primary</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_primary</span> <span class="o">/</span> <span class="n">total_cosponsors</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">total_cosponsors</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cosponsors without linked primary sponsor: </span><span class="si">{</span><span class="n">no_primary</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">total_cosponsors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pct_no_primary</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="c1"># Flag whether the cosponsor is from a different party (ignoring rows with missing primary_party)</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;different_party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;primary_party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;primary_party&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cosponsors without linked primary sponsor: 0 of 80345 (0.00%)
</pre></div>
</div>
</div>
</div>
</section>
<section id="count-and-rank-bills-with-cross-party-cosponsors">
<h3><strong>Count and rank bills with cross-party cosponsors</strong><a class="headerlink" href="#count-and-rank-bills-with-cross-party-cosponsors" title="Link to this heading">#</a></h3>
<p>We count the number of bills each primary sponsor introduced that had at least one cross-party cosponsor. Primary sponsors with zero such bills are retained in the ranking with a count of zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get all unique primary sponsors</span>
<span class="n">all_primary_sponsors</span> <span class="o">=</span> <span class="n">primary_df</span><span class="p">[[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span> <span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1"># Identify bills with at least one cross-party cosponsor</span>
<span class="n">bills_with_diff_party</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;different_party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">][</span>
    <span class="p">[</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="s1">&#39;primary_name&#39;</span><span class="p">,</span> <span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1"># Count number of such bills per primary sponsor</span>
<span class="n">cross_party_counts</span> <span class="o">=</span> <span class="n">bills_with_diff_party</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span> <span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">)</span>

<span class="c1"># Merge with all primary sponsors to include those with zero</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">all_primary_sponsors</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">cross_party_counts</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;primary_name&#39;</span><span class="p">,</span> <span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">],</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Sort and rank</span>
<span class="n">ranked_result</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="n">by</span><span class="o">=</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">,</span>
    <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ranked_result</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ranked_result</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># Preview final result</span>
<span class="n">display</span><span class="p">(</span><span class="n">ranked_result</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>primary_name</th>
      <th>primary_bioguide_id</th>
      <th>num_bills_with_cross_party_cosponsors</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Amy Klobuchar</td>
      <td>K000367</td>
      <td>51</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Bill Cassidy</td>
      <td>C001075</td>
      <td>49</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>John Cornyn</td>
      <td>C001056</td>
      <td>48</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Chuck Grassley</td>
      <td>G000386</td>
      <td>43</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Brian K. Fitzpatrick</td>
      <td>F000466</td>
      <td>42</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Marsha Blackburn</td>
      <td>B001243</td>
      <td>41</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Gary Peters</td>
      <td>P000595</td>
      <td>38</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Catherine Cortez Masto</td>
      <td>C001113</td>
      <td>34</td>
      <td>8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Jeanne Shaheen</td>
      <td>S001181</td>
      <td>31</td>
      <td>9</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Zachary Nunn</td>
      <td>N000193</td>
      <td>29</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="save-ranked-result-to-csv-files">
<h4><strong>Save ranked_result to csv files</strong><a class="headerlink" href="#save-ranked-result-to-csv-files" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment to save to google drive</span>
<span class="c1"># ranked_result.to_csv(&quot;/content/drive/MyDrive/Bridge Grades Snapshot August/Data/Source A-B/Output files/bridge_grade_source_a_cross_party_supported_bills.csv&quot;, index=False)</span>

<span class="c1"># Save to local machine</span>
<span class="n">ranked_result</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../Data/Source A-B/Output files/bridge_grade_source_a_cross_party_supported_bills.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="tip admonition">
<p class="admonition-title">About this file</p>
<p>The <code class="docutils literal notranslate"><span class="pre">bridge_grade_source_a_cross_party_supported_bills.csv</span></code> DataFrame contains a ranked list of legislators who served as primary sponsors during the 119th Congress, based on the number of bills they introduced that received support from at least one cosponsor of a different political party.</p>
<p>Each row represents a unique primary sponsor and includes:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">primary_name</span></code>: The name of the primary sponsor.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">primary_bioguide_id</span></code>: A unique identifier for the legislator.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">num_bills_with_cross_party_cosponsors</span></code>: The number of sponsored bills that received cross-party cosponsorship.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rank</span></code>: The sponsor’s rank based on that count (higher values indicate more bipartisan engagement).</p></li>
</ul>
<p>This dataset constitutes <strong>Source A</strong> in the Bridge Grades methodology:<br />
<strong>“Authors of Bills with Cross Party Sponsors”</strong> — a signal of bipartisan openness based on the cosponsorship behavior of others toward the legislator’s initiatives.</p>
</div>
</section>
</section>
</section>
<section id="construct-cross-party-cosponsorship-ranking-source-b">
<h2><strong>Construct Cross-Party Cosponsorship Ranking (Source B)</strong><a class="headerlink" href="#construct-cross-party-cosponsorship-ranking-source-b" title="Link to this heading">#</a></h2>
<p>This section generates a ranking of legislators based on the number of bills they <strong>cosponsored</strong> where the <strong>primary sponsor was from a different political party</strong>.</p>
<p>The output represents <strong>Source B</strong> in the Bridge Grades methodology:</p>
<blockquote>
<div><p>“Ranked People who Cosponsor Bills” — a measure of bipartisan engagement based on a legislator’s willingness to support legislation authored by the opposing party.</p>
</div></blockquote>
<p>The data used here comes from the <code class="docutils literal notranslate"><span class="pre">merged_sponsorships</span></code> DataFrame produced earlier in this notebook.</p>
<section id="step-1-remove-rows-without-party-affiliation">
<h3><strong>Step 1: Remove rows without party affiliation</strong><a class="headerlink" href="#step-1-remove-rows-without-party-affiliation" title="Link to this heading">#</a></h3>
<p>Cosponsorship records without party information cannot be used to assess bipartisan behavior. We remove these rows and report how many are excluded.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count and drop rows with missing party</span>
<span class="n">total_rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">merged_sponsorships</span><span class="p">)</span>
<span class="n">missing_party_count</span> <span class="o">=</span> <span class="n">merged_sponsorships</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">pct_missing</span> <span class="o">=</span> <span class="p">(</span><span class="n">missing_party_count</span> <span class="o">/</span> <span class="n">total_rows</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">total_rows</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Rows without party: </span><span class="si">{</span><span class="n">missing_party_count</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">total_rows</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pct_missing</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">merged_sponsorships</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows without party: 0 of 89176 (0.00%)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-join-cosponsors-with-party-of-the-primary-sponsor">
<h3><strong>Step 2: Join cosponsors with party of the primary sponsor</strong><a class="headerlink" href="#step-2-join-cosponsors-with-party-of-the-primary-sponsor" title="Link to this heading">#</a></h3>
<p>We isolate primary sponsors and cosponsors, then merge cosponsors with the party of the legislator who introduced the bill. We also check if any cosponsor entries cannot be linked to a primary sponsor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get party of bill authors (primary sponsors)</span>
<span class="n">primary_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;primary&#39;</span><span class="p">][[</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="s1">&#39;party&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">primary_df</span> <span class="o">=</span> <span class="n">primary_df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;party&#39;</span><span class="p">:</span> <span class="s1">&#39;primary_party&#39;</span><span class="p">})</span>

<span class="c1"># Get cosponsor records with identifying information</span>
<span class="n">cosponsor_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;classification&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;cosponsor&#39;</span><span class="p">][[</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;party&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Merge cosponsors with primary sponsor party</span>
<span class="n">merged_df</span> <span class="o">=</span> <span class="n">cosponsor_df</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">primary_df</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bill_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Report cosponsors without primary sponsor info</span>
<span class="n">no_primary_link</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;primary_party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">total_cosponsors</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">cosponsor_df</span><span class="p">)</span>
<span class="n">pct_no_primary</span> <span class="o">=</span> <span class="p">(</span><span class="n">no_primary_link</span> <span class="o">/</span> <span class="n">total_cosponsors</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span> <span class="k">if</span> <span class="n">total_cosponsors</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cosponsors without linked primary sponsor: </span><span class="si">{</span><span class="n">no_primary_link</span><span class="si">}</span><span class="s2"> of </span><span class="si">{</span><span class="n">total_cosponsors</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">pct_no_primary</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="c1"># Flag cross-party sponsorship only when both parties are known</span>
<span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;different_party&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;primary_party&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">notna</span><span class="p">()</span> <span class="o">&amp;</span>
    <span class="p">(</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;party&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;primary_party&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cosponsors without linked primary sponsor: 0 of 80345 (0.00%)
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-3-count-and-rank-cross-party-cosponsorships">
<h3><strong>Step 3: Count and rank cross-party cosponsorships</strong><a class="headerlink" href="#step-3-count-and-rank-cross-party-cosponsorships" title="Link to this heading">#</a></h3>
<p>We identify all legislators who cosponsored at least one bill from the opposing party. Those who did not are still included in the final ranking with a count of zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># All unique cosponsors</span>
<span class="n">all_cosponsors</span> <span class="o">=</span> <span class="n">cosponsor_df</span><span class="p">[[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1"># Filter to cross-party cosponsorship cases</span>
<span class="n">cross_party_df</span> <span class="o">=</span> <span class="n">merged_df</span><span class="p">[</span><span class="n">merged_df</span><span class="p">[</span><span class="s1">&#39;different_party&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="kc">True</span><span class="p">][[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;bill_id&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()</span>

<span class="c1"># Count number of cross-party cosponsorships per legislator</span>
<span class="n">cross_party_counts</span> <span class="o">=</span> <span class="n">cross_party_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">)</span>

<span class="c1"># Merge to include all cosponsors (even those with 0 cross-party cases)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">all_cosponsors</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">cross_party_counts</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;bioguide_id&#39;</span><span class="p">],</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>
<span class="n">result</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="c1"># Sort and rank</span>
<span class="n">ranked_result_b</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="n">by</span><span class="o">=</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">,</span>
    <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">ranked_result_b</span><span class="p">[</span><span class="s1">&#39;rank&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ranked_result_b</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>

<span class="c1"># Preview top-ranked cross-party cosponsors</span>
<span class="n">display</span><span class="p">(</span><span class="n">ranked_result_b</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>bioguide_id</th>
      <th>num_cross_party_cosponsored_bills</th>
      <th>rank</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Brian K. Fitzpatrick</td>
      <td>F000466</td>
      <td>433</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Donald G. Davis</td>
      <td>D000230</td>
      <td>240</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Jimmy Panetta</td>
      <td>P000613</td>
      <td>167</td>
      <td>3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Eugene Simon Vindman</td>
      <td>V000138</td>
      <td>161</td>
      <td>4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Josh Gottheimer</td>
      <td>G000583</td>
      <td>160</td>
      <td>5</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Michael Lawler</td>
      <td>L000599</td>
      <td>153</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Thomas R. Suozzi</td>
      <td>S001201</td>
      <td>130</td>
      <td>7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Don Bacon</td>
      <td>B001298</td>
      <td>126</td>
      <td>8</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Amy Klobuchar</td>
      <td>K000367</td>
      <td>117</td>
      <td>9</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Angie Craig</td>
      <td>C001119</td>
      <td>108</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="save-ranked-result-b-to-csv-files">
<h4><strong>Save ranked_result_b to csv files</strong><a class="headerlink" href="#save-ranked-result-b-to-csv-files" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Uncomment to save to google drive</span>
<span class="c1"># ranked_result_b.to_csv(&quot;/content/drive/MyDrive/Bridge Grades Snapshot August/Data/Source A-B/Output files/bridge_grade_source_b_cross_party_cosponsors.csv&quot;, index=False)</span>

<span class="c1"># Save to local machine</span>
<span class="n">ranked_result_b</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;../Data/Source A-B/Output files/bridge_grade_source_b_cross_party_cosponsors.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="visual-summary-of-cross-party-activity-and-data-quality">
<h2><strong>Visual Summary of Cross-Party Activity and Data Quality</strong><a class="headerlink" href="#visual-summary-of-cross-party-activity-and-data-quality" title="Link to this heading">#</a></h2>
<p>This section presents three key visualizations to complement the quantitative analysis:</p>
<ol class="arabic simple">
<li><p><strong>Top Cross-Party Cosponsors (Source B):</strong> Legislators ranked by how often they cosponsored bills from the opposite party.</p></li>
<li><p><strong>Top Authors of Cross-Party Supported Bills (Source A):</strong> Legislators ranked by the number of their sponsored bills that received bipartisan support.</p></li>
<li><p><strong>Missing Values Overview:</strong> A chart highlighting columns with missing information, including the source and reasoning behind those gaps.</p></li>
</ol>
<p>These charts help illustrate not only patterns of bipartisan behavior, but also the integrity and limitations of the underlying data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ordered_purples</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#3f007d&#39;</span><span class="p">,</span> <span class="s1">&#39;#54278f&#39;</span><span class="p">,</span> <span class="s1">&#39;#6a51a3&#39;</span><span class="p">,</span> <span class="s1">&#39;#807dba&#39;</span><span class="p">,</span> <span class="s1">&#39;#9e9ac8&#39;</span><span class="p">,</span> <span class="s1">&#39;#bcbddc&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Bar chart — Source A: Top Cross-Party Bill Authors</span>
<span class="n">top_authors</span> <span class="o">=</span> <span class="n">ranked_result</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span>
    <span class="n">by</span><span class="o">=</span><span class="s2">&quot;num_bills_with_cross_party_cosponsors&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

<span class="n">fig_authors</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span>
    <span class="n">top_authors</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;num_bills_with_cross_party_cosponsors&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;primary_name&quot;</span><span class="p">,</span>
    <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;h&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;num_bills_with_cross_party_cosponsors&quot;</span><span class="p">,</span>
    <span class="n">color_continuous_scale</span><span class="o">=</span><span class="n">ordered_purples</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Top 15 Legislators by Cross-Party Support to Their Bills (Source A)&quot;</span>
<span class="p">)</span>

<span class="n">fig_authors</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
    <span class="n">xaxis_title</span><span class="o">=</span><span class="s2">&quot;Number of Bills with Cross-Party Cosponsors&quot;</span><span class="p">,</span>
    <span class="n">yaxis_title</span><span class="o">=</span><span class="s2">&quot;Primary Sponsor&quot;</span><span class="p">,</span>
    <span class="n">yaxis</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">autorange</span><span class="o">=</span><span class="s2">&quot;reversed&quot;</span><span class="p">),</span>
    <span class="n">plot_bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
    <span class="n">paper_bgcolor</span><span class="o">=</span><span class="s2">&quot;#ffffff&quot;</span><span class="p">,</span>
    <span class="n">coloraxis_showscale</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
<span class="p">)</span>

<span class="n">fig_authors</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Current_Legislators/get_legislator_info_plural.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Plural Policy Legislator Data Processing</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="Source%20C-D-E-F.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Source C-D-E-F: App Communications Calculations Data Processing</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources"><strong>Data Sources</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files"><strong>Input Files</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-details"><strong>Data Source Details</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#outputs"><strong>Outputs</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-a-authors-of-bills-with-cross-party-sponsors"><strong>Source A: Authors of Bills with Cross Party Sponsors</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-b-ranked-people-who-cosponsor-bills"><strong>Source B: Ranked People who Cosponsor Bills</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements"><strong>Technical Requirements</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies"><strong>Dependencies</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-notes"><strong>Performance Notes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#notebook-walkthrough-preprocessing-for-bridge-grades-legislator-and-sponsorship-data"><strong>Notebook Walkthrough: Preprocessing for Bridge Grades: Legislator and Sponsorship Data</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filter-and-prepare-legislator-records"><strong>Filter and Prepare Legislator Records</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-bioguides-to-sponsorships"><strong>Merge bioguides to sponsorships</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#insert-party-and-chamber"><strong>Insert Party and chamber</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#check-independents"><strong>Check independents</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-cross-party-sponsorship-ranking-source-a"><strong>Construct Cross-Party Sponsorship Ranking (Source A)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#separate-primary-sponsors-and-cosponsors"><strong>Separate primary sponsors and cosponsors</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#merge-cosponsors-with-their-primary-sponsor-and-flag-cross-party-cases"><strong>Merge cosponsors with their primary sponsor and flag cross-party cases</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#count-and-rank-bills-with-cross-party-cosponsors"><strong>Count and rank bills with cross-party cosponsors</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#save-ranked-result-to-csv-files"><strong>Save ranked_result to csv files</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-cross-party-cosponsorship-ranking-source-b"><strong>Construct Cross-Party Cosponsorship Ranking (Source B)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-remove-rows-without-party-affiliation"><strong>Step 1: Remove rows without party affiliation</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-join-cosponsors-with-party-of-the-primary-sponsor"><strong>Step 2: Join cosponsors with party of the primary sponsor</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-count-and-rank-cross-party-cosponsorships"><strong>Step 3: Count and rank cross-party cosponsorships</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#save-ranked-result-b-to-csv-files"><strong>Save ranked_result_b to csv files</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visual-summary-of-cross-party-activity-and-data-quality"><strong>Visual Summary of Cross-Party Activity and Data Quality</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bridge Grades Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>