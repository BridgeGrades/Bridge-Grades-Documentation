
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Bridge Pledge Score Computation &#8212; Bridge Grades Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Bridge_Grades_Calculation';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Suggested Weights for Bridge Grades System" href="Suggested_Weights.html" />
    <link rel="prev" title="Source N: VoteView Member Ideology Scores Processing" href="Source%20N.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="Intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-light" alt="Bridge Grades Documentation - Home"/>
    <script>document.write(`<img src="_static/BRIDGE_GRADES_LOGO.png" class="logo__image only-dark" alt="Bridge Grades Documentation - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="Intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Project%20Explanation.html"><strong>About Bridge Grades Project</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Sources%20of%20Information.html"><strong>Bridge Grades Data Sources</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Current_Legislators/get_current_members.html"><strong>Current Legislators Data Collection: Congress.gov API</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Current_Legislators/get_legislator_info_plural.html"><strong>Plural Policy Legislator Data Processing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20A-B.html"><strong>Source A-B: Legislator and Sponsorship Data Processing</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Source%20C-D-E-F.html"><strong>Source C-D-E-F: App Communications Calculations Data Processing</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Source%20M.html"><strong>Source M: Cook Political Partisan Voting Index (PVI) Processing</strong></a></li>

<li class="toctree-l1"><a class="reference internal" href="Source%20N.html"><strong>Source N: VoteView Member Ideology Scores Processing</strong></a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Bridge Pledge Score Computation</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Suggested_Weights.html"><strong>Suggested Weights for Bridge Grades System</strong></a></li>
<li class="toctree-l1"><a class="reference internal" href="Next%20Steps.html"><strong>Next Steps</strong></a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FBridge_Grades_Calculation.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Bridge_Grades_Calculation.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Bridge Pledge Score Computation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources"><strong>Data Sources</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files"><strong>Input Files</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files"><strong>Output Files</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-functions"><strong>Main Functions</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-and-setup"><strong>1. Configuration and Setup</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-integration"><strong>2. Data Source Integration</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-score-calculation"><strong>3. Final Score Calculation</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements"><strong>Technical Requirements</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies"><strong>Dependencies</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-processing-notes"><strong>Data Processing Notes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality"><strong>Data Quality</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-checks"><strong>Validation Checks</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-file-existence-checks"><strong>Configuration &amp; File Existence Checks</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataframes-validate-weights"><strong>Load DataFrames &amp; Validate Weights</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-base-member-tables"><strong>Build Base Member Tables</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attendance-filtering"><strong>Attendance Filtering</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-processing"><strong>Data Source Processing</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-a-authors-of-bills-with-cross-party-sponsors"><strong>Source A: Authors of Bills with Cross-Party Sponsors</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-b-cosponsors-of-cross-party-bills"><strong>Source B: Cosponsors of Cross-Party Bills</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sources-c-d-e-f-communication-analysis"><strong>Sources C, D, E, F: Communication Analysis</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#source-c-bipartisan-communication-sum"><strong>Source C: Bipartisan Communication (Sum)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#source-d-bipartisan-communication-percentage"><strong>Source D: Bipartisan Communication (Percentage)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#source-e-personal-attacks-sum"><strong>Source E: Personal Attacks (Sum)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#source-f-personal-attacks-percentage"><strong>Source F: Personal Attacks (Percentage)</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-sources-m-n-p"><strong>Bonus Sources (M, N, P)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-m-cook-political-partisan-voting-index-pvi"><strong>Source M: Cook Political Partisan Voting Index (PVI)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-n-voteview-member-ideology-score"><strong>Source N: VoteView Member Ideology Score</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-p-problem-solvers-caucus-bump"><strong>Source P: Problem Solvers Caucus “Bump”</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-score-calculation-grade-assignment"><strong>Final Score Calculation &amp; Grade Assignment</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scoring-algorithm"><strong>Scoring Algorithm</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization"><strong>Data Visualization</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleanup-and-final-output-preparation"><strong>Data Cleanup and Final Output Preparation</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#party-abbreviations"><strong>Party Abbreviations</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-and-district-formatting"><strong>State and District Formatting</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-reorganization"><strong>Column Reorganization</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#export-to-excel-files"><strong>Export to Excel Files</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#export-options"><strong>Export Options</strong></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="bridge-pledge-score-computation">
<h1><strong>Bridge Pledge Score Computation</strong><a class="headerlink" href="#bridge-pledge-score-computation" title="Link to this heading">#</a></h1>
<div class="tip admonition">
<p class="admonition-title">Overview</p>
<p>This notebook integrates all preprocessed metrics (Sources A–F, M, N, P) to compute each Member’s <strong>Bridge Pledge</strong> score—a composite measure of bipartisan collaboration across sponsorships, communications, district lean, and ideology.</p>
<p>The final score combines standardized (0–100) values from each source, weighted according to our methodology, along with attendance and caucus‐membership bonuses. This notebook serves as a comprehensive demonstration of the complete Bridge Grades calculation process.</p>
<p>For full methodology, definitions, and source details, see the Bridge Grades framework on our website: <a class="reference external" href="https://bridgegrades.org/methodology">https://bridgegrades.org/methodology</a></p>
</div>
<section id="data-sources">
<h2><strong>Data Sources</strong><a class="headerlink" href="#data-sources" title="Link to this heading">#</a></h2>
<section id="input-files">
<h3><strong>Input Files</strong><a class="headerlink" href="#input-files" title="Link to this heading">#</a></h3>
<p>All processed data sources from previous notebooks:</p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">119th_Congress_20250809.csv</span></code></strong> - Master congressional roster with bioguide IDs, states, districts, parties, and chambers</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_a_cross_party_supported_bills.csv</span></code></strong> - Source A: Authors of bills with cross-party sponsors</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_b_cross_party_cosponsors.csv</span></code></strong> - Source B: Cosponsors of cross-party bills</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grades_source_cdef_app_communication.csv</span></code></strong> - Source C/D/E/F: APP communications data (bipartisanship and personal attacks)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_m_house_pvi.csv</span></code></strong> - Source M: Cook Political PVI for House districts</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_m_senate_pvi.csv</span></code></strong> - Source M: Cook Political PVI for Senate states</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_n_house_ideology.csv</span></code></strong> - Source N: VoteView ideological scores (House)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">bridge_grade_source_n_senate_ideology.csv</span></code></strong> - Source N: VoteView ideological scores (Senate)</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">problem_solvers.csv</span></code></strong> - Source P: Problem Solvers Caucus membership</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">profiles.csv</span></code></strong> - Attendance data for filtering</p></li>
</ul>
</section>
<section id="output-files">
<h3><strong>Output Files</strong><a class="headerlink" href="#output-files" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">house_scores_119.xlsx</span></code></strong> - Complete House member scores and grades</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">senate_scores_119.xlsx</span></code></strong> - Complete Senate member scores and grades</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">congress_scores_119_*.xlsx</span></code></strong> - Combined datasets in various formats</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="main-functions">
<h2><strong>Main Functions</strong><a class="headerlink" href="#main-functions" title="Link to this heading">#</a></h2>
<section id="configuration-and-setup">
<h3><strong>1. Configuration and Setup</strong><a class="headerlink" href="#configuration-and-setup" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Sets up scoring parameters and loads all data sources</p>
<p><strong>Key Parameters:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">att_pct</span> <span class="pre">=</span> <span class="pre">0.2</span></code> - Minimum attendance threshold (20%) for grading eligibility</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">weights</span></code> - Configurable weights for each data source (A=3, B=2, C=1, D=1, E=1, F=1)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bonuses</span></code> - Scaling factors for PVI, ideology, and caucus bonuses</p></li>
</ul>
</section>
<section id="data-source-integration">
<h3><strong>2. Data Source Integration</strong><a class="headerlink" href="#data-source-integration" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Merges all processed data sources into master datasets</p>
<p><strong>For Each Source (A through F):</strong></p>
<ul class="simple">
<li><p>Loads processed CSV file</p></li>
<li><p>Merges with master dataset using bioguide_id</p></li>
<li><p>Fills missing values appropriately (0 for counts, mean for percentages)</p></li>
<li><p>Calculates normalized scores using normal distribution CDF</p></li>
<li><p>Renames columns with source prefix for clarity</p></li>
</ul>
</section>
<section id="final-score-calculation">
<h3><strong>3. Final Score Calculation</strong><a class="headerlink" href="#final-score-calculation" title="Link to this heading">#</a></h3>
<p><strong>Purpose:</strong> Combines all normalized scores using weighted algorithm</p>
<p><strong>Algorithm:</strong></p>
<ol class="arabic simple">
<li><p><strong>Base Score (T_score):</strong> Weighted sum of normalized source scores (A-F)</p></li>
<li><p><strong>PVI Bonus (M_bonus):</strong> Additional points for bridging in highly partisan districts</p></li>
<li><p><strong>Ideology Bonus (N_bonus):</strong> Additional points for bridging by non-centrist legislators</p></li>
<li><p><strong>Caucus Bonus (P_bonus):</strong> Fixed bonus for Problem Solvers Caucus members</p></li>
<li><p><strong>Final Score (U_score):</strong> T_score + M_bonus + N_bonus + P_bonus</p></li>
<li><p><strong>Normalized Score (Bridge_Score):</strong> CDF normalization of U_score (0-100)</p></li>
<li><p><strong>Letter Grade (Bridge_Grade):</strong> Statistical assignment (A/B/C/F) based on score distribution</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="technical-requirements">
<h2><strong>Technical Requirements</strong><a class="headerlink" href="#technical-requirements" title="Link to this heading">#</a></h2>
<section id="dependencies">
<h3><strong>Dependencies</strong><a class="headerlink" href="#dependencies" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>pandas</strong> - Data manipulation and analysis</p></li>
<li><p><strong>numpy</strong> - Numerical operations</p></li>
<li><p><strong>scipy.stats</strong> - Statistical functions (normal distribution CDF)</p></li>
<li><p><strong>seaborn</strong> - Data visualization</p></li>
<li><p><strong>matplotlib.pyplot</strong> - Plotting</p></li>
</ul>
</section>
<section id="data-processing-notes">
<h3><strong>Data Processing Notes</strong><a class="headerlink" href="#data-processing-notes" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Missing Value Handling:</strong> Fills missing values with 0 for counts, column mean for percentages</p></li>
<li><p><strong>Duplicate Removal:</strong> Removes duplicate bioguide_id entries</p></li>
<li><p><strong>Data Type Conversion:</strong> Converts numeric columns to appropriate types for export</p></li>
<li><p><strong>Chamber Separation:</strong> Processes House and Senate separately due to different data structures</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="data-quality">
<h2><strong>Data Quality</strong><a class="headerlink" href="#data-quality" title="Link to this heading">#</a></h2>
<section id="validation-checks">
<h3><strong>Validation Checks</strong><a class="headerlink" href="#validation-checks" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Attendance Filtering:</strong> Removes members below 20% attendance threshold</p></li>
<li><p><strong>Duplicate Handling:</strong> Removes duplicate bioguide_id entries</p></li>
<li><p><strong>Missing Data:</strong> Appropriate filling strategies for each data type</p></li>
<li><p><strong>Score Validation:</strong> Ensures all scores are within expected ranges</p></li>
</ul>
</section>
</section>
<section id="configuration-file-existence-checks">
<h2><strong>Configuration &amp; File Existence Checks</strong><a class="headerlink" href="#configuration-file-existence-checks" title="Link to this heading">#</a></h2>
<p>In this section we verify that all input files exist before proceeding, and validate that our <code class="docutils literal notranslate"><span class="pre">weights</span></code> dictionary matches the set of loaded source labels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">norm</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Global parameters</span>
<span class="n">att_pct</span>   <span class="o">=</span> <span class="mf">0.2</span>   <span class="c1"># Minimum attendance proportion</span>
<span class="n">weights</span>   <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>   <span class="c1"># Source A: num_bills_with_cross_party_cosponsors</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>   <span class="c1"># Source B: num_cross_party_cosponsored_bills</span>
    <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source C: communications that support members of the opposite party</span>
    <span class="s1">&#39;D&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source D: proportion of communications that support members of the opposite party</span>
    <span class="s1">&#39;E&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source E: communications classified as personal attacks</span>
    <span class="s1">&#39;F&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>   <span class="c1"># Source F: proportion of communications classified as personal attacks</span>
<span class="p">}</span>

<span class="n">bonuses</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pvi_value_cap&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="c1"># number of PVI points to cap at</span>
    <span class="s1">&#39;max_P_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="c1"># scaling factor for P bonus</span>
    <span class="s1">&#39;max_N_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.05</span><span class="p">,</span> <span class="c1"># scaling factor for N bonus</span>
    <span class="s1">&#39;max_M_bonus_scaling_factor&#39;</span><span class="p">:</span> <span class="mf">0.38</span> <span class="c1"># scaling factor for M bonus</span>
<span class="p">}</span>

<span class="c1"># Define all required file paths</span>
<span class="n">BASE_DIR</span> <span class="o">=</span> <span class="s1">&#39;../Data&#39;</span> <span class="c1"># Uncomment this line if running locally</span>
<span class="n">paths</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;meta&#39;</span><span class="p">:</span>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source C-D-E-F/Input files/119th_Congress_20250809.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span>           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source A-B/Output files/bridge_grade_source_a_cross_party_supported_bills.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;B&#39;</span><span class="p">:</span>           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source A-B/Output files/bridge_grade_source_b_cross_party_cosponsors.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;CDEF&#39;</span><span class="p">:</span>        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source C-D-E-F/Output files/bridge_grades_source_cdef_app_communication.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;M_House&#39;</span><span class="p">:</span>     <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source M/Output files/bridge_grade_source_m_house_pvi.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;M_Senate&#39;</span><span class="p">:</span>    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source M/Output files/bridge_grade_source_m_senate_pvi.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;N_House&#39;</span><span class="p">:</span>     <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source N/Output files/bridge_grade_source_n_house_ideology.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;N_Senate&#39;</span><span class="p">:</span>    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source N/Output files/bridge_grade_source_n_senate_ideology.csv&quot;</span><span class="p">,</span>
    <span class="s1">&#39;P&#39;</span><span class="p">:</span>           <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/Source P/problem_solvers.csv&quot;</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Load raw APP profiles (attendance data)</span>
<span class="n">source_APP_profiles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">BASE_DIR</span><span class="si">}</span><span class="s2">/profiles.csv&quot;</span><span class="p">,</span>
    <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;full_name&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_max&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Check each file exists</span>
<span class="n">missing_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">paths</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">p</span><span class="p">)]</span>
<span class="k">if</span> <span class="n">missing_files</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing input files for sources: </span><span class="si">{</span><span class="n">missing_files</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;All input files found.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="load-dataframes-validate-weights">
<h2><strong>Load DataFrames &amp; Validate Weights</strong><a class="headerlink" href="#load-dataframes-validate-weights" title="Link to this heading">#</a></h2>
<p>We load each CSV into a DataFrame and then ensure the set of weight keys matches the loaded source labels exactly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load master metadata</span>
<span class="n">meta_data</span>        <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;meta&#39;</span><span class="p">])</span>

<span class="c1"># Load each source DataFrame</span>
<span class="n">source_A</span>         <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">])</span>
<span class="n">source_B</span>         <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">source_APP</span>       <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;CDEF&#39;</span><span class="p">])</span>
<span class="n">source_M_House</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;M_House&#39;</span><span class="p">])</span>
<span class="n">source_M_Senate</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;M_Senate&#39;</span><span class="p">])</span>
<span class="n">source_N_House</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;N_House&#39;</span><span class="p">])</span>
<span class="n">source_N_Senate</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;N_Senate&#39;</span><span class="p">])</span>
<span class="n">source_P</span>         <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">paths</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">])</span>

<span class="c1"># Verify weight keys vs. sources to be scored (A–F)</span>
<span class="n">loaded_sources</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">expected_sources</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">}</span>
<span class="k">if</span> <span class="n">loaded_sources</span> <span class="o">!=</span> <span class="n">expected_sources</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Weights keys </span><span class="si">{</span><span class="n">loaded_sources</span><span class="si">}</span><span class="s2"> do not match expected </span><span class="si">{</span><span class="n">expected_sources</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Weights validated against source labels.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="build-base-member-tables">
<h2><strong>Build Base Member Tables</strong><a class="headerlink" href="#build-base-member-tables" title="Link to this heading">#</a></h2>
<p>In this section we initialize our working DataFrames for the House and Senate by subsetting the master <code class="docutils literal notranslate"><span class="pre">meta_data</span></code>. These tables will be the foundation for merging each source’s metrics.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preview master metadata</span>
<span class="n">meta_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subset to House members</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Chamber==&#39;House&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;House members: </span><span class="si">{</span><span class="n">house_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subset to Senate members</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">meta_data</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;Chamber==&#39;Senate&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Senate members: </span><span class="si">{</span><span class="n">senate_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="attendance-filtering">
<h2><strong>Attendance Filtering</strong><a class="headerlink" href="#attendance-filtering" title="Link to this heading">#</a></h2>
<p>Legislators below the minimum attendance threshold (<code class="docutils literal notranslate"><span class="pre">att_pct</span></code>) are excluded from scoring. We calculate each member’s attendance percentage and remove those below <code class="docutils literal notranslate"><span class="pre">att_pct</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract attendance data</span>
<span class="n">source_att</span> <span class="o">=</span> <span class="n">source_APP_profiles</span><span class="p">[[</span>
    <span class="s1">&#39;full_name&#39;</span><span class="p">,</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">,</span><span class="s1">&#39;attendance_max&#39;</span>
<span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_att</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for missing attendance data</span>
<span class="n">missing_attendance</span> <span class="o">=</span> <span class="n">source_att</span><span class="p">[</span><span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Legislators with missing attendance data: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_attendance</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: Missing legislators are typically non-voting members from territories.&quot;</span><span class="p">)</span>
<span class="n">missing_attendance</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing totals with zero</span>
<span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Compute attendance percentage</span>
<span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_total&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">source_att</span><span class="p">[</span><span class="s1">&#39;attendance_max&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Identify members below threshold</span>
<span class="n">low_att</span> <span class="o">=</span> <span class="n">source_att</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;attendance_pct &lt; @att_pct&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Legislators below </span><span class="si">{</span><span class="n">att_pct</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% attendance threshold: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">low_att</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: All legislators with low attendance are non-voting members from territories.&quot;</span><span class="p">)</span>
<span class="n">low_att</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Remove low‐attendance members from both tables</span>
<span class="n">to_remove</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">low_att</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">])</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="o">~</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">to_remove</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="o">~</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">to_remove</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final House members: </span><span class="si">{</span><span class="n">house_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final Senate members: </span><span class="si">{</span><span class="n">senate_final</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-source-processing">
<h2><strong>Data Source Processing</strong><a class="headerlink" href="#data-source-processing" title="Link to this heading">#</a></h2>
<p>This section processes each data source (A through F) by merging the data with our master datasets and calculating normalized scores. Each source is processed separately for House and Senate members.</p>
<section id="source-a-authors-of-bills-with-cross-party-sponsors">
<h3><strong>Source A: Authors of Bills with Cross-Party Sponsors</strong><a class="headerlink" href="#source-a-authors-of-bills-with-cross-party-sponsors" title="Link to this heading">#</a></h3>
<p>Rewards Members of the 119th U.S. Congress for sponsoring legislation that attracted at least one cosponsor from the opposite party. We take each legislator’s total count of such bills, fill true “no-activity” values with zeros, and convert counts into a 0–100 percentile score.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> OpenStates bill sponsorship CSV for the 119th Congress</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">https://open.pluralpolicy.com/data/session-csv/</a></p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> “Source A – B: Legislator and Sponsorship Data”</p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
A missing count indicates the legislator had <strong>no</strong> cross-party bills. Zero appropriately reflects “no activity,” not unknown data.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only the primary bioguide ID and cross-party bill count</span>
<span class="n">source_A</span> <span class="o">=</span> <span class="n">source_A</span><span class="p">[[</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">{</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">}</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">source_A</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> \
    <span class="s2">&quot;Unexpected columns in source_A&quot;</span>
<span class="n">source_A</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final by bioguide_id</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_A</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">:</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">}),</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Check for missing values</span>
<span class="n">missing_house</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;House members with missing Source A data: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_house</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: Missing values typically indicate no cross-party bill sponsorship activity.&quot;</span><span class="p">)</span>
<span class="n">missing_house</span><span class="p">[[</span><span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing counts (no cross-party bills) with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span>
    <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span>
<span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize A House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span>

<span class="c1"># Calculate mean and std for normalization</span>
<span class="n">mean_A</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_A</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column using CDF</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;A_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">mean_A</span><span class="p">,</span> <span class="n">std_A</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Add weight column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;A_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

<span class="c1"># Clean up</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate_final by bioguide_id</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_A</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;primary_bioguide_id&#39;</span><span class="p">:</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">}),</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Check for missing values</span>
<span class="n">missing_senate</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Senate members with missing Source A data: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_senate</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: No missing values in Senate data.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fill missing counts with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span>
    <span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span>
<span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize A - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span>

<span class="c1"># Calculate mean and std for normalization</span>
<span class="n">mean_A</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_A</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column using CDF</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;A_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">mean_A</span><span class="p">,</span> <span class="n">std_A</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Add weight column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;A_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">]</span>

<span class="c1"># Drop duplicates and cleanup</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_bills_with_cross_party_cosponsors&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="source-b-cosponsors-of-cross-party-bills">
<h3><strong>Source B: Cosponsors of Cross-Party Bills</strong><a class="headerlink" href="#source-b-cosponsors-of-cross-party-bills" title="Link to this heading">#</a></h3>
<p>This section processes <strong>Source B</strong>, which rewards Members of the 119th U.S. Congress for <strong>cosponsoring</strong> bills authored by another party. We take each legislator’s total count of such cross-party cosponsorships, fill true zero-activity values with zeros, and convert counts into a 0–100 percentile score.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> OpenStates bill sponsorship CSV for the 119th Congress</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://open.pluralpolicy.com/data/session-csv/">https://open.pluralpolicy.com/data/session-csv/</a></p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> “Source A – B: Legislator and Sponsorship Data”</p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
A missing count indicates the legislator did <strong>not</strong> cosponsor any cross-party bills. Zero correctly represents “no activity.”</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select only bioguide_id and cosponsor count</span>
<span class="k">assert</span> <span class="p">{</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">}</span> <span class="o">&lt;=</span> <span class="nb">set</span><span class="p">(</span><span class="n">source_B</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> \
    <span class="s2">&quot;Unexpected columns in source_B&quot;</span>
<span class="n">source_B</span> <span class="o">=</span> <span class="n">source_B</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_B</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into house_final by bioguide_id</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_B</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Check for missing values</span>
<span class="n">missing_house</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;House members with missing Source B data: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_house</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: No missing values for the house.&quot;</span><span class="p">)</span>

<span class="c1"># Fill missing counts with zero</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize B - House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span>

<span class="c1"># Calculate mean and std for normalization</span>
<span class="n">mean_B</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_B</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column using CDF</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;B_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">mean_B</span><span class="p">,</span> <span class="n">std_B</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Add weight column</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;B_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>

<span class="c1"># Clean up raw column</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Merge into senate_final by bioguide_id</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_B</span><span class="p">,</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Check for missing values</span>
<span class="n">missing_senate</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isna</span><span class="p">()]</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Senate members with missing Source B data: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">missing_senate</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Note: No missing values for the Senate.&quot;</span><span class="p">)</span>

<span class="c1"># Fill missing counts with zero</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize B - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span>

<span class="c1"># Calculate mean and std for normalization</span>
<span class="n">mean_B</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_B</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>

<span class="c1"># Add normalized column using CDF</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;B_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">mean_B</span><span class="p">,</span> <span class="n">std_B</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

<span class="c1"># Add weight column</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;B_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;B&#39;</span><span class="p">]</span>

<span class="c1"># Drop duplicate legislators and cleanup</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;num_cross_party_cosponsored_bills&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="sources-c-d-e-f-communication-analysis">
<h3><strong>Sources C, D, E, F: Communication Analysis</strong><a class="headerlink" href="#sources-c-d-e-f-communication-analysis" title="Link to this heading">#</a></h3>
<p>These sources analyze public communication patterns of legislators to measure bipartisanship and divisiveness in their rhetoric.</p>
<section id="source-c-bipartisan-communication-sum">
<h4><strong>Source C: Bipartisan Communication (Sum)</strong><a class="headerlink" href="#source-c-bipartisan-communication-sum" title="Link to this heading">#</a></h4>
<p>Rewards Members for communications that support members of the opposite party. We count each legislator’s total <strong>outcome_bipartisanship</strong> flags and convert counts into a 0–100 percentile score.</p>
</section>
<section id="source-d-bipartisan-communication-percentage">
<h4><strong>Source D: Bipartisan Communication (Percentage)</strong><a class="headerlink" href="#source-d-bipartisan-communication-percentage" title="Link to this heading">#</a></h4>
<p>Rewards Members for the <strong>proportion</strong> of their communications that are supportive of the opposite party. We take each legislator’s percentage and convert it into a percentile score.</p>
</section>
<section id="source-e-personal-attacks-sum">
<h4><strong>Source E: Personal Attacks (Sum)</strong><a class="headerlink" href="#source-e-personal-attacks-sum" title="Link to this heading">#</a></h4>
<p>Penalizes Members for communications classified as personal attacks. We count each legislator’s total <strong>attack_personal</strong> flags and convert into an <strong>inverse</strong> normalized score—higher attack counts yield lower scores.</p>
</section>
<section id="source-f-personal-attacks-percentage">
<h4><strong>Source F: Personal Attacks (Percentage)</strong><a class="headerlink" href="#source-f-personal-attacks-percentage" title="Link to this heading">#</a></h4>
<p>Penalizes Members based on the <strong>percentage</strong> of their communications that are personal attacks. Higher attack rates → lower scores.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> American Political Pulse communications CSV (2025 download)</p></li>
<li><p><strong>Download link:</strong> <a class="reference external" href="https://americaspoliticalpulse.com/data/">https://americaspoliticalpulse.com/data/</a> (Download “US officials – 2025”)</p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source C–D–E–F: App_Communications_Calculations</em></p></li>
</ul>
<blockquote>
<div><p><strong>Why fill with zeros?</strong><br />
Missing values indicate no activity in that category. Zero accurately represents “none.”</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process Source C: Bipartisan Communication (Sum)</span>
<span class="k">assert</span> <span class="s1">&#39;outcome_bipartisanship&#39;</span> <span class="ow">in</span> <span class="n">source_APP</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;Missing &#39;outcome_bipartisanship&#39; in source_APP&quot;</span>
<span class="n">source_C</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_C</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize C - House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span>
<span class="n">mean_C</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_C</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;C_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">mean_C</span><span class="p">,</span> <span class="n">std_C</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;C_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_C</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize C - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span>
<span class="n">mean_C</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_C</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;C_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">mean_C</span><span class="p">,</span> <span class="n">std_C</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;C_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source C processing completed for both chambers.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process Source D: Bipartisan Communication (Percentage)</span>
<span class="k">assert</span> <span class="s1">&#39;outcome_bipartisanship_pct&#39;</span> <span class="ow">in</span> <span class="n">source_APP</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;Missing &#39;outcome_bipartisanship_pct&#39; in source_APP&quot;</span>
<span class="n">source_D</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_D</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize D - House</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span>
<span class="n">mean_D</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_D</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;D_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">mean_D</span><span class="p">,</span> <span class="n">std_D</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;D_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_D</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize D - Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span>
<span class="n">mean_D</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_D</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;D_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">mean_D</span><span class="p">,</span> <span class="n">std_D</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;D_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;D&#39;</span><span class="p">]</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;outcome_bipartisanship_pct&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source D processing completed for both chambers.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process Source E: Personal Attacks (Sum) - INVERSE SCORING</span>
<span class="k">assert</span> <span class="s1">&#39;attack_personal&#39;</span> <span class="ow">in</span> <span class="n">source_APP</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;Missing &#39;attack_personal&#39; in source_APP&quot;</span>
<span class="n">source_E</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_E</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize E - House (INVERSE: more attacks = lower score)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;E: attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span>
<span class="n">mean_E</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_E</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;E_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">mean_E</span><span class="p">,</span> <span class="n">std_E</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;E_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_E</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize E - Senate (INVERSE: more attacks = lower score)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;E: attack_personal&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span>
<span class="n">mean_E</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_E</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;E_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">mean_E</span><span class="p">,</span> <span class="n">std_E</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;E_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">]</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;attack_personal&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source E processing completed for both chambers.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process Source F: Personal Attacks (Percentage) - INVERSE SCORING</span>
<span class="k">assert</span> <span class="s1">&#39;attack_personal_pct&#39;</span> <span class="ow">in</span> <span class="n">source_APP</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s2">&quot;Missing &#39;attack_personal_pct&#39; in source_APP&quot;</span>
<span class="n">source_F</span> <span class="o">=</span> <span class="n">source_APP</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_F</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize F - House (INVERSE: more attacks = lower score)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span>
<span class="n">mean_F</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_F</span> <span class="o">=</span> <span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;F_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">mean_F</span><span class="p">,</span> <span class="n">std_F</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;F_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>
<span class="n">house_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_F</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Normalize F - Senate (INVERSE: more attacks = lower score)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span>
<span class="n">mean_F</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">std_F</span> <span class="o">=</span> <span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;F_norm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">mean_F</span><span class="p">,</span> <span class="n">std_F</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s1">&#39;F_weight&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">weights</span><span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">]</span>
<span class="n">senate_final</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;attack_personal_pct&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source F processing completed for both chambers.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="bonus-sources-m-n-p">
<h2><strong>Bonus Sources (M, N, P)</strong><a class="headerlink" href="#bonus-sources-m-n-p" title="Link to this heading">#</a></h2>
<p>These sources provide additional context and bonuses to the base scoring system.</p>
<section id="source-m-cook-political-partisan-voting-index-pvi">
<h3><strong>Source M: Cook Political Partisan Voting Index (PVI)</strong><a class="headerlink" href="#source-m-cook-political-partisan-voting-index-pvi" title="Link to this heading">#</a></h3>
<p>This section processes <strong>Source M</strong>, which captures each district’s partisan lean (Cook PVI) for the 119th Congress. A <strong>higher</strong> PVI number means a stronger lean toward one party; a <strong>lower</strong> PVI indicates a more competitive (centrist) district. We cap the PVI value at 15.</p>
<ul class="simple">
<li><p><strong>Data origin:</strong> Cook Political PVI via subscription at <a class="reference external" href="http://cookpolitical.com">cookpolitical.com</a></p></li>
<li><p><strong>Date downloaded:</strong> April, 2025 (this data is updated periodically, not daily, last checked August 8, 2025)</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source M House &amp; Senate Cook Political PVI</em></p></li>
</ul>
</section>
<section id="source-n-voteview-member-ideology-score">
<h3><strong>Source N: VoteView Member Ideology Score</strong><a class="headerlink" href="#source-n-voteview-member-ideology-score" title="Link to this heading">#</a></h3>
<p>This section merges pre-computed ideology percentiles into the Bridge Pledge tables. The percentiles measure how far each legislator lies from the partisan center, rewarding those closer to the middle.</p>
<ul class="simple">
<li><p><strong>Data source:</strong> Voteview “Member Ideology” CSV exports (House and Senate, 119th Congress)</p></li>
<li><p><strong>Date downloaded:</strong> August 8, 2025</p></li>
<li><p><strong>Preprocessing notebook:</strong> <em>Source N: VoteView Member Ideology Scores.ipynb</em></p></li>
</ul>
</section>
<section id="source-p-problem-solvers-caucus-bump">
<h3><strong>Source P: Problem Solvers Caucus “Bump”</strong><a class="headerlink" href="#source-p-problem-solvers-caucus-bump" title="Link to this heading">#</a></h3>
<p>This section applies a fixed points boost to members of the Problem Solvers Caucus (PSC). We load the externally maintained list of PSC bioguide IDs, flag each legislator, and add the configured bonus to their pledge score.</p>
<ul class="simple">
<li><p><strong>Data source:</strong> <code class="docutils literal notranslate"><span class="pre">problem_solvers.csv</span></code> (one column: <code class="docutils literal notranslate"><span class="pre">bioguide_id</span></code>), maintained in our data repo. Source: <a class="reference external" href="https://problemsolverscaucus.house.gov/caucus-members">https://problemsolverscaucus.house.gov/caucus-members</a></p></li>
<li><p><strong>Date Updated:</strong> July 20, 2025</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process Source M: Cook Political PVI</span>
<span class="c1"># House PVI</span>
<span class="n">pvi_cols</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">source_M_House</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s2">&quot;PVI_Number&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">pvi_cols</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No PVI number column found in source_M_House: </span><span class="si">{</span><span class="n">source_M_House</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">pvi_col</span> <span class="o">=</span> <span class="n">pvi_cols</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">source_M_h</span> <span class="o">=</span> <span class="n">source_M_House</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">pvi_col</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_M_h</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">pvi_col</span><span class="p">:</span> <span class="s1">&#39;M: Cook PVI Raw&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Cap PVI values</span>
<span class="n">pvi_value_cap</span> <span class="o">=</span> <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;pvi_value_cap&#39;</span><span class="p">]</span>
<span class="n">source_M_h</span><span class="p">[</span><span class="s1">&#39;M_Cook_PVI_Cap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_M_h</span><span class="p">[</span><span class="s1">&#39;M: Cook PVI Raw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pvi_value_cap</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">pvi_value_cap</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_M_h</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># Senate PVI</span>
<span class="n">pvi_cols_s</span> <span class="o">=</span> <span class="p">[</span><span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">source_M_Senate</span><span class="o">.</span><span class="n">columns</span> <span class="k">if</span> <span class="s2">&quot;PVI_Number&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span>
<span class="k">assert</span> <span class="n">pvi_cols_s</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No PVI number column found in source_M_Senate: </span><span class="si">{</span><span class="n">source_M_Senate</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">pvi_col_s</span> <span class="o">=</span> <span class="n">pvi_cols_s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">source_M_s</span> <span class="o">=</span> <span class="n">source_M_Senate</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">pvi_col_s</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">source_M_s</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="n">pvi_col_s</span><span class="p">:</span> <span class="s1">&#39;M: Cook PVI Raw&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Cap PVI values</span>
<span class="n">source_M_s</span><span class="p">[</span><span class="s1">&#39;M_Cook_PVI_Cap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">source_M_s</span><span class="p">[</span><span class="s1">&#39;M: Cook PVI Raw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pvi_value_cap</span> <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="n">pvi_value_cap</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>

<span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">source_M_s</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source M (PVI) processing completed for both chambers.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process Source N: VoteView Ideology Scores</span>
<span class="c1"># Rename columns for consistency</span>
<span class="n">source_N_House</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">:</span> <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;ideology_dist&#39;</span><span class="p">:</span> <span class="s1">&#39;N_ideology_dist&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">source_N_Senate</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;nominate_dim1&#39;</span><span class="p">:</span> <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;ideology_dist&#39;</span><span class="p">:</span> <span class="s1">&#39;N_ideology_dist&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Merge into house_final</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">house_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_N_House</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;N_ideology_dist&#39;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="c1"># Merge into senate_final</span>
<span class="n">senate_final</span> <span class="o">=</span> <span class="n">senate_final</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
    <span class="n">source_N_Senate</span><span class="p">[[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;N_ideology_dist&#39;</span><span class="p">]],</span>
    <span class="n">on</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span>
    <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source N (Ideology) processing completed for both chambers.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Process Source P: Problem Solvers Caucus</span>
<span class="c1"># Load the external CSV of caucus members</span>
<span class="n">psc_ids</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
        <span class="s1">&#39;../Data/Source P/problem_solvers.csv&#39;</span>
    <span class="p">)[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">]</span>
<span class="p">)</span>

<span class="k">def</span> <span class="nf">apply_psc_bump</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">id_col</span><span class="o">=</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add PSC bump:</span>
<span class="sd">      - P_flag: 1 if member is in PSC, else 0</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;P_flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">id_col</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">psc_ids</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="c1"># Check for any PSC IDs not present in the House roster</span>
<span class="n">missing_in_house</span> <span class="o">=</span> <span class="n">psc_ids</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">house_final</span><span class="p">[</span><span class="s1">&#39;bioguide_id&#39;</span><span class="p">])</span>
<span class="k">if</span> <span class="n">missing_in_house</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Warning: PSC IDs not in House table: </span><span class="si">{</span><span class="nb">sorted</span><span class="p">(</span><span class="n">missing_in_house</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Apply PSC bump to House</span>
<span class="n">house_final</span> <span class="o">=</span> <span class="n">apply_psc_bump</span><span class="p">(</span><span class="n">house_final</span><span class="p">)</span>

<span class="c1"># Note: Only House members are included in the PSC, so this is not applicable to the Senate</span>
<span class="n">senate_final</span><span class="p">[</span><span class="s2">&quot;P_flag&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Source P (Problem Solvers Caucus) processing completed for both chambers.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="final-score-calculation-grade-assignment">
<h2><strong>Final Score Calculation &amp; Grade Assignment</strong><a class="headerlink" href="#final-score-calculation-grade-assignment" title="Link to this heading">#</a></h2>
<p>In this final phase, we turn each legislator’s normalized source scores into a composite Bridge Grade. We:</p>
<ol class="arabic simple">
<li><p><strong>Combine</strong> weighted normalized scores from each Source (<code class="docutils literal notranslate"><span class="pre">A</span></code>–<code class="docutils literal notranslate"><span class="pre">F</span></code>).</p></li>
<li><p><strong>Apply</strong> multipliers (<code class="docutils literal notranslate"><span class="pre">M</span></code>, <code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">P</span></code>) on top of the normalized, weighted score.</p></li>
<li><p><strong>Assign</strong> a letter grade (<code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, <code class="docutils literal notranslate"><span class="pre">C</span></code>, <code class="docutils literal notranslate"><span class="pre">F</span></code>) based on statistical thresholds (mean ± std and the median).</p></li>
<li><p><strong>Normalize</strong> the combined score to a 0–100 percentile.</p></li>
</ol>
<section id="scoring-algorithm">
<h3><strong>Scoring Algorithm</strong><a class="headerlink" href="#scoring-algorithm" title="Link to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">cal_score()</span></code> function:</p>
<ul class="simple">
<li><p><strong>Aggregates</strong> <code class="docutils literal notranslate"><span class="pre">norm_{X}</span></code> columns only if they exist in the DataFrame.</p></li>
<li><p><strong>Weights</strong> Assigns the weights for each source.</p></li>
<li><p><strong>Adds</strong> ideology multipliers (<code class="docutils literal notranslate"><span class="pre">M</span></code>, <code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">P</span></code>) safely, with the following formulas:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">bonus_m</span> <span class="pre">=</span> <span class="pre">[score_T*(1+M)*max_M_bonus_scaling_factor]</span> <span class="pre">-</span> <span class="pre">score_T</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bonus_n</span> <span class="pre">=</span> <span class="pre">score_T</span> <span class="pre">*</span> <span class="pre">max_N_bonus_scaling_factor</span> <span class="pre">*</span> <span class="pre">N_ideology_dist</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bonus_p</span> <span class="pre">=</span> <span class="pre">max_P_bonus_scaling_factor</span> <span class="pre">*</span> <span class="pre">score_T_max</span> <span class="pre">*</span> <span class="pre">P_flag</span></code>
where <code class="docutils literal notranslate"><span class="pre">score_T_max</span></code> is the max <code class="docutils literal notranslate"><span class="pre">score_T</span></code> across all legislators</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">score_U</span> <span class="pre">=</span> <span class="pre">score_T</span> <span class="pre">+</span> <span class="pre">bonus_m</span> <span class="pre">+</span> <span class="pre">bonus_n</span> <span class="pre">+</span> <span class="pre">bonus_p</span></code></p></li>
<li><p><strong>Normalizes</strong> the total (<code class="docutils literal notranslate"><span class="pre">score_U</span></code>) via the Normal CDF.</p></li>
<li><p><strong>Assigns</strong> letter grades using:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> if <code class="docutils literal notranslate"><span class="pre">score_U</span> <span class="pre">&gt;</span> <span class="pre">mean</span> <span class="pre">+</span> <span class="pre">std</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">B</span></code> if <code class="docutils literal notranslate"><span class="pre">median</span> <span class="pre">&lt;</span> <span class="pre">score_U</span> <span class="pre">≤</span> <span class="pre">mean</span> <span class="pre">+</span> <span class="pre">std</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">C</span></code> if <code class="docutils literal notranslate"><span class="pre">mean</span> <span class="pre">-</span> <span class="pre">std</span> <span class="pre">&lt;</span> <span class="pre">score_U</span> <span class="pre">≤</span> <span class="pre">median</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">F</span></code> otherwise</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">cal_score</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bonuses</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate Bridge Pledge scores for legislators.</span>
<span class="sd">    </span>
<span class="sd">    Parameters:</span>
<span class="sd">    -----------</span>
<span class="sd">    data : pandas.DataFrame</span>
<span class="sd">        DataFrame containing legislator data with normalized source scores</span>
<span class="sd">    weights : dict</span>
<span class="sd">        Dictionary mapping source letters to their weights</span>
<span class="sd">    bonuses : dict</span>
<span class="sd">        Dictionary containing bonus scaling factors</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">    --------</span>
<span class="sd">    pandas.DataFrame</span>
<span class="sd">        DataFrame with calculated scores and grades</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Copy the data to avoid modifying the original dataframe</span>
    <span class="n">temp_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Initialize columns</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Calculate &#39;score_T&#39; by adding weighted norm values for each category</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">weights</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">+=</span> <span class="n">temp_data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">_norm&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="n">weights</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="c1"># Calculate bonuses</span>
    <span class="c1"># PVI bonus (M)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;M_Cook_PVI_Cap&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">100</span><span class="p">)</span><span class="o">*</span><span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_M_bonus_scaling_factor&#39;</span><span class="p">]))</span><span class="o">-</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span>

    <span class="c1"># Ideology bonus (N)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_N_bonus_scaling_factor&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;N_ideology_dist&#39;</span><span class="p">]</span>

    <span class="c1"># Ensure bonuses are non-negative</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Caucus bonus (P)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span>
      <span class="n">bonuses</span><span class="p">[</span><span class="s1">&#39;max_P_bonus_scaling_factor&#39;</span><span class="p">]</span>
      <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
      <span class="o">*</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;P_flag&#39;</span><span class="p">]</span>
    <span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="c1"># Final score</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_T&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_m&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_n&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;bonus_p&#39;</span><span class="p">]</span>

    <span class="c1"># Calculate statistics for grade assignment</span>
    <span class="n">mean_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">std_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">median_U</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">(),</span> <span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Normalize &#39;score_U&#39; using the cumulative distribution function (CDF)</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;norm_U&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">],</span> <span class="n">mean_U</span><span class="p">,</span> <span class="n">std_U</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>

    <span class="c1"># Define the grade assignment function based on the calculated scores</span>
    <span class="k">def</span> <span class="nf">assign_grade</span><span class="p">(</span><span class="n">grade</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">mean_U</span> <span class="o">+</span> <span class="n">std_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;A&#39;</span>
        <span class="k">elif</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">median_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;B&#39;</span>
        <span class="k">elif</span> <span class="n">grade</span> <span class="o">&gt;</span> <span class="n">mean_U</span> <span class="o">-</span> <span class="n">std_U</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;C&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;F&#39;</span>

    <span class="c1"># Apply the grade assignment to the &#39;score_U&#39; column</span>
    <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp_data</span><span class="p">[</span><span class="s1">&#39;score_U&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">assign_grade</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">temp_data</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate scores for House members</span>
<span class="n">house_final_test</span> <span class="o">=</span> <span class="n">cal_score</span><span class="p">(</span><span class="n">house_final</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bonuses</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;House scores calculated successfully.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;House members processed: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">house_final_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Display grade distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">House Grade Distribution:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate scores for Senate members</span>
<span class="n">senate_final_test</span> <span class="o">=</span> <span class="n">cal_score</span><span class="p">(</span><span class="n">senate_final</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">bonuses</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Senate scores calculated successfully.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Senate members processed: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">senate_final_test</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Display grade distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Senate Grade Distribution:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;Grade&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="data-visualization">
<h2><strong>Data Visualization</strong><a class="headerlink" href="#data-visualization" title="Link to this heading">#</a></h2>
<p>This section creates visualizations to show the distribution of Bridge Grades across both chambers and political parties.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create visualizations for grade distributions</span>
<span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="s2">&quot;F&quot;</span><span class="p">]</span>
<span class="n">hue_order</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Democratic&#39;</span><span class="p">,</span> <span class="s1">&#39;Republican&#39;</span><span class="p">,</span> <span class="s1">&#39;Independent&#39;</span><span class="p">]</span>

<span class="n">purple_palette</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#4B0082&quot;</span><span class="p">,</span> <span class="s2">&quot;#5D3FD3&quot;</span><span class="p">,</span> <span class="s2">&quot;#7B68EE&quot;</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">plot_with_counts</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;Grade&#39;</span><span class="p">,</span>
        <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Party&#39;</span><span class="p">,</span>
        <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
        <span class="n">palette</span><span class="o">=</span><span class="n">purple_palette</span><span class="p">,</span>
        <span class="n">order</span><span class="o">=</span><span class="n">order</span><span class="p">,</span>
        <span class="n">hue_order</span><span class="o">=</span><span class="n">hue_order</span>
    <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># Calculate maximum height for y-axis scaling</span>
    <span class="n">max_height</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">max_height</span> <span class="o">*</span> <span class="mf">1.15</span><span class="p">)</span>  <span class="c1"># 15% extra space above</span>

    <span class="c1"># Add count labels on bars</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
        <span class="n">height</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">height</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span>
                <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span>
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span>
            <span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># House Grade Distribution</span>
<span class="n">plot_with_counts</span><span class="p">(</span><span class="n">house_final_test</span><span class="p">,</span> <span class="s2">&quot;House Bridge Grade Distribution&quot;</span><span class="p">)</span>

<span class="c1"># Senate Grade Distribution</span>
<span class="n">plot_with_counts</span><span class="p">(</span><span class="n">senate_final_test</span><span class="p">,</span> <span class="s2">&quot;Senate Bridge Grade Distribution&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="data-cleanup-and-final-output-preparation">
<h2><strong>Data Cleanup and Final Output Preparation</strong><a class="headerlink" href="#data-cleanup-and-final-output-preparation" title="Link to this heading">#</a></h2>
<p>This section prepares the final datasets for export by cleaning up column names, creating standardized abbreviations, and organizing the data structure for maximum usability.</p>
<section id="party-abbreviations">
<h3><strong>Party Abbreviations</strong><a class="headerlink" href="#party-abbreviations" title="Link to this heading">#</a></h3>
<p>Convert full party names to standard abbreviations for consistency.</p>
</section>
<section id="state-and-district-formatting">
<h3><strong>State and District Formatting</strong><a class="headerlink" href="#state-and-district-formatting" title="Link to this heading">#</a></h3>
<p>Create standardized state abbreviations and district formatting for both House and Senate members.</p>
</section>
<section id="column-reorganization">
<h3><strong>Column Reorganization</strong><a class="headerlink" href="#column-reorganization" title="Link to this heading">#</a></h3>
<p>Reorganize columns in a logical order for final output, including all source data, normalized scores, and final results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create party abbreviations</span>
<span class="n">house_final_test</span><span class="p">[</span><span class="s2">&quot;Party_Abbr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final_test</span><span class="p">[</span><span class="s2">&quot;Party&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="s2">&quot;Republican&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Democratic&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Independent&quot;</span><span class="p">:</span> <span class="s2">&quot;I&quot;</span>
<span class="p">})</span>

<span class="n">senate_final_test</span><span class="p">[</span><span class="s2">&quot;Party_Abbr&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final_test</span><span class="p">[</span><span class="s2">&quot;Party&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="s2">&quot;Republican&quot;</span><span class="p">:</span> <span class="s2">&quot;R&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Democratic&quot;</span><span class="p">:</span> <span class="s2">&quot;D&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Independent&quot;</span><span class="p">:</span> <span class="s2">&quot;I&quot;</span>
<span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Party abbreviations created successfully.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create state abbreviations mapping</span>
<span class="n">state_abbr</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Alabama&#39;</span><span class="p">:</span> <span class="s1">&#39;AL&#39;</span><span class="p">,</span> <span class="s1">&#39;Alaska&#39;</span><span class="p">:</span> <span class="s1">&#39;AK&#39;</span><span class="p">,</span> <span class="s1">&#39;Arizona&#39;</span><span class="p">:</span> <span class="s1">&#39;AZ&#39;</span><span class="p">,</span> <span class="s1">&#39;Arkansas&#39;</span><span class="p">:</span> <span class="s1">&#39;AR&#39;</span><span class="p">,</span> <span class="s1">&#39;California&#39;</span><span class="p">:</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Colorado&#39;</span><span class="p">:</span> <span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;Connecticut&#39;</span><span class="p">:</span> <span class="s1">&#39;CT&#39;</span><span class="p">,</span> <span class="s1">&#39;Delaware&#39;</span><span class="p">:</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="s1">&#39;Florida&#39;</span><span class="p">:</span> <span class="s1">&#39;FL&#39;</span><span class="p">,</span> <span class="s1">&#39;Georgia&#39;</span><span class="p">:</span> <span class="s1">&#39;GA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Hawaii&#39;</span><span class="p">:</span> <span class="s1">&#39;HI&#39;</span><span class="p">,</span> <span class="s1">&#39;Idaho&#39;</span><span class="p">:</span> <span class="s1">&#39;ID&#39;</span><span class="p">,</span> <span class="s1">&#39;Illinois&#39;</span><span class="p">:</span> <span class="s1">&#39;IL&#39;</span><span class="p">,</span> <span class="s1">&#39;Indiana&#39;</span><span class="p">:</span> <span class="s1">&#39;IN&#39;</span><span class="p">,</span> <span class="s1">&#39;Iowa&#39;</span><span class="p">:</span> <span class="s1">&#39;IA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kansas&#39;</span><span class="p">:</span> <span class="s1">&#39;KS&#39;</span><span class="p">,</span> <span class="s1">&#39;Kentucky&#39;</span><span class="p">:</span> <span class="s1">&#39;KY&#39;</span><span class="p">,</span> <span class="s1">&#39;Louisiana&#39;</span><span class="p">:</span> <span class="s1">&#39;LA&#39;</span><span class="p">,</span> <span class="s1">&#39;Maine&#39;</span><span class="p">:</span> <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;Maryland&#39;</span><span class="p">:</span> <span class="s1">&#39;MD&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Massachusetts&#39;</span><span class="p">:</span> <span class="s1">&#39;MA&#39;</span><span class="p">,</span> <span class="s1">&#39;Michigan&#39;</span><span class="p">:</span> <span class="s1">&#39;MI&#39;</span><span class="p">,</span> <span class="s1">&#39;Minnesota&#39;</span><span class="p">:</span> <span class="s1">&#39;MN&#39;</span><span class="p">,</span> <span class="s1">&#39;Mississippi&#39;</span><span class="p">:</span> <span class="s1">&#39;MS&#39;</span><span class="p">,</span> <span class="s1">&#39;Missouri&#39;</span><span class="p">:</span> <span class="s1">&#39;MO&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Montana&#39;</span><span class="p">:</span> <span class="s1">&#39;MT&#39;</span><span class="p">,</span> <span class="s1">&#39;Nebraska&#39;</span><span class="p">:</span> <span class="s1">&#39;NE&#39;</span><span class="p">,</span> <span class="s1">&#39;Nevada&#39;</span><span class="p">:</span> <span class="s1">&#39;NV&#39;</span><span class="p">,</span> <span class="s1">&#39;New Hampshire&#39;</span><span class="p">:</span> <span class="s1">&#39;NH&#39;</span><span class="p">,</span> <span class="s1">&#39;New Jersey&#39;</span><span class="p">:</span> <span class="s1">&#39;NJ&#39;</span><span class="p">,</span>
    <span class="s1">&#39;New Mexico&#39;</span><span class="p">:</span> <span class="s1">&#39;NM&#39;</span><span class="p">,</span> <span class="s1">&#39;New York&#39;</span><span class="p">:</span> <span class="s1">&#39;NY&#39;</span><span class="p">,</span> <span class="s1">&#39;North Carolina&#39;</span><span class="p">:</span> <span class="s1">&#39;NC&#39;</span><span class="p">,</span> <span class="s1">&#39;North Dakota&#39;</span><span class="p">:</span> <span class="s1">&#39;ND&#39;</span><span class="p">,</span> <span class="s1">&#39;Ohio&#39;</span><span class="p">:</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Oklahoma&#39;</span><span class="p">:</span> <span class="s1">&#39;OK&#39;</span><span class="p">,</span> <span class="s1">&#39;Oregon&#39;</span><span class="p">:</span> <span class="s1">&#39;OR&#39;</span><span class="p">,</span> <span class="s1">&#39;Pennsylvania&#39;</span><span class="p">:</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="s1">&#39;Rhode Island&#39;</span><span class="p">:</span> <span class="s1">&#39;RI&#39;</span><span class="p">,</span> <span class="s1">&#39;South Carolina&#39;</span><span class="p">:</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span>
    <span class="s1">&#39;South Dakota&#39;</span><span class="p">:</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;Tennessee&#39;</span><span class="p">:</span> <span class="s1">&#39;TN&#39;</span><span class="p">,</span> <span class="s1">&#39;Texas&#39;</span><span class="p">:</span> <span class="s1">&#39;TX&#39;</span><span class="p">,</span> <span class="s1">&#39;Utah&#39;</span><span class="p">:</span> <span class="s1">&#39;UT&#39;</span><span class="p">,</span> <span class="s1">&#39;Vermont&#39;</span><span class="p">:</span> <span class="s1">&#39;VT&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Virginia&#39;</span><span class="p">:</span> <span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;Washington&#39;</span><span class="p">:</span> <span class="s1">&#39;WA&#39;</span><span class="p">,</span> <span class="s1">&#39;West Virginia&#39;</span><span class="p">:</span> <span class="s1">&#39;WV&#39;</span><span class="p">,</span> <span class="s1">&#39;Wisconsin&#39;</span><span class="p">:</span> <span class="s1">&#39;WI&#39;</span><span class="p">,</span> <span class="s1">&#39;Wyoming&#39;</span><span class="p">:</span> <span class="s1">&#39;WY&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;District of Columbia&#39;</span><span class="p">:</span> <span class="s1">&#39;DC&#39;</span>
<span class="p">}</span>

<span class="c1"># Apply state abbreviations</span>
<span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">state_abbr</span><span class="p">)</span>
<span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;State&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">state_abbr</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;State abbreviations created successfully.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create district formatting functions</span>
<span class="k">def</span> <span class="nf">make_sd</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">state_col</span><span class="p">,</span> <span class="n">dist_col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create State-District format (e.g., &#39;CA-01&#39;)&quot;&quot;&quot;</span>
    <span class="c1"># Convert district strings to numeric, default 1 for non-numeric (at-large)</span>
    <span class="n">dist_num</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">dist_col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># Zero-pad to two digits</span>
    <span class="n">dist_str</span> <span class="o">=</span> <span class="n">dist_num</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">state_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;-&#39;</span> <span class="o">+</span> <span class="n">dist_str</span>

<span class="k">def</span> <span class="nf">make_sd_DW</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">state_col</span><span class="p">,</span> <span class="n">dist_col</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create StateDistrict format (e.g., &#39;CA01&#39;)&quot;&quot;&quot;</span>
    <span class="c1"># Convert district strings to numeric, default 1 for non-numeric (at-large)</span>
    <span class="n">dist_num</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">dist_col</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="c1"># Zero-pad to two digits</span>
    <span class="n">dist_str</span> <span class="o">=</span> <span class="n">dist_num</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">d</span><span class="si">:</span><span class="s2">02d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">state_col</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span> <span class="o">+</span> <span class="n">dist_str</span>

<span class="c1"># Apply district formatting to House</span>
<span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;District_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_sd</span><span class="p">(</span><span class="n">house_final_test</span><span class="p">,</span> <span class="s1">&#39;State_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;District&#39;</span><span class="p">)</span>
<span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;Dist_DW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">make_sd_DW</span><span class="p">(</span><span class="n">house_final_test</span><span class="p">,</span> <span class="s1">&#39;State_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;District&#39;</span><span class="p">)</span>

<span class="c1"># Handle at-large states</span>
<span class="n">at_large_states</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;AK&#39;</span><span class="p">,</span> <span class="s1">&#39;DE&#39;</span><span class="p">,</span> <span class="s1">&#39;ND&#39;</span><span class="p">,</span> <span class="s1">&#39;SD&#39;</span><span class="p">,</span> <span class="s1">&#39;VT&#39;</span><span class="p">,</span> <span class="s1">&#39;WY&#39;</span><span class="p">]</span>
<span class="n">house_final_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">at_large_states</span><span class="p">),</span> <span class="s1">&#39;District_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-AL&#39;</span>
<span class="n">house_final_test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">at_large_states</span><span class="p">),</span> <span class="s1">&#39;Dist_DW&#39;</span><span class="p">]</span> <span class="o">=</span> \
    <span class="n">house_final_test</span><span class="p">[</span><span class="s1">&#39;State_Abbr&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;00&#39;</span>

<span class="c1"># Senate doesn&#39;t have districts</span>
<span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;District_Abbr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">senate_final_test</span><span class="p">[</span><span class="s1">&#39;Dist_DW&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;District formatting completed successfully.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reorganize columns in logical order</span>
<span class="n">column_order</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;bioguide_id&#39;</span><span class="p">,</span> <span class="s1">&#39;Name&#39;</span><span class="p">,</span> <span class="s1">&#39;first_name&#39;</span><span class="p">,</span> <span class="s1">&#39;middle_name&#39;</span><span class="p">,</span> <span class="s1">&#39;last_name&#39;</span><span class="p">,</span> <span class="s1">&#39;nickname&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Chamber&#39;</span><span class="p">,</span> <span class="s1">&#39;State&#39;</span><span class="p">,</span> <span class="s1">&#39;State_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;District&#39;</span><span class="p">,</span> <span class="s1">&#39;District_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;Dist_DW&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Party&#39;</span><span class="p">,</span> <span class="s1">&#39;Party_Abbr&#39;</span><span class="p">,</span> <span class="s1">&#39;start_year&#39;</span><span class="p">,</span> <span class="s1">&#39;image_url&#39;</span><span class="p">,</span>
    <span class="s1">&#39;A: num_bills_with_cross_party_cosponsors&#39;</span><span class="p">,</span> <span class="s1">&#39;A_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;A_weight&#39;</span><span class="p">,</span>
    <span class="s1">&#39;B: num_cross_party_cosponsored_bills&#39;</span><span class="p">,</span> <span class="s1">&#39;B_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;B_weight&#39;</span><span class="p">,</span>
    <span class="s1">&#39;C: outcome_bipartisanship&#39;</span><span class="p">,</span> <span class="s1">&#39;C_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;C_weight&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;D: outcome_bipartisanship_pct&#39;</span><span class="p">,</span> <span class="s1">&#39;D_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;D_weight&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;E: attack_personal&#39;</span><span class="p">,</span> <span class="s1">&#39;E_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;E_weight&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;F: attack_personal_pct&#39;</span><span class="p">,</span> <span class="s1">&#39;F_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;F_weight&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;M: Cook PVI Raw&#39;</span><span class="p">,</span> <span class="s1">&#39;M_Cook_PVI_Cap&#39;</span><span class="p">,</span> <span class="s1">&#39;N: nominate_dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;N_ideology_dist&#39;</span><span class="p">,</span> <span class="s1">&#39;P_flag&#39;</span><span class="p">,</span>
    <span class="s1">&#39;score_T&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_m&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_n&#39;</span><span class="p">,</span> <span class="s1">&#39;bonus_p&#39;</span><span class="p">,</span> <span class="s1">&#39;score_U&#39;</span><span class="p">,</span> <span class="s1">&#39;norm_U&#39;</span><span class="p">,</span> <span class="s1">&#39;Grade&#39;</span>
<span class="p">]</span>

<span class="c1"># Reorganize House data</span>
<span class="n">house_final_test</span> <span class="o">=</span> <span class="n">house_final_test</span><span class="p">[</span><span class="n">column_order</span><span class="p">]</span>

<span class="c1"># Reorganize Senate data</span>
<span class="n">senate_final_test</span> <span class="o">=</span> <span class="n">senate_final_test</span><span class="p">[</span><span class="n">column_order</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column reorganization completed successfully.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rename columns to final standardized names</span>
<span class="n">house_final_test</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;score_T&#39;</span><span class="p">:</span> <span class="s1">&#39;T_score&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;bonus_m&#39;</span><span class="p">:</span> <span class="s1">&#39;M_bonus&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;bonus_n&#39;</span><span class="p">:</span> <span class="s1">&#39;N_bonus&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;bonus_p&#39;</span><span class="p">:</span> <span class="s1">&#39;P_bonus&#39;</span><span class="p">,</span>
    <span class="s1">&#39;score_U&#39;</span><span class="p">:</span> <span class="s1">&#39;U_score&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;norm_U&#39;</span><span class="p">:</span> <span class="s1">&#39;Bridge_Score&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Grade&#39;</span><span class="p">:</span> <span class="s1">&#39;Bridge_Grade&#39;</span><span class="p">,</span>
    <span class="s1">&#39;District_Abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;Dist_abbr&#39;</span>
<span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">senate_final_test</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;score_T&#39;</span><span class="p">:</span> <span class="s1">&#39;T_score&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;bonus_m&#39;</span><span class="p">:</span> <span class="s1">&#39;M_bonus&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;bonus_n&#39;</span><span class="p">:</span> <span class="s1">&#39;N_bonus&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;bonus_p&#39;</span><span class="p">:</span> <span class="s1">&#39;P_bonus&#39;</span><span class="p">,</span>
    <span class="s1">&#39;score_U&#39;</span><span class="p">:</span> <span class="s1">&#39;U_score&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;norm_U&#39;</span><span class="p">:</span> <span class="s1">&#39;Bridge_Score&#39;</span><span class="p">,</span> 
    <span class="s1">&#39;Grade&#39;</span><span class="p">:</span> <span class="s1">&#39;Bridge_Grade&#39;</span><span class="p">,</span>
    <span class="s1">&#39;District_Abbr&#39;</span><span class="p">:</span> <span class="s1">&#39;Dist_abbr&#39;</span>
<span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Column renaming completed successfully.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="export-to-excel-files">
<h2><strong>Export to Excel Files</strong><a class="headerlink" href="#export-to-excel-files" title="Link to this heading">#</a></h2>
<p>This section exports the final datasets to Excel files in multiple formats for maximum flexibility and usability.</p>
<section id="export-options">
<h3><strong>Export Options</strong><a class="headerlink" href="#export-options" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p><strong>Separate Files:</strong> Individual Excel files for House and Senate</p></li>
<li><p><strong>Combined with Separate Sheets:</strong> Single Excel file with separate sheets for House and Senate</p></li>
<li><p><strong>Combined Single Sheet:</strong> Single Excel file with all data in one sheet</p></li>
</ol>
<p>All files include timestamps in the filename for version control.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1"># Generate timestamp for file naming</span>
<span class="n">timestamp</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Export 1: Separate Excel files for House and Senate</span>
<span class="n">house_final_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;house_scores_119_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;119 Grades&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">senate_final_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;senate_scores_119_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;119 Grades&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Separate files exported:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - house_scores_119_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.xlsx&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - senate_scores_119_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Export 2: Combined file with separate sheets</span>
<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">ExcelWriter</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;congress_scores_119_separate_sheets_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.xlsx&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
    <span class="n">house_final_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;House&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">senate_final_test</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">writer</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;Senate&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Combined file with separate sheets exported:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - congress_scores_119_separate_sheets_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Export 3: Combined file with single sheet</span>
<span class="n">congress_combined</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">house_final_test</span><span class="p">,</span> <span class="n">senate_final_test</span><span class="p">])</span>
<span class="n">congress_combined</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;congress_scores_119_single_sheet_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s1">.xlsx&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s1">&#39;119 Grades&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;✓ Combined file with single sheet exported:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  - congress_scores_119_single_sheet_</span><span class="si">{</span><span class="n">timestamp</span><span class="si">}</span><span class="s2">.xlsx&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Source%20N.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><strong>Source N: VoteView Member Ideology Scores Processing</strong></p>
      </div>
    </a>
    <a class="right-next"
       href="Suggested_Weights.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><strong>Suggested Weights for Bridge Grades System</strong></p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-sources"><strong>Data Sources</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#input-files"><strong>Input Files</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#output-files"><strong>Output Files</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#main-functions"><strong>Main Functions</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-and-setup"><strong>1. Configuration and Setup</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-integration"><strong>2. Data Source Integration</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#final-score-calculation"><strong>3. Final Score Calculation</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#technical-requirements"><strong>Technical Requirements</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dependencies"><strong>Dependencies</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-processing-notes"><strong>Data Processing Notes</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-quality"><strong>Data Quality</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#validation-checks"><strong>Validation Checks</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#configuration-file-existence-checks"><strong>Configuration &amp; File Existence Checks</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-dataframes-validate-weights"><strong>Load DataFrames &amp; Validate Weights</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#build-base-member-tables"><strong>Build Base Member Tables</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attendance-filtering"><strong>Attendance Filtering</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-source-processing"><strong>Data Source Processing</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-a-authors-of-bills-with-cross-party-sponsors"><strong>Source A: Authors of Bills with Cross-Party Sponsors</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-b-cosponsors-of-cross-party-bills"><strong>Source B: Cosponsors of Cross-Party Bills</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sources-c-d-e-f-communication-analysis"><strong>Sources C, D, E, F: Communication Analysis</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#source-c-bipartisan-communication-sum"><strong>Source C: Bipartisan Communication (Sum)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#source-d-bipartisan-communication-percentage"><strong>Source D: Bipartisan Communication (Percentage)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#source-e-personal-attacks-sum"><strong>Source E: Personal Attacks (Sum)</strong></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#source-f-personal-attacks-percentage"><strong>Source F: Personal Attacks (Percentage)</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bonus-sources-m-n-p"><strong>Bonus Sources (M, N, P)</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-m-cook-political-partisan-voting-index-pvi"><strong>Source M: Cook Political Partisan Voting Index (PVI)</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-n-voteview-member-ideology-score"><strong>Source N: VoteView Member Ideology Score</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#source-p-problem-solvers-caucus-bump"><strong>Source P: Problem Solvers Caucus “Bump”</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#final-score-calculation-grade-assignment"><strong>Final Score Calculation &amp; Grade Assignment</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scoring-algorithm"><strong>Scoring Algorithm</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-visualization"><strong>Data Visualization</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-cleanup-and-final-output-preparation"><strong>Data Cleanup and Final Output Preparation</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#party-abbreviations"><strong>Party Abbreviations</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#state-and-district-formatting"><strong>State and District Formatting</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#column-reorganization"><strong>Column Reorganization</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#export-to-excel-files"><strong>Export to Excel Files</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#export-options"><strong>Export Options</strong></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Bridge Grades Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>